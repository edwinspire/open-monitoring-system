<?xml version="1.0" encoding="UTF-8" ?>
<!-- $Header: /cvsroot/autodoc/autodoc/xml.tmpl,v 1.2 2006/05/16 19:01:27 rbt Exp $ -->

<book id="database.oms" xreflabel="oms database schema"><title>oms Model</title>




  <chapter id="contacts.schema"
           xreflabel="contacts">
    <title>Schema contacts</title>
    <para></para>


      <section id="contacts.table.contacts"
               xreflabel="contacts.contacts">
        <title id="contacts.table.contacts-title">
         Table:
         
         <structname>contacts</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>contacts</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

              <para>
                Indica si el contacto esta habilitado o no.
Por ejemplo si el contacto debe usarse o no para otras areas de la aplicacion.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>first_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Nombre del contacto.
Este campo es oblogatorio y no puede ser nulo.

              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>










              </para>

              <para>
                Apellido del contacto.
Este valor puede ser nulo aunque no se recomienda.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Este campo es importante, obligatorio y unico entre todos los registros.
Es un identificador unico entre el resto de contactos.

              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.identification-types"/>




              </para>

              <para>
                Tipo de identificacion (Ej.: Cedula, RUC, etc)
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Codigo Postal
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>gender</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Genero:
0 - No establecido
1 - Hombre
2 - Mujer
3 - No aplica
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

              <para>
                Geolocalizacion X
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

              <para>
                Geolocalizacion Y
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Direccion del contacto
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Puntos referenciales para ubucacion del contacto
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

              <para>
                Id de los grupos a los que pertenece este abonado
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.admins via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.admins"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>



  </chapter>

  <chapter id="events.schema"
           xreflabel="events">
    <title>Schema events</title>
    <para>Almacenado y procesado de eventos en este schema</para>


      <section id="events.table.comments"
               xreflabel="events.comments">
        <title id="events.table.comments-title">
         Table:
         
         <structname>comments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>comments</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventcomment</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.comments_ideventcomments_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>seconds</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>comment_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="events.table.datas"
               xreflabel="events.datas">
        <title id="events.table.datas-title">
         Table:
         
         <structname>datas</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="events.table.statustypes"/>


              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="events.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>





                <literal>DEFAULT 1</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Este campo se guarda vacio, unicamente es utilizado para validar el report_validator enviado desde una aplicacion externa o via web.
              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas</title>

          <varlistentry>
            <term>datas_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>fki_evetn_statustype_id</term>
            <listitem><para>idstatustype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>fki_sfsdf</term>
            <listitem><para>ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-000112"
               xreflabel="events.datas_000112">
        <title id="events.table.datas-000112-title">
         Table:
         
         <structname>datas_000112</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_000112</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_000112</title>

          <varlistentry>
            <term>datas_000112_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (- (1)::double precision)))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_000112</title>

          <varlistentry>
            <term>datas_000112_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_000112_ideventtype_idx</term>
            <listitem><para>ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_000112_idstatustype_idx</term>
            <listitem><para>idstatustype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_000112_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-199001"
               xreflabel="events.datas_199001">
        <title id="events.table.datas-199001-title">
         Table:
         
         <structname>datas_199001</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_199001</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_199001</title>

          <varlistentry>
            <term>datas_199001_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (1990)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_199001</title>

          <varlistentry>
            <term>datas_199001_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_199001_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201504"
               xreflabel="events.datas_201504">
        <title id="events.table.datas-201504-title">
         Table:
         
         <structname>datas_201504</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201504</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201504</title>

          <varlistentry>
            <term>datas_201504_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201504</title>

          <varlistentry>
            <term>datas_201504_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201504_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201506"
               xreflabel="events.datas_201506">
        <title id="events.table.datas-201506-title">
         Table:
         
         <structname>datas_201506</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201506</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201506</title>

          <varlistentry>
            <term>datas_201506_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201506</title>

          <varlistentry>
            <term>datas_201506_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201506_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201508"
               xreflabel="events.datas_201508">
        <title id="events.table.datas-201508-title">
         Table:
         
         <structname>datas_201508</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201508</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201508</title>

          <varlistentry>
            <term>datas_201508_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201508</title>

          <varlistentry>
            <term>datas_201508_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201508_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201509"
               xreflabel="events.datas_201509">
        <title id="events.table.datas-201509-title">
         Table:
         
         <structname>datas_201509</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201509</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201509</title>

          <varlistentry>
            <term>datas_201509_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201509</title>

          <varlistentry>
            <term>datas_201509_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201509_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201510"
               xreflabel="events.datas_201510">
        <title id="events.table.datas-201510-title">
         Table:
         
         <structname>datas_201510</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201510</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201510</title>

          <varlistentry>
            <term>datas_201510_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201510</title>

          <varlistentry>
            <term>datas_201510_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201510_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201511"
               xreflabel="events.datas_201511">
        <title id="events.table.datas-201511-title">
         Table:
         
         <structname>datas_201511</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201511</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201511</title>

          <varlistentry>
            <term>datas_201511_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201511</title>

          <varlistentry>
            <term>datas_201511_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201511_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201610"
               xreflabel="events.datas_201610">
        <title id="events.table.datas-201610-title">
         Table:
         
         <structname>datas_201610</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201610</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201610</title>

          <varlistentry>
            <term>datas_201610_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201610</title>

          <varlistentry>
            <term>datas_201610_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201610_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201701"
               xreflabel="events.datas_201701">
        <title id="events.table.datas-201701-title">
         Table:
         
         <structname>datas_201701</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201701</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201701</title>

          <varlistentry>
            <term>datas_201701_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201701</title>

          <varlistentry>
            <term>datas_201701_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201701_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201704"
               xreflabel="events.datas_201704">
        <title id="events.table.datas-201704-title">
         Table:
         
         <structname>datas_201704</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201704</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201704</title>

          <varlistentry>
            <term>datas_201704_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201704</title>

          <varlistentry>
            <term>datas_201704_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_201704_ideventtype_idx</term>
            <listitem><para>ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_201704_idstatustype_idx</term>
            <listitem><para>idstatustype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201704_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.datas-201705"
               xreflabel="events.datas_201705">
        <title id="events.table.datas-201705-title">
         Table:
         
         <structname>datas_201705</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>datas_201705</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>









                <literal>DEFAULT 1</literal>




                <literal>REFERENCES</literal> <xref linkend="events.table.reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Este campo se guarda vacio, unicamente es utilizado para validar el report_validator enviado desde una aplicacion externa o via web.
              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on datas_201705</title>

          <varlistentry>
            <term>datas_201705_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on datas_201705</title>

          <varlistentry>
            <term>datas_201705_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_201705_ideventtype_idx</term>
            <listitem><para>ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>datas_201705_idstatustype_idx</term>
            <listitem><para>idstatustype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_datas_201705_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="events.table.eventtypes"
               xreflabel="events.eventtypes">
        <title id="events.table.eventtypes-title">
         Table:
         
         <structname>eventtypes</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>eventtypes</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.eventtypes_ideventtype_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>treatment</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>manual</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>date_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_timeout</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_closable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_img</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_snd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_all_users</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>expiration</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enable_auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype_group</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>eventtype_attention_group</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing events.datas via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="events.table.reception-modes"
               xreflabel="events.reception_modes">
        <title id="events.table.reception-modes-title">
         Table:
         
         <structname>reception_modes</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>reception_modes</structname>
            </title>


            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.reception_modes_idreceptionmode_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_mode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing events.datas_000112 via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas-000112"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-199001"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201504"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201506"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201508"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201509"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201510"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201511"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201610"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201701"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201704"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201705"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="events.table.statustypes"
               xreflabel="events.statustypes">
        <title id="events.table.statustypes-title">
         Table:
         
         <structname>statustypes</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>statustypes</structname>
            </title>


            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events.statustypes_ideventstatustype_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_status</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>internal</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing events.datas via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="events.view.view-datas-details"
               xreflabel="events.view_datas_details">
        <title id="events.view.view-datas-details-title">
         View:
         
         <structname>view_datas_details</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_datas_details</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_state</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status_type</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_status</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_eventtype</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_mode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_reception_mode</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_equipment</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_eventtype</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_account</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_datas_details</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.account_name
,
    accounts.identification
,
    accounts.iddivision
,
    accounts.account
,
    account_states.idaccountstate
,
    account_states.state AS account_state
,
    datas.idevent
,
    datas.dateevent
,
    datas.idstatustype
,
    statustypes.status AS status_type
,
    statustypes.label_status
,
    datas.priority
,
    datas.ideventtype
,
    eventtypes.label AS label_eventtype
,
    datas.description
,
    datas.zu
,
    datas.idequipment
,
    equipments.equipment
,
    datas.idreceptionmode
,
    reception_modes.label_mode
,
    reception_modes.enabled AS enabled_reception_mode
,
    datas.isopen
,
    datas.details
,
    datas.idadmin_assigned
,
    equipments.enabled AS enabled_equipment
,
    eventtypes.enabled AS enabled_eventtype
,
    accounts.enabled AS enabled_account
   
FROM accounts
,
    account_states
,
    events.datas
,
    events.statustypes
,
    events.eventtypes
,
    equipments
,
    events.reception_modes
  
WHERE (
     (accounts.idaccount = datas.idaccount)
   AND (account_states.idaccountstate = accounts.idaccountstate)
   AND (statustypes.idstatustype = datas.idstatustype)
   AND (eventtypes.ideventtype = datas.ideventtype)
   AND (equipments.idequipment = datas.idequipment)
   AND (reception_modes.idreceptionmode = datas.idreceptionmode)
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="events.view.view-datas-details-isopen"
               xreflabel="events.view_datas_details_isopen">
        <title id="events.view.view-datas-details-isopen-title">
         View:
         
         <structname>view_datas_details_isopen</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_datas_details_isopen</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_account</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_state</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_status</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_eventtype</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>details</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_datas_details_isopen</title>
         <programlisting>
SELECT view_datas_details.idaccount
,
    view_datas_details.enabled_account
,
    view_datas_details.account_name
,
    view_datas_details.identification
,
    view_datas_details.iddivision
,
    view_datas_details.account
,
    view_datas_details.idaccountstate
,
    view_datas_details.account_state
,
    view_datas_details.idevent
,
    view_datas_details.dateevent
,
    view_datas_details.idstatustype
,
    view_datas_details.label_status
,
    view_datas_details.priority
,
    view_datas_details.ideventtype
,
    view_datas_details.label_eventtype
,
    view_datas_details.description
,
    view_datas_details.zu
,
    view_datas_details.idequipment
,
    view_datas_details.equipment
,
    view_datas_details.idreceptionmode
,
    view_datas_details.isopen
,
    view_datas_details.idadmin_assigned
,
    view_datas_details.details
   
FROM events.view_datas_details
  
WHERE (view_datas_details.isopen = true);</programlisting>
        </figure>



      </para>
    </section>

      <section id="events.view.view-eventtypes-to-client"
               xreflabel="events.view_eventtypes_to_client">
        <title id="events.view.view-eventtypes-to-client-title">
         View:
         
         <structname>view_eventtypes_to_client</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_eventtypes_to_client</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_eventtypes_to_client</title>
         <programlisting>
SELECT eventtypes.ideventtype
,
    eventtypes.label
   
FROM events.eventtypes
  
WHERE (eventtypes.manual = true);</programlisting>
        </figure>



      </para>
    </section>



<!-- Function check_before_insert() -->
    <section id="events.function.check-before-insert"
             xreflabel="eventscheck_before_insert()">
      <title id="events.function.check-before-insert-title">
       check_before_insert()
      </title>
      <titleabbrev id="events.function.check-before-insert-titleabbrev">
       check_before_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE 
  table_part TEXT DEFAULT &#39;1990&#39;; 
  et eventtypes%ROWTYPE; 
  --tbl TEXT DEFAULT &#39;events&#39;; 
  is_valid  BOOLEAN DEFAULT FALSE; 
  iaenabled BOOLEAN DEFAULT FALSE; 
  constraint_name_table TEXT DEFAULT &#39;_dateevent_check&#39;; 
  dateevent_year INTEGER DEFAULT 1990; 
  iuuidevent UUID; 
  lastidevent BIGINT;
  iiddivision BIGINT; 
BEGIN 

--table_part := fun_create_table_partition_events_data(tg_table_name, NEW.dateevent:: timestamp WITH TIME zone);
  table_part := events.fun_create_table_partition_datas(NEW.dateevent:: timestamp WITH TIME zone);
  

/*
constraint_name_table := table_part 
  ||&#39;_dateevent_check&#39;; 
  dateevent_year := Extract(year FROM NEW.dateevent); 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;CHECK&#39; 
           AND    table_name = table_part 
           AND    constraint_name = constraint_name_table ) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part::text 
    ||&#39;   ADD CONSTRAINT &#39; 
    ||constraint_name_table::text 
    ||&#39; CHECK (EXTRACT(YEAR FROM dateevent) = &#39; 
    ||dateevent_year::text 
    ||&#39;::double precision);&#39;; 
  END IF ; 
*/

  /* 
select * from information_schema.table_constraints where constraint_type = &#39;CHECK&#39; 
*/ 



/*
CREATE TRIGGER on_before_update_ideventstatustype
  BEFORE UPDATE OF isopen
  ON events
  FOR EACH ROW
  EXECUTE PROCEDURE events_update_ideventstatustype();
*/

/*
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = table_part 
           AND    trigger_name = &#39;on_before_update_ideventstatustype&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_before_update_ideventstatustype   BEFORE UPDATE OF isopen   ON &#39; 
    ||table_part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events_update_ideventstatustype();&#39;; 
  END IF ; 
  */


-------------------------
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = table_part 
           AND    trigger_name = &#39;on_insert_event&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_insert_event   AFTER INSERT   ON &#39; 
    ||table_part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events_on_insert();&#39;; 
  END IF ; 

  





  
  -- El unico dato para validar si el equipo o la cuenta son correctos es el idaccount o el idequipment
  CASE 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment IS NULL THEN 
    RAISE notice &#39;1) El idaccount o el idequipment no pueden ser nulos&#39;; 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment &gt; 0 THEN 
    SELECT coalesce( 
                      ( 
                      SELECT idaccount 
                      FROM   equipments 
                      WHERE  idequipment = NEW.idequipment), -1000) 
    INTO   NEW.idaccount; 
     
    IF NEW.idaccount &gt; 0 THEN 
      is_valid := TRUE; 
    ELSE 
      is_valid := FALSE; 
      NEW.idaccount := NULL; 
      -- Debemos insertar un evento que indique que se trata de insertar un evento de un idequipment sin asociar a un idaccount que no existe
      RAISE notice &#39;2) **** idequipment (%) no tiene idaccount asociada o es incorrecta&#39;, NEW.idaccount;
    END IF; 
  WHEN NEW.idaccount &gt;= 0 THEN 
    is_valid := TRUE; 
    --NEW.idequipment := 0; 
    RAISE notice &#39;3) ***** idaccount (%)&#39;, NEW.idaccount; 
  ELSE 
    RAISE notice &#39;3) ***** No pasa nada (%)&#39;, NEW.idaccount; 
    is_valid := FALSE; 
  END CASE; 
  RAISE notice &#39;4) Vamos a la validacion de ideventtype y relacionados&#39;; 
  IF is_valid THEN -- Obtenemos los datos del tipo de evento 
    SELECT * 
    INTO   et 
    FROM   eventtypes 
    WHERE  ideventtype = NEW.ideventtype; 
   
    -- Obtenemos los datos de la cuenta 
    SELECT enabled 
    INTO   iaenabled 
    FROM   accounts 
    WHERE  idaccount = NEW.idaccount; 
     
    CASE 
    WHEN NOT iaenabled THEN 
      NEW.idstatustype := 9; 
    WHEN et.expiration &lt;= 0 THEN 
      NEW.idstatustype := 2; 
    ELSE 
      RAISE notice &#39;events_before_insert ???? &#39;; 
    END CASE; 

/*
    ------------------------------------------------------------------------------------------------------- 
    -- Revisamos si el idcontact que ingresa el evento existe, si es null ponemos a 0 
    IF NOT EXISTS 
      ( 
             SELECT * 
             FROM   contacts 
             WHERE  idcontact = NEW.idcontact) THEN 
      NEW.idcontact := 0; 
    END IF;
    */
     


    -- Validamos ideventtype y relacionados 
    IF NEW.ideventtype IS NULL 
      OR 
      NEW.ideventtype &lt; 1 THEN 
      RAISE notice &#39;5) IF NEW.ideventtype IS NULL OR NEW.ideventtype &lt; 1&#39;; 
      NEW.ideventtype := 0; 
    END IF; 
    RAISE notice &#39;6) Hacemos un select del tipo de evento&#39;; 
    IF (NEW.description IS NULL 
      OR 
      Length(NEW.description) &lt; 1) 
      AND 
      et.label IS NOT NULL THEN 
      RAISE notice &#39;7) IF (NEW.description IS NULL OR LENGTH(NEW.description) &lt; 1) AND et.label IS NOT NULL&#39;;
      NEW.description := et.label; 
    END IF; 
    IF (NEW.priority IS NULL 
      OR 
      NEW.priority &lt; 1) 
      AND 
      et.priority IS NOT NULL THEN 
      RAISE notice &#39;8) IF (NEW.priority IS NULL OR NEW.priority &lt; 1) AND et.priority IS NOT NULL&#39;;
      NEW.priority := et.priority; 
    END IF; 
    RAISE notice &#39;9) Finaliza las verificaciones, ahora va a insertar en la particion %&#39;, table_part;
    ------------------------------------------------------------ 
    -- Este bloque es especifico para cada tabla 
    CASE 
      -------------------------------------------- 
      -- hacemos el check especifico para la tabla events_diskspace 
    WHEN tg_table_name = &#39;events&#39; THEN -- Creamos el uuidevent en base a los campos 
      /*  NEW.uuidevent := Md5(Extract(epoch FROM NEW.dateevent)::text 
||NEW.idaccount::text 
||NEW.ideventtype::text 
||NEW.zu::text 
||NEW.idequipment::text)::uuid; */ 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_dbsizes&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.db_name 
      ||NEW.db_type::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_dbsizes 
                 WHERE  idevent = lastidevent 
                 AND    db_size = NEW.db_size) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_device_uptime&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_device_uptime 
                 WHERE  idevent = lastidevent 
                 AND    uptime = NEW.uptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_diskspace&#39; THEN -- Creamos el uuidevent en base a los campos
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.drive)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_diskspace 
                 WHERE  idevent = lastidevent 
                 AND    drive_size = NEW.drive_size 
                 AND    drive_free = NEW.drive_free) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_jobs&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.job_name)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_jobs 
                 WHERE  idevent = lastidevent 
                 AND    job_date_create = NEW.job_date_create 
                 AND    job_run_duration = NEW.job_run_duration 
                 AND    job_run_status = NEW.job_run_status 
                 AND    job_next_run = NEW.job_next_run) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_networkdevice_ping&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_networkdevice_ping 
                 WHERE  idevent = lastidevent 
                 AND    roundtriptime = NEW.roundtriptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
    WHEN tg_table_name = &#39;events_raid&#39; THEN -- Creamos el uuidevent en base a los campos 
      /*NEW.uuidevent := Md5(Extract(epoch FROM NEW.dateevent)::text 
||NEW.idaccount::text 
||NEW.ideventtype::text 
||NEW.zu::text 
||NEW.idequipment::text)::uuid;   */ 
    ELSE 

    END CASE; 

SELECT isopen INTO NEW.isopen FROM events.statustypes WHERE idstatustype = NEW.idstatustype;


IF NEW.isopen = TRUE THEN
 --NEW.idadmin_assigned := fun_event_assignment(NEW.idaccount, NEW.ideventtype, NEW.idadmin_assigned);
 


END IF; 



    EXECUTE &#39;INSERT INTO events.&#39; 
    || quote_ident(table_part) 
    || &#39; SELECT ($1).*&#39; USING NEW; 
  END IF; 
  RETURN NULL; 
END;</programlisting>
      </para>
    </section>

<!-- Function fun_create_table_partition_datas(idatetimeevent timestamp with time zone) -->
    <section id="events.function.fun-create-table-partition-datas-idatetimeevent-timestamp-with-time-zone"
             xreflabel="eventsfun_create_table_partition_datas(idatetimeevent timestamp with time zone)">
      <title id="events.function.fun-create-table-partition-datas-idatetimeevent-timestamp-with-time-zone-title">
       fun_create_table_partition_datas(idatetimeevent timestamp with time zone)
      </title>
      <titleabbrev id="events.function.fun-create-table-partition-datas-idatetimeevent-timestamp-with-time-zone-titleabbrev">
       fun_create_table_partition_datas(idatetimeevent timestamp with time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

part TEXT DEFAULT &#39;19000101&#39;;
constraint_name_table TEXT DEFAULT &#39;_dateevent_check&#39;;
dateevent_year INTEGER DEFAULT 1990; 
inherts_table TEXT DEFAULT &#39;datas&#39;;

BEGIN

part := inherts_table||&#39;_&#39;||to_char(idatetimeevent, &#39;YYYYMM&#39;)::TEXT;

IF NOT EXISTS(SELECT table_name FROM information_schema.tables WHERE  table_schema = &#39;events&#39; AND table_name = part LIMIT 1) THEN

EXECUTE &#39;CREATE TABLE IF NOT EXISTS events.&#39;||part::TEXT||&#39;(
   LIKE events.datas INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE INCLUDING COMMENTS
) 
INHERITS (events.datas)
WITH (
  OIDS = FALSE,
  toast.autovacuum_enabled=true
);&#39;;


-- Trigger: on_changed_table on events

-- DROP TRIGGER on_changed_table ON events;

EXECUTE &#39;CREATE TRIGGER on_changed_table
  AFTER INSERT OR UPDATE OR DELETE
  ON events.&#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_changed_table();&#39;;

-- Trigger: on_update_row on events

-- DROP TRIGGER on_update_row ON events;

EXECUTE &#39;CREATE TRIGGER on_update_row
  BEFORE UPDATE
  ON events.&#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_update_row_update_ts();&#39;;


  constraint_name_table := part ||&#39;_dateevent_check&#39;; 
  dateevent_year := Extract(year FROM idatetimeevent); 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;CHECK&#39; 
           AND    table_name = part 
           AND    constraint_schema = &#39;events&#39; 
           AND    constraint_name = constraint_name_table ) THEN 
    EXECUTE &#39;ALTER TABLE events.&#39; 
    ||part::text 
    ||&#39;   ADD CONSTRAINT &#39; 
    ||constraint_name_table::text 
    ||&#39; CHECK (EXTRACT(YEAR FROM dateevent) = &#39; 
    ||dateevent_year::text 
    ||&#39;::double precision);&#39;; 
  END IF ; 



-----------------------------------------------

-------------------------
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = part 
           AND    event_object_schema = &#39;events&#39; 
           AND    trigger_name = &#39;on_insert_event&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_insert_event   AFTER INSERT   ON events.&#39; 
    ||part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events.on_insert();&#39;; 
  END IF ; 

  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    constraint_schema = &#39;events&#39;            
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_idadmin&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_idadmin FOREIGN KEY (idadmin) REFERENCES admins (idadmin)  ON UPDATE CASCADE ON DELETE CASCADE;&#39;;
  END IF; 
  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    constraint_schema = &#39;events&#39;                       
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_idreceptionmode&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_receptionmode FOREIGN KEY (idreceptionmode) REFERENCES events.reception_modes (idreceptionmode)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 



  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39;
	   AND    constraint_schema = &#39;events&#39;                       
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_ideventtype&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_ideventtype FOREIGN KEY (ideventtype) REFERENCES eventtypes (ideventtype)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 

  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = part 
           AND schemaname = &#39;events&#39;
           AND    indexname = &#39;index_&#39; 
                         ||part 
                         ||&#39;_isopen&#39;) THEN 
    EXECUTE &#39; CREATE UNIQUE INDEX index_&#39; 
    ||part 
    ||&#39;_isopen   ON events.&#39; 
    ||part 
    ||&#39; USING btree (dateevent, idstatustype, idaccount, ideventtype, zu, idequipment)
  WHERE isopen = true;&#39;; 
  END IF; 


  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = part 
           AND schemaname = &#39;events&#39;           
           AND    indexname = &#39;index_&#39; 
                         ||part 
                         ||&#39;_idaccideventt&#39;) THEN 
    EXECUTE &#39; CREATE INDEX index_&#39; 
    ||part 
    ||&#39;_idaccideventt   ON events.&#39; 
    ||part 
    ||&#39; USING btree (idaccount, ideventtype)&#39;; 
  END IF; 




  
  

END IF;


RETURN part;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint) -->
    <section id="events.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint"
             xreflabel="eventsfun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)">
      <title id="events.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint-title">
       fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)
      </title>
      <titleabbrev id="events.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint-titleabbrev">
       fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>bigint</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

R BIGINT;
iiddivision BIGINT;
iisopen boolean DEFAULT FALSE;

BEGIN

IF EXISTS(SELECT * FROM admins WHERE idadmin = admin_assigned) THEN
R := admin_assigned;
ELSE   

-------------------- 
-- TODO - Debe haber un bloque que auto asigne el evento al administrador que sea conveniente si el status esta en 0
-- Buscamos que administradores tienen acceso a la division y al iaccount de la cuenta de este evento
SELECT iddivision INTO iiddivision FROM accounts WHERE idcontact = iidaccount;

SELECT idadmin 
INTO   R 
FROM   admins 
WHERE  iiddivision = ANY(divisions) 
AND    iidaccount = ANY (idaccounts) limit 1; 

END IF;


RETURN R;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_set_expired_events() -->
    <section id="events.function.fun-set-expired-events"
             xreflabel="eventsfun_set_expired_events()">
      <title id="events.function.fun-set-expired-events-title">
       fun_set_expired_events()
      </title>
      <titleabbrev id="events.function.fun-set-expired-events-titleabbrev">
       fun_set_expired_events()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR select * from (select idevent, dateevent, ideventtype, (extract(epoch from age(now(), dateevent))/60) AS minutes_event, (select expiration from eventtypes where ideventtype = ev.ideventtype) as limit_expiration
 from events.datas ev where isopen = true ) as v WHERE minutes_event &gt;=  limit_expiration;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP
            -- if cursor1_row.minutes_event &gt;=  cursor1_row.limit_expiration then
        --  PERFORM fun_edit_event_comments(0, 0, now()::timestamp without time zone, 1, &#39;Event expired. Automatically closed by the system.&#39;::text, 5, cursor1_row.idevent::bigint);   
INSERT INTO events.comments(
            idadmin, start, seconds, comment_event, idstatustype, idevent)
    VALUES (0, now(), 1, &#39;Event expired. Automatically closed by the system.&#39;, 5, cursor1_row.idevent::bigint);
fun_return := fun_return+1;
  --     end if;  
    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function import_events() -->
    <section id="events.function.import-events"
             xreflabel="eventsimport_events()">
      <title id="events.function.import-events-title">
       import_events()
      </title>
      <titleabbrev id="events.function.import-events-titleabbrev">
       import_events()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR SELECT * FROM events ORDER BY idevent LIMIT 1000  OFFSET 10000;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP


INSERT INTO events.datas(
            dateevent, idstatustype, idaccount, priority, ideventtype, description, zu, idequipment, 
            idreceptionmode, isopen, idadmin_assigned)
    VALUES (cursor1_row.dateevent, cursor1_row.ideventstatustype, cursor1_row.idaccount, cursor1_row.priority, cursor1_row.ideventtype, cursor1_row.description, cursor1_row.zu, 
       cursor1_row.idequipment, cursor1_row.ideventreceptionmode, 
       cursor1_row.isopen, cursor1_row.idadmin_assigned);
       
fun_return := fun_return+1;

    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function on_insert() -->
    <section id="events.function.on-insert"
             xreflabel="eventson_insert()">
      <title id="events.function.on-insert-title">
       on_insert()
      </title>
      <titleabbrev id="events.function.on-insert-titleabbrev">
       on_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE 
  ilabel TEXT DEFAULT &#39;&#39;; 
  ibody TEXT DEFAULT &#39;&#39;; 
  iafn TEXT DEFAULT &#39;&#39;; 
  ialn TEXT DEFAULT &#39;&#39;; 
  iaccount TEXT DEFAULT &#39;&#39;; 
  iaenabled BOOLEAN DEFAULT TRUE; 
  isessionid TEXT DEFAULT &#39;&#39;; 
  iiddivision     BIGINT; 
  idadminassigned BIGINT; 
  iuuidevent UUID; 
  et events.eventtypes%ROWTYPE; 
  array_ideventtypes_closed_for_this_ideventtype INTEGER[]; 
  idevent_for_close_on_restore                   INT DEFAULT 0; 
BEGIN 
  RAISE notice &#39;&gt;&gt;&gt; 1) Inicia Trigger events_on_insert&#39;; 
  RAISE notice &#39;&gt;&gt;&gt; 2)&#39;; 

  /*
  -- Obtenemos los datos del tipo de evento 
  SELECT * 
  INTO   et 
  FROM   events.eventtypes 
  WHERE  ideventtype = NEW.ideventtype; 
   
  RAISE notice &#39;&gt;&gt;&gt;&gt; 3)&#39;; 
  -- Obtenemos los datos de la cuenta 
  SELECT account, 
         first_name, 
         last_name, 
         enabled, 
         iddivision 
  INTO   iaccount, 
         iafn, 
         ialn, 
         iaenabled, 
         iiddivision 
  FROM   accounts 
  WHERE  idcontact = NEW.idaccount; 
   
  RAISE notice &#39;&gt;&gt;&gt; 4)&#39;; 
  IF et.notify_all_users THEN 
    isessionid := &#39;all&#39;; 
 -- ELSE 

   
  END IF; 
  RAISE notice &#39;&gt;&gt;&gt;&gt; 5)&#39;; 
  IF iaenabled 
    AND 
    NEW.priority &lt; 21 THEN 
    RAISE notice &#39;&gt;&gt;&gt; 6)&#39;; 
    -- Mostramos la notificacion solo si la prioridad es menor o = que 20 
    ilabel := ialn 
    ||&#39; &#39; 
    ||iafn 
    ||&#39; [&#39; 
    ||iaccount 
    ||&#39;]&lt;/br&gt;&#39; 
    ||et.label 
    ||&#39;&lt;/br&gt;&#39;; 
    INSERT INTO notification_area 
                ( 
                            urgency, 
                            timeout, 
                            closable, 
                            img, 
                            snd, 
                            title, 
                            BODY, 
                            sessionid 
                ) 
                VALUES 
                ( 
                            NEW.priority, 
                            et.notify_timeout, 
                            et.notify_closable, 
                            et.notify_img, 
                            et.notify_snd, 
                            ilabel, 
                            &#39;&lt;b&gt;&#39; 
                                        ||NEW.dateevent 
                                        ||&#39;&lt;/b&gt;&lt;/br&gt;&#39; 
                                        ||NEW.description, 
                            isessionid 
                ); 
   
  END IF; 



-- Auto cerramos los eventos se se haya programado para ser cerrados por la llegada de este evento
-- 1. Obtenemos la lista de los ideventtypes que sern cerrados por el ideventtype de este evento
IF et.enable_auto_close_on_event_defined THEN 
  RAISE notice &#39;&gt;&gt;&gt; 7) SELECT idevent FROM events.datas WHERE ideventtype = ANY(%) AND ideventstatustype = 0 AND idaccount = % AND zu = % AND idevent != %&#39;, et.auto_close_on_event_defined, NEW.idaccount, NEW.zu, NEW.idevent;
  FOR idevent_for_close_on_restore IN 
  SELECT idevent 
  FROM   events.datas 
  WHERE  ideventtype = ANY(et.auto_close_on_event_defined) 
  AND    isopen = true 
  AND    idaccount = NEW.idaccount 
  AND    zu = NEW.zu 
  AND    idevent != NEW.idevent LOOP RAISE notice &#39;&gt;&gt;&gt; 8) Se cierra automaticamente el evento % por restauracion&#39;,
         idevent_for_close_on_restore; 
   
  INSERT INTO events.comments 
              ( 
                          comment_event, 
                          idevent, 
                          idstatustype 
              ) 
              VALUES 
              ( 
                          &#39;Event closed for restoring or status changed event - idevent &#39; 
                                      ||NEW.idevent, 
                          idevent_for_close_on_restore, 
                          7 
              ); 

END LOOP; 
END IF; 

*/



RAISE notice &#39;&gt;&gt;&gt; 9) TERMINA EVENTS_ON_INSERT&#39;; 

/*
-----------------------------------
-- Este bloque es especifico de cada tabla heredada para determinar el idevent del ultimo evento segun los parametros que sean necesarios
CASE 
  WHEN tg_table_name LIKE &#39;events_dbsizes%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.db_name||NEW.db_type::TEXT)::uuid; 
  
WHEN tg_table_name LIKE &#39;events_device_uptime%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

WHEN tg_table_name LIKE &#39;events_diskspace%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.drive)::uuid; 

WHEN tg_table_name LIKE &#39;events_jobs%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.job_name)::uuid; 

WHEN tg_table_name LIKE &#39;events_networkdevice_ping%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

WHEN tg_table_name LIKE &#39;events_login%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  --||NEW.zu::text 
  ||NEW.idadmin::text)::uuid; 


RAISE notice &#39;&gt;&gt;&gt; 9) idaccount % / ideventtype = % / idadmin = %&#39;, NEW.idaccount, NEW.ideventtype, NEW.idadmin;
  
ELSE 

  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

END CASE; 
*/


RETURN NULL; 
END;</programlisting>
      </para>
    </section>

  </chapter>

  <chapter id="gui.schema"
           xreflabel="gui">
    <title>Schema gui</title>
    <para></para>


      <section id="gui.table.column-properties"
               xreflabel="gui.column_properties">
        <title id="gui.table.column-properties-title">
         Table:
         
         <structname>column_properties</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>column_properties</structname>
            </title>


            <varlistentry>
              <term><structfield>hash_num</structfield></term>
              <listitem><para>
                <type>text</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_label</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_width</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_decorator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_class</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_rendercell</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_formatter</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_classname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_position</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 999</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_sortable</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editon</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_resizable</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_iconclass</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;glyphicon-pencil&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_placeholder</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autosave</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autoselect</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_dismissonenter</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor_args</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="gui.table.menus"
               xreflabel="gui.menus">
        <title id="gui.table.menus-title">
         Table:
         
         <structname>menus</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>menus</structname>
            </title>


            <varlistentry>
              <term><structfield>idmenu</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>structure</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;label&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>url</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>parent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>type</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admins</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>nameeventonclick</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="gui.table.tables-view-properties"
               xreflabel="gui.tables_view_properties">
        <title id="gui.table.tables-view-properties-title">
         Table:
         
         <structname>tables_view_properties</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>tables_view_properties</structname>
            </title>


            <varlistentry>
              <term><structfield>title_dgrid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>row_selector_dgrid</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>add_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>delete_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>export_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_selectionmode</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;none&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowtextselection</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_deselectonrefresh</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowselectall</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="gui.view.view-columns-properties"
               xreflabel="gui.view_columns_properties">
        <title id="gui.view.view-columns-properties-title">
         View:
         
         <structname>view_columns_properties</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_columns_properties</structname>
            </title>


            <varlistentry>
              <term><structfield>hash_num</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_schema</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_name</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>data_type</structfield></term>
              <listitem><para>
                <type>information_schema.character_data</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_width</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_decorator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_class</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_rendercell</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_formatter</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_classname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_position</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_sortable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editon</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_resizable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_iconclass</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_placeholder</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autosave</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autoselect</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_dismissonenter</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor_args</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_columns_properties</title>
         <programlisting>
SELECT view_table_schema.hash_num
,
    view_table_schema.tschema_tname
,
    view_table_schema.table_schema
,
    view_table_schema.table_name
,
    view_table_schema.column_name
,
    view_table_schema.data_type
,
    column_properties.column_label
,
    column_properties.column_width
,
    column_properties.column_decorator
,
    column_properties.column_class
,
    column_properties.dgrid_rendercell
,
    column_properties.dgrid_formatter
,
    column_properties.dgrid_classname
,
    column_properties.show
,
    column_properties.column_position
,
    column_properties.dgrid_editable
,
    column_properties.dgrid_sortable
,
    column_properties.dgrid_editon
,
    column_properties.dgrid_resizable
,
    column_properties.field_iconclass
,
    column_properties.field_placeholder
,
    column_properties.dgrid_editor
,
    column_properties.dgrid_autosave
,
    column_properties.dgrid_autoselect
,
    column_properties.dgrid_dismissonenter
,
    column_properties.dgrid_editor_args
   
FROM view_table_schema
,
    gui.column_properties
  
WHERE (view_table_schema.hash_num = column_properties.hash_num);</programlisting>
        </figure>



      </para>
    </section>

      <section id="gui.view.view-table-view-columns-properties"
               xreflabel="gui.view_table_view_columns_properties">
        <title id="gui.view.view-table-view-columns-properties-title">
         View:
         
         <structname>view_table_view_columns_properties</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_table_view_columns_properties</structname>
            </title>


            <varlistentry>
              <term><structfield>title_dgrid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>row_selector_dgrid</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>add_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>delete_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>export_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_selectionmode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowtextselection</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_deselectonrefresh</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowselectall</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>columns_properties</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_table_view_columns_properties</title>
         <programlisting>
SELECT vtvp.title_dgrid
,
    vtvp.row_selector_dgrid
,
    vtvp.add_button_enabled
,
    vtvp.delete_button_enabled
,
    vtvp.export_button_enabled
,
    vtvp.dgrid_selectionmode
,
    vtvp.dgrid_allowtextselection
,
    vtvp.dgrid_deselectonrefresh
,
    vtvp.dgrid_allowselectall
,
    vtvp.ts
,
    vtvp.footprint_row
,
    vtvp.tschema_tname
,
    
(
SELECT to_json
     (array_agg
           (vcp.*)
     ) AS to_json
           
  FROM (
      SELECT view_columns_properties.column_name AS field
           ,
                    view_columns_properties.data_type
           ,
                    view_columns_properties.column_label
           ,
                    view_columns_properties.column_width
           ,
                    view_columns_properties.column_decorator
           ,
                    view_columns_properties.column_class
           ,
                    view_columns_properties.dgrid_rendercell AS &quot;renderCell&quot;
           ,
                    view_columns_properties.dgrid_formatter
           ,
                    view_columns_properties.dgrid_classname
           ,
                    view_columns_properties.show
           ,
                    view_columns_properties.column_position
           ,
                    view_columns_properties.dgrid_editable
           ,
                    view_columns_properties.dgrid_sortable
           ,
                    view_columns_properties.dgrid_editon AS &quot;editOn&quot;
           ,
                    view_columns_properties.dgrid_resizable
           ,
                    view_columns_properties.field_iconclass
           ,
                    view_columns_properties.field_placeholder
           ,
                    view_columns_properties.dgrid_editor AS editor
           ,
                    view_columns_properties.dgrid_autosave
           ,
                    view_columns_properties.dgrid_autoselect
           ,
                    view_columns_properties.dgrid_dismissonenter
           ,
                    view_columns_properties.dgrid_editor_args
                   
        FROM gui.view_columns_properties
                  
       WHERE (view_columns_properties.tschema_tname = vtvp.tschema_tname)
                  
    ORDER BY view_columns_properties.column_position
     ) vcp
) AS columns_properties
   
FROM gui.tables_view_properties vtvp;</programlisting>
        </figure>



      </para>
    </section>

      <section id="gui.view.view-table-view-properties"
               xreflabel="gui.view_table_view_properties">
        <title id="gui.view.view-table-view-properties-title">
         View:
         
         <structname>view_table_view_properties</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_table_view_properties</structname>
            </title>


            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_schema</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>title_dgrid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>row_selector_dgrid</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>add_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>delete_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>export_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_selectionmode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowtextselection</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_deselectonrefresh</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowselectall</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_table_view_properties</title>
         <programlisting>
SELECT view_table_schema.tschema_tname
,
    view_table_schema.table_schema
,
    view_table_schema.table_name
,
    tables_view_properties.title_dgrid
,
    tables_view_properties.row_selector_dgrid
,
    tables_view_properties.add_button_enabled
,
    tables_view_properties.delete_button_enabled
,
    tables_view_properties.export_button_enabled
,
    tables_view_properties.dgrid_selectionmode
,
    tables_view_properties.dgrid_allowtextselection
,
    tables_view_properties.dgrid_deselectonrefresh
,
    tables_view_properties.dgrid_allowselectall
   
FROM view_table_schema
,
    gui.tables_view_properties
  
WHERE (tables_view_properties.tschema_tname = view_table_schema.tschema_tname);</programlisting>
        </figure>



      </para>
    </section>



<!-- Function fun_mapper() -->
    <section id="gui.function.fun-mapper"
             xreflabel="guifun_mapper()">
      <title id="gui.function.fun-mapper-title">
       fun_mapper()
      </title>
      <titleabbrev id="gui.function.fun-mapper-titleabbrev">
       fun_mapper()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR SELECT * FROM public.view_table_schema where table_name NOT LIKE &#39;%_20%&#39; AND table_name NOT LIKE &#39;%_19%&#39;;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP
    
IF NOT EXISTS(SELECT * FROM gui.column_properties WHERE hash_num = cursor1_row.hash_num AND column_label = cursor1_row.column_name) THEN
INSERT INTO gui.column_properties(
            hash_num, column_label)
    VALUES (cursor1_row.hash_num, cursor1_row.column_name);
    
END IF;


IF NOT EXISTS(SELECT * FROM gui.tables_view_properties WHERE tschema_tname = cursor1_row.tschema_tname) THEN
INSERT INTO gui.tables_view_properties(
            tschema_tname)
    VALUES (cursor1_row.tschema_tname);    
END IF;

    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

  </chapter>

  <chapter id="octopus.schema"
           xreflabel="octopus">
    <title>Schema octopus</title>
    <para></para>


      <section id="octopus.table.octopus-by-account"
               xreflabel="octopus.octopus_by_account">
        <title id="octopus.table.octopus-by-account-title">
         Table:
         
         <structname>octopus_by_account</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>octopus_by_account</structname>
            </title>


            <varlistentry>
              <term><structfield>idoctopus_byaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;octopus_by_account_idoctopus_byaccount_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idoctopusfunction</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>next_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>parameters</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>trigger_time</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on octopus_by_account</title>

          <varlistentry>
            <term>ck_octopus_dtstart_dtend</term>
            <listitem><para>CHECK ((datetime_start &lt; datetime_end))</para></listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="octopus.table.octopus-by-equipment"
               xreflabel="octopus.octopus_by_equipment">
        <title id="octopus.table.octopus-by-equipment-title">
         Table:
         
         <structname>octopus_by_equipment</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>octopus_by_equipment</structname>
            </title>


            <varlistentry>
              <term><structfield>idoctopus_byaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;octopus_by_account_idoctopus_byaccount_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idoctopusfunction</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>next_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>parameters</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>trigger_time</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.equipments"/>


              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on octopus_by_equipment</title>

          <varlistentry>
            <term>ck_octopus_dtstart_dtend</term>
            <listitem><para>CHECK ((datetime_start &lt; datetime_end))</para></listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="octopus.table.octopus-function"
               xreflabel="octopus.octopus_function">
        <title id="octopus.table.octopus-function-title">
         Table:
         
         <structname>octopus_function</structname>
        </title>
 

        <para>
          Lista de funciones implementadas en octopus (En el servidor) y sus parametros predeterminados
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>octopus_function</structname>
            </title>


            <varlistentry>
              <term><structfield>idoctopusfunction</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>function_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>default_parameters</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_function</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

              <para>
                Nombre de la funcion en el servidor octopus (Funcion JS)
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>trigger_time</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing octopus.octopus_functions_base via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="octopus.table.octopus-functions-base"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="octopus.table.octopus-functions-base"
               xreflabel="octopus.octopus_functions_base">
        <title id="octopus.table.octopus-functions-base-title">
         Table:
         
         <structname>octopus_functions_base</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>octopus_functions_base</structname>
            </title>


            <varlistentry>
              <term><structfield>idoctopus_byaccount</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idoctopusfunction</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="octopus.table.octopus-function"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>next_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>parameters</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>trigger_time</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on octopus_functions_base</title>

          <varlistentry>
            <term>ck_octopus_dtstart_dtend</term>
            <listitem><para>CHECK ((datetime_start &lt; datetime_end))</para></listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="octopus.table.octopus-task-queue"
               xreflabel="octopus.octopus_task_queue">
        <title id="octopus.table.octopus-task-queue-title">
         Table:
         
         <structname>octopus_task_queue</structname>
        </title>
 

        <para>
          Lista de tareas pendientes para ser procesadas por octopus.

        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>octopus_task_queue</structname>
            </title>


            <varlistentry>
              <term><structfield>idoctopus_taskqueue</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idoctopustask</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_task</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_parameters</structfield></term>
              <listitem><para>
                <type>json</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_status</structfield></term>
              <listitem><para>
                <type>smallint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="octopus.view.view-task-by-account"
               xreflabel="octopus.view_task_by_account">
        <title id="octopus.view.view-task-by-account-title">
         View:
         
         <structname>view_task_by_account</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_task_by_account</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_account</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_task</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idoctopusfunction</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>next_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>parameters</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>trigger_time</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_function</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>function_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_function</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_task_by_account</title>
         <programlisting>
SELECT accounts__.idcontact
,
    accounts__.enabled AS enabled_account
,
    accounts__.idaccountstate
,
    accounts__.idaccounttype
,
    accounts__.iddivision
,
    octopus_by_account.enabled AS enabled_task
,
    octopus_function.idoctopusfunction
,
    octopus_by_account.datetime_start
,
    octopus_by_account.datetime_end
,
    octopus_by_account.last_run
,
    octopus_by_account.next_run
,
    octopus_by_account.status
,
        CASE
            WHEN 
(
     (octopus_by_account.parameters IS NULL)
    OR (length
           (
                 (octopus_by_account.parameters)::text
           ) &gt; 0
     )
) THEN octopus_function.default_parameters
            ELSE octopus_by_account.parameters
        END AS parameters
,
        CASE
            WHEN 
(
     (octopus_by_account.trigger_time IS NULL)
    OR (length
           (
                 (octopus_by_account.trigger_time)::text
           ) &gt; 0
     )
) THEN octopus_function.trigger_time
            ELSE octopus_by_account.trigger_time
        END AS trigger_time
,
    octopus_function.enabled AS enabled_function
,
    octopus_function.function_name
,
    octopus_function.label_function
   
FROM accounts__
,
    octopus.octopus_by_account
,
    octopus.octopus_function
  
WHERE (
     (accounts__.idcontact = octopus_by_account.idaccount)
   AND (octopus_by_account.idoctopusfunction = octopus_function.idoctopusfunction)
);</programlisting>
        </figure>



      </para>
    </section>



  </chapter>

  <chapter id="pgagent.schema"
           xreflabel="pgagent">
    <title>Schema pgagent</title>
    <para>pgAgent system tables</para>


      <section id="pgagent.table.pga-exception"
               xreflabel="pgagent.pga_exception">
        <title id="pgagent.table.pga-exception-title">
         Table:
         
         <structname>pga_exception</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_exception</structname>
            </title>


            <varlistentry>
              <term><structfield>jexid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jexscid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-schedule"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jexdate</structfield></term>
              <listitem><para>
                <type>date</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jextime</structfield></term>
              <listitem><para>
                <type>time without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on pga_exception</title>

          <varlistentry>
            <term>pga_exception_jexscid</term>
            <listitem><para>jexscid</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="pgagent.table.pga-job"
               xreflabel="pgagent.pga_job">
        <title id="pgagent.table.pga-job-title">
         Table:
         
         <structname>pga_job</structname>
        </title>
 

        <para>
          Job main entry
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_job</structname>
            </title>


            <varlistentry>
              <term><structfield>jobid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobjclid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-jobclass"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobname</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobdesc</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobhostagent</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobenabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobcreated</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobchanged</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobagentid</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-jobagent"/>


              </para>

              <para>
                Agent that currently executes this job.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jobnextrun</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>joblastrun</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_joblog via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-joblog"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-jobstep"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-schedule"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="pgagent.table.pga-jobagent"
               xreflabel="pgagent.pga_jobagent">
        <title id="pgagent.table.pga-jobagent-title">
         Table:
         
         <structname>pga_jobagent</structname>
        </title>
 

        <para>
          Active job agents
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_jobagent</structname>
            </title>


            <varlistentry>
              <term><structfield>jagpid</structfield></term>
              <listitem><para>
                <type>integer</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jaglogintime</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jagstation</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_job via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-job"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="pgagent.table.pga-jobclass"
               xreflabel="pgagent.pga_jobclass">
        <title id="pgagent.table.pga-jobclass-title">
         Table:
         
         <structname>pga_jobclass</structname>
        </title>
 

        <para>
          Job classification
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_jobclass</structname>
            </title>


            <varlistentry>
              <term><structfield>jclid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jclname</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_job via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-job"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="pgagent.table.pga-joblog"
               xreflabel="pgagent.pga_joblog">
        <title id="pgagent.table.pga-joblog-title">
         Table:
         
         <structname>pga_joblog</structname>
        </title>
 

        <para>
          Job run logs.
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_joblog</structname>
            </title>


            <varlistentry>
              <term><structfield>jlgid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jlgjobid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-job"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jlgstatus</structfield></term>
              <listitem><para>
                <type>character(1)</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;r&apos;::bpchar</literal>



              </para>

              <para>
                Status of job: r=running, s=successfully finished, f=failed, i=no steps to execute, d=aborted
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jlgstart</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jlgduration</structfield></term>
              <listitem><para>
                <type>interval</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on pga_joblog</title>

          <varlistentry>
            <term>pga_joblog_jlgstatus_check</term>
            <listitem><para>CHECK ((jlgstatus = ANY (ARRAY[&apos;r&apos;::bpchar, &apos;s&apos;::bpchar, &apos;f&apos;::bpchar, &apos;i&apos;::bpchar, &apos;d&apos;::bpchar])))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on pga_joblog</title>

          <varlistentry>
            <term>pga_joblog_jobid</term>
            <listitem><para>jlgjobid</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_jobsteplog via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-jobsteplog"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="pgagent.table.pga-jobstep"
               xreflabel="pgagent.pga_jobstep">
        <title id="pgagent.table.pga-jobstep-title">
         Table:
         
         <structname>pga_jobstep</structname>
        </title>
 

        <para>
          Job step to be executed
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_jobstep</structname>
            </title>


            <varlistentry>
              <term><structfield>jstid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstjobid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-job"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstname</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstdesc</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstenabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstkind</structfield></term>
              <listitem><para>
                <type>character(1)</type>



                <literal>NOT NULL</literal>





              </para>

              <para>
                Kind of jobstep: s=sql, b=batch
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstcode</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstconnstr</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstdbname</structfield></term>
              <listitem><para>
                <type>name</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::name</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jstonerror</structfield></term>
              <listitem><para>
                <type>character(1)</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;f&apos;::bpchar</literal>



              </para>

              <para>
                What to do if step returns an error: f=fail the job, s=mark step as succeeded and continue, i=mark as fail but ignore it and proceed
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscnextrun</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on pga_jobstep</title>

          <varlistentry>
            <term>pga_jobstep_check</term>
            <listitem><para>CHECK ((((jstconnstr &lt;&gt; &apos;&apos;::text) AND (jstkind = &apos;s&apos;::bpchar)) OR ((jstconnstr = &apos;&apos;::text) AND ((jstkind = &apos;b&apos;::bpchar) OR (jstdbname &lt;&gt; &apos;&apos;::name)))))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_jobstep_check1</term>
            <listitem><para>CHECK ((((jstdbname &lt;&gt; &apos;&apos;::name) AND (jstkind = &apos;s&apos;::bpchar)) OR ((jstdbname = &apos;&apos;::name) AND ((jstkind = &apos;b&apos;::bpchar) OR (jstconnstr &lt;&gt; &apos;&apos;::text)))))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_jobstep_jstkind_check</term>
            <listitem><para>CHECK ((jstkind = ANY (ARRAY[&apos;b&apos;::bpchar, &apos;s&apos;::bpchar])))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_jobstep_jstonerror_check</term>
            <listitem><para>CHECK ((jstonerror = ANY (ARRAY[&apos;f&apos;::bpchar, &apos;s&apos;::bpchar, &apos;i&apos;::bpchar])))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on pga_jobstep</title>

          <varlistentry>
            <term>pga_jobstep_jobid</term>
            <listitem><para>jstjobid</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_jobsteplog via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-jobsteplog"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="pgagent.table.pga-jobsteplog"
               xreflabel="pgagent.pga_jobsteplog">
        <title id="pgagent.table.pga-jobsteplog-title">
         Table:
         
         <structname>pga_jobsteplog</structname>
        </title>
 

        <para>
          Job step run logs.
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_jobsteplog</structname>
            </title>


            <varlistentry>
              <term><structfield>jslid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jsljlgid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-joblog"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jsljstid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-jobstep"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jslstatus</structfield></term>
              <listitem><para>
                <type>character(1)</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;r&apos;::bpchar</literal>



              </para>

              <para>
                Status of job step: r=running, s=successfully finished,  f=failed stopping job, i=ignored failure, d=aborted
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jslresult</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Return code of job step
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jslstart</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jslduration</structfield></term>
              <listitem><para>
                <type>interval</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jsloutput</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on pga_jobsteplog</title>

          <varlistentry>
            <term>pga_jobsteplog_jslstatus_check</term>
            <listitem><para>CHECK ((jslstatus = ANY (ARRAY[&apos;r&apos;::bpchar, &apos;s&apos;::bpchar, &apos;i&apos;::bpchar, &apos;f&apos;::bpchar, &apos;d&apos;::bpchar])))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on pga_jobsteplog</title>

          <varlistentry>
            <term>pga_jobsteplog_jslid</term>
            <listitem><para>jsljlgid</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="pgagent.table.pga-schedule"
               xreflabel="pgagent.pga_schedule">
        <title id="pgagent.table.pga-schedule-title">
         Table:
         
         <structname>pga_schedule</structname>
        </title>
 

        <para>
          Job schedule exceptions
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>pga_schedule</structname>
            </title>


            <varlistentry>
              <term><structfield>jscid</structfield></term>
              <listitem><para>
                <type>serial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscjobid</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="pgagent.table.pga-job"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscname</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscdesc</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscenabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscstart</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscend</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscminutes</structfield></term>
              <listitem><para>
                <type>boolean[]</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&apos;::boolean[]</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jschours</structfield></term>
              <listitem><para>
                <type>boolean[]</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&apos;::boolean[]</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscweekdays</structfield></term>
              <listitem><para>
                <type>boolean[]</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;{f,f,f,f,f,f,f}&apos;::boolean[]</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscmonthdays</structfield></term>
              <listitem><para>
                <type>boolean[]</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&apos;::boolean[]</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>jscmonths</structfield></term>
              <listitem><para>
                <type>boolean[]</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;{f,f,f,f,f,f,f,f,f,f,f,f}&apos;::boolean[]</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on pga_schedule</title>

          <varlistentry>
            <term>pga_schedule_jschours_size</term>
            <listitem><para>CHECK ((array_upper(jschours, 1) = 24))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_schedule_jscminutes_size</term>
            <listitem><para>CHECK ((array_upper(jscminutes, 1) = 60))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_schedule_jscmonthdays_size</term>
            <listitem><para>CHECK ((array_upper(jscmonthdays, 1) = 32))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_schedule_jscmonths_size</term>
            <listitem><para>CHECK ((array_upper(jscmonths, 1) = 12))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>pga_schedule_jscweekdays_size</term>
            <listitem><para>CHECK ((array_upper(jscweekdays, 1) = 7))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on pga_schedule</title>

          <varlistentry>
            <term>pga_jobschedule_jobid</term>
            <listitem><para>jscjobid</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing pgagent.pga_exception via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="pgagent.table.pga-exception"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>



<!-- Function pga_exception_trigger() -->
    <section id="pgagent.function.pga-exception-trigger"
             xreflabel="pgagentpga_exception_trigger()">
      <title id="pgagent.function.pga-exception-trigger-title">
       pga_exception_trigger()
      </title>
      <titleabbrev id="pgagent.function.pga-exception-trigger-titleabbrev">
       pga_exception_trigger()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Update the job&apos;s next run time whenever an exception changes
        <programlisting>
DECLARE

    v_jobid int4 := 0;

BEGIN

     IF TG_OP = &#39;DELETE&#39; THEN

        SELECT INTO v_jobid jscjobid FROM pgagent.pga_schedule WHERE jscid = OLD.jexscid;

        -- update pga_job from remaining schedules
        -- the actual calculation of jobnextrun will be performed in the trigger
        UPDATE pgagent.pga_job
           SET jobnextrun = NULL
         WHERE jobenabled AND jobid = v_jobid;
        RETURN OLD;
    ELSE

        SELECT INTO v_jobid jscjobid FROM pgagent.pga_schedule WHERE jscid = NEW.jexscid;

        UPDATE pgagent.pga_job
           SET jobnextrun = NULL
         WHERE jobenabled AND jobid = v_jobid;
        RETURN NEW;
    END IF;
END;
</programlisting>
      </para>
    </section>

<!-- Function pga_is_leap_year(smallint) -->
    <section id="pgagent.function.pga-is-leap-year-smallint"
             xreflabel="pgagentpga_is_leap_year(smallint)">
      <title id="pgagent.function.pga-is-leap-year-smallint-title">
       pga_is_leap_year(smallint)
      </title>
      <titleabbrev id="pgagent.function.pga-is-leap-year-smallint-titleabbrev">
       pga_is_leap_year(smallint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       Returns TRUE if $1 is a leap year
        <programlisting>
BEGIN
    IF $1 % 4 != 0 THEN
        RETURN FALSE;
    END IF;

    IF $1 % 100 != 0 THEN
        RETURN TRUE;
    END IF;

    RETURN $1 % 400 = 0;
END;
</programlisting>
      </para>
    </section>

<!-- Function pga_job_trigger() -->
    <section id="pgagent.function.pga-job-trigger"
             xreflabel="pgagentpga_job_trigger()">
      <title id="pgagent.function.pga-job-trigger-title">
       pga_job_trigger()
      </title>
      <titleabbrev id="pgagent.function.pga-job-trigger-titleabbrev">
       pga_job_trigger()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Update the job&apos;s next run time.
        <programlisting>
BEGIN
    IF NEW.jobenabled THEN
        IF NEW.jobnextrun IS NULL THEN
             SELECT INTO NEW.jobnextrun
                    MIN(pgagent.pga_next_schedule(jscid, jscstart, jscend, jscminutes, jschours, jscweekdays, jscmonthdays, jscmonths))
               FROM pgagent.pga_schedule
              WHERE jscenabled AND jscjobid=OLD.jobid;
        END IF;
    ELSE
        NEW.jobnextrun := NULL;
    END IF;
    RETURN NEW;
END;
</programlisting>
      </para>
    </section>

<!-- Function pga_next_schedule(integer, timestamp with time zone, timestamp with time zone, boolean[], boolean[], boolean[], boolean[], boolean[]) -->
    <section id="pgagent.function.pga-next-schedule-integer-timestamp-with-time-zone-timestamp-with-time-zone-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY"
             xreflabel="pgagentpga_next_schedule(integer, timestamp with time zone, timestamp with time zone, boolean[], boolean[], boolean[], boolean[], boolean[])">
      <title id="pgagent.function.pga-next-schedule-integer-timestamp-with-time-zone-timestamp-with-time-zone-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY-title">
       pga_next_schedule(integer, timestamp with time zone, timestamp with time zone, boolean[], boolean[], boolean[], boolean[], boolean[])
      </title>
      <titleabbrev id="pgagent.function.pga-next-schedule-integer-timestamp-with-time-zone-timestamp-with-time-zone-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY-booleanARRAY-titleabbrev">
       pga_next_schedule(integer, timestamp with time zone, timestamp with time zone, boolean[], boolean[], boolean[], boolean[], boolean[])
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>timestamp with time zone</seg>
        </seglistitem>
       </segmentedlist>
 
       Calculates the next runtime for a given schedule
        <programlisting>
DECLARE
    jscid           ALIAS FOR $1;
    jscstart        ALIAS FOR $2;
    jscend          ALIAS FOR $3;
    jscminutes      ALIAS FOR $4;
    jschours        ALIAS FOR $5;
    jscweekdays     ALIAS FOR $6;
    jscmonthdays    ALIAS FOR $7;
    jscmonths       ALIAS FOR $8;

    nextrun         timestamp := &#39;1970-01-01 00:00:00-00&#39;;
    runafter        timestamp := &#39;1970-01-01 00:00:00-00&#39;;

    bingo            bool := FALSE;
    gotit            bool := FALSE;
    foundval        bool := FALSE;
    daytweak        bool := FALSE;
    minutetweak        bool := FALSE;

    i                int2 := 0;
    d                int2 := 0;

    nextminute        int2 := 0;
    nexthour        int2 := 0;
    nextday            int2 := 0;
    nextmonth       int2 := 0;
    nextyear        int2 := 0;


BEGIN
    -- No valid start date has been specified
    IF jscstart IS NULL THEN RETURN NULL; END IF;

    -- The schedule is past its end date
    IF jscend IS NOT NULL AND jscend &lt; now() THEN RETURN NULL; END IF;

    -- Get the time to find the next run after. It will just be the later of
    -- now() + 1m and the start date for the time being, however, we might want to
    -- do more complex things using this value in the future.
    IF date_trunc(&#39;MINUTE&#39;, jscstart) &gt; date_trunc(&#39;MINUTE&#39;, (now() + &#39;1 Minute&#39;::interval)) THEN
        runafter := date_trunc(&#39;MINUTE&#39;, jscstart);
    ELSE
        runafter := date_trunc(&#39;MINUTE&#39;, (now() + &#39;1 Minute&#39;::interval));
    END IF;

    --
    -- Enter a loop, generating next run timestamps until we find one
    -- that falls on the required weekday, and is not matched by an exception
    --

    WHILE bingo = FALSE LOOP

        --
        -- Get the next run year
        --
        nextyear := date_part(&#39;YEAR&#39;, runafter);

        --
        -- Get the next run month
        --
        nextmonth := date_part(&#39;MONTH&#39;, runafter);
        gotit := FALSE;
        FOR i IN (nextmonth) .. 12 LOOP
            IF jscmonths[i] = TRUE THEN
                nextmonth := i;
                gotit := TRUE;
                foundval := TRUE;
                EXIT;
            END IF;
        END LOOP;
        IF gotit = FALSE THEN
            FOR i IN 1 .. (nextmonth - 1) LOOP
                IF jscmonths[i] = TRUE THEN
                    nextmonth := i;

                    -- Wrap into next year
                    nextyear := nextyear + 1;
                    gotit := TRUE;
                    foundval := TRUE;
                    EXIT;
                END IF;
           END LOOP;
        END IF;

        --
        -- Get the next run day
        --
        -- If the year, or month have incremented, get the lowest day,
        -- otherwise look for the next day matching or after today.
        IF (nextyear &gt; date_part(&#39;YEAR&#39;, runafter) OR nextmonth &gt; date_part(&#39;MONTH&#39;, runafter)) THEN
            nextday := 1;
            FOR i IN 1 .. 32 LOOP
                IF jscmonthdays[i] = TRUE THEN
                    nextday := i;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
        ELSE
            nextday := date_part(&#39;DAY&#39;, runafter);
            gotit := FALSE;
            FOR i IN nextday .. 32 LOOP
                IF jscmonthdays[i] = TRUE THEN
                    nextday := i;
                    gotit := TRUE;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
            IF gotit = FALSE THEN
                FOR i IN 1 .. (nextday - 1) LOOP
                    IF jscmonthdays[i] = TRUE THEN
                        nextday := i;

                        -- Wrap into next month
                        IF nextmonth = 12 THEN
                            nextyear := nextyear + 1;
                            nextmonth := 1;
                        ELSE
                            nextmonth := nextmonth + 1;
                        END IF;
                        gotit := TRUE;
                        foundval := TRUE;
                        EXIT;
                    END IF;
                END LOOP;
            END IF;
        END IF;

        -- Was the last day flag selected?
        IF nextday = 32 THEN
            IF nextmonth = 1 THEN
                nextday := 31;
            ELSIF nextmonth = 2 THEN
                IF pgagent.pga_is_leap_year(nextyear) = TRUE THEN
                    nextday := 29;
                ELSE
                    nextday := 28;
                END IF;
            ELSIF nextmonth = 3 THEN
                nextday := 31;
            ELSIF nextmonth = 4 THEN
                nextday := 30;
            ELSIF nextmonth = 5 THEN
                nextday := 31;
            ELSIF nextmonth = 6 THEN
                nextday := 30;
            ELSIF nextmonth = 7 THEN
                nextday := 31;
            ELSIF nextmonth = 8 THEN
                nextday := 31;
            ELSIF nextmonth = 9 THEN
                nextday := 30;
            ELSIF nextmonth = 10 THEN
                nextday := 31;
            ELSIF nextmonth = 11 THEN
                nextday := 30;
            ELSIF nextmonth = 12 THEN
                nextday := 31;
            END IF;
        END IF;

        --
        -- Get the next run hour
        --
        -- If the year, month or day have incremented, get the lowest hour,
        -- otherwise look for the next hour matching or after the current one.
        IF (nextyear &gt; date_part(&#39;YEAR&#39;, runafter) OR nextmonth &gt; date_part(&#39;MONTH&#39;, runafter) OR nextday &gt; date_part(&#39;DAY&#39;, runafter) OR daytweak = TRUE) THEN
            nexthour := 0;
            FOR i IN 1 .. 24 LOOP
                IF jschours[i] = TRUE THEN
                    nexthour := i - 1;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
        ELSE
            nexthour := date_part(&#39;HOUR&#39;, runafter);
            gotit := FALSE;
            FOR i IN (nexthour + 1) .. 24 LOOP
                IF jschours[i] = TRUE THEN
                    nexthour := i - 1;
                    gotit := TRUE;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
            IF gotit = FALSE THEN
                FOR i IN 1 .. nexthour LOOP
                    IF jschours[i] = TRUE THEN
                        nexthour := i - 1;

                        -- Wrap into next month
                        IF (nextmonth = 1 OR nextmonth = 3 OR nextmonth = 5 OR nextmonth = 7 OR nextmonth = 8 OR nextmonth = 10 OR nextmonth = 12) THEN
                            d = 31;
                        ELSIF (nextmonth = 4 OR nextmonth = 6 OR nextmonth = 9 OR nextmonth = 11) THEN
                            d = 30;
                        ELSE
                            IF pgagent.pga_is_leap_year(nextyear) = TRUE THEN
                                d := 29;
                            ELSE
                                d := 28;
                            END IF;
                        END IF;

                        IF nextday = d THEN
                            nextday := 1;
                            IF nextmonth = 12 THEN
                                nextyear := nextyear + 1;
                                nextmonth := 1;
                            ELSE
                                nextmonth := nextmonth + 1;
                            END IF;
                        ELSE
                            nextday := nextday + 1;
                        END IF;

                        gotit := TRUE;
                        foundval := TRUE;
                        EXIT;
                    END IF;
                END LOOP;
            END IF;
        END IF;

        --
        -- Get the next run minute
        --
        -- If the year, month day or hour have incremented, get the lowest minute,
        -- otherwise look for the next minute matching or after the current one.
        IF (nextyear &gt; date_part(&#39;YEAR&#39;, runafter) OR nextmonth &gt; date_part(&#39;MONTH&#39;, runafter) OR nextday &gt; date_part(&#39;DAY&#39;, runafter) OR nexthour &gt; date_part(&#39;HOUR&#39;, runafter) OR daytweak = TRUE) THEN
            nextminute := 0;
            IF minutetweak = TRUE THEN
        d := 1;
            ELSE
        d := date_part(&#39;YEAR&#39;, runafter)::int2;
            END IF;
            FOR i IN d .. 60 LOOP
                IF jscminutes[i] = TRUE THEN
                    nextminute := i - 1;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
        ELSE
            nextminute := date_part(&#39;MINUTE&#39;, runafter);
            gotit := FALSE;
            FOR i IN (nextminute + 1) .. 60 LOOP
                IF jscminutes[i] = TRUE THEN
                    nextminute := i - 1;
                    gotit := TRUE;
                    foundval := TRUE;
                    EXIT;
                END IF;
            END LOOP;
            IF gotit = FALSE THEN
                FOR i IN 1 .. nextminute LOOP
                    IF jscminutes[i] = TRUE THEN
                        nextminute := i - 1;

                        -- Wrap into next hour
                        IF (nextmonth = 1 OR nextmonth = 3 OR nextmonth = 5 OR nextmonth = 7 OR nextmonth = 8 OR nextmonth = 10 OR nextmonth = 12) THEN
                            d = 31;
                        ELSIF (nextmonth = 4 OR nextmonth = 6 OR nextmonth = 9 OR nextmonth = 11) THEN
                            d = 30;
                        ELSE
                            IF pgagent.pga_is_leap_year(nextyear) = TRUE THEN
                                d := 29;
                            ELSE
                                d := 28;
                            END IF;
                        END IF;

                        IF nexthour = 23 THEN
                            nexthour = 0;
                            IF nextday = d THEN
                                nextday := 1;
                                IF nextmonth = 12 THEN
                                    nextyear := nextyear + 1;
                                    nextmonth := 1;
                                ELSE
                                    nextmonth := nextmonth + 1;
                                END IF;
                            ELSE
                                nextday := nextday + 1;
                            END IF;
                        ELSE
                            nexthour := nexthour + 1;
                        END IF;

                        gotit := TRUE;
                        foundval := TRUE;
                        EXIT;
                    END IF;
                END LOOP;
            END IF;
        END IF;

        -- Build the result, and check it is not the same as runafter - this may
        -- happen if all array entries are set to false. In this case, add a minute.

        nextrun := (nextyear::varchar || &#39;-&#39;::varchar || nextmonth::varchar || &#39;-&#39; || nextday::varchar || &#39; &#39; || nexthour::varchar || &#39;:&#39; || nextminute::varchar)::timestamptz;

        IF nextrun = runafter AND foundval = FALSE THEN
                nextrun := nextrun + INTERVAL &#39;1 Minute&#39;;
        END IF;

        -- If the result is past the end date, exit.
        IF nextrun &gt; jscend THEN
            RETURN NULL;
        END IF;

        -- Check to ensure that the nextrun time is actually still valid. Its
        -- possible that wrapped values may have carried the nextrun onto an
        -- invalid time or date.
        IF ((jscminutes = &#39;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&#39; OR jscminutes[date_part(&#39;MINUTE&#39;, nextrun) + 1] = TRUE) AND
            (jschours = &#39;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&#39; OR jschours[date_part(&#39;HOUR&#39;, nextrun) + 1] = TRUE) AND
            (jscmonthdays = &#39;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f}&#39; OR jscmonthdays[date_part(&#39;DAY&#39;, nextrun)] = TRUE OR
            (jscmonthdays = &#39;{f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,t}&#39; AND
             ((date_part(&#39;MONTH&#39;, nextrun) IN (1,3,5,7,8,10,12) AND date_part(&#39;DAY&#39;, nextrun) = 31) OR
              (date_part(&#39;MONTH&#39;, nextrun) IN (4,6,9,11) AND date_part(&#39;DAY&#39;, nextrun) = 30) OR
              (date_part(&#39;MONTH&#39;, nextrun) = 2 AND ((pgagent.pga_is_leap_year(date_part(&#39;DAY&#39;, nextrun)::int2) AND date_part(&#39;DAY&#39;, nextrun) = 29) OR date_part(&#39;DAY&#39;, nextrun) = 28))))) AND
            (jscmonths = &#39;{f,f,f,f,f,f,f,f,f,f,f,f}&#39; OR jscmonths[date_part(&#39;MONTH&#39;, nextrun)] = TRUE)) THEN


            -- Now, check to see if the nextrun time found is a) on an acceptable
            -- weekday, and b) not matched by an exception. If not, set
            -- runafter = nextrun and try again.

            -- Check for a wildcard weekday
            gotit := FALSE;
            FOR i IN 1 .. 7 LOOP
                IF jscweekdays[i] = TRUE THEN
                    gotit := TRUE;
                    EXIT;
                END IF;
            END LOOP;

            -- OK, is the correct weekday selected, or a wildcard?
            IF (jscweekdays[date_part(&#39;DOW&#39;, nextrun) + 1] = TRUE OR gotit = FALSE) THEN

                -- Check for exceptions
                SELECT INTO d jexid FROM pgagent.pga_exception WHERE jexscid = jscid AND ((jexdate = nextrun::date AND jextime = nextrun::time) OR (jexdate = nextrun::date AND jextime IS NULL) OR (jexdate IS NULL AND jextime = nextrun::time));
                IF FOUND THEN
                    -- Nuts - found an exception. Increment the time and try again
                    runafter := nextrun + INTERVAL &#39;1 Minute&#39;;
                    bingo := FALSE;
                    minutetweak := TRUE;
            daytweak := FALSE;
                ELSE
                    bingo := TRUE;
                END IF;
            ELSE
                -- We&#39;re on the wrong week day - increment a day and try again.
                runafter := nextrun + INTERVAL &#39;1 Day&#39;;
                bingo := FALSE;
                minutetweak := FALSE;
                daytweak := TRUE;
            END IF;

        ELSE
            runafter := nextrun + INTERVAL &#39;1 Minute&#39;;
            bingo := FALSE;
            minutetweak := TRUE;
        daytweak := FALSE;
        END IF;

    END LOOP;

    RETURN nextrun;
END;
</programlisting>
      </para>
    </section>

<!-- Function pga_schedule_trigger() -->
    <section id="pgagent.function.pga-schedule-trigger"
             xreflabel="pgagentpga_schedule_trigger()">
      <title id="pgagent.function.pga-schedule-trigger-title">
       pga_schedule_trigger()
      </title>
      <titleabbrev id="pgagent.function.pga-schedule-trigger-titleabbrev">
       pga_schedule_trigger()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Update the job&apos;s next run time whenever a schedule changes
        <programlisting>
BEGIN
    IF TG_OP = &#39;DELETE&#39; THEN
        -- update pga_job from remaining schedules
        -- the actual calculation of jobnextrun will be performed in the trigger
        UPDATE pgagent.pga_job
           SET jobnextrun = NULL
         WHERE jobenabled AND jobid=OLD.jscjobid;
        RETURN OLD;
    ELSE
        UPDATE pgagent.pga_job
           SET jobnextrun = NULL
         WHERE jobenabled AND jobid=NEW.jscjobid;
        RETURN NEW;
    END IF;
END;
</programlisting>
      </para>
    </section>

<!-- Function pgagent_schema_version() -->
    <section id="pgagent.function.pgagent-schema-version"
             xreflabel="pgagentpgagent_schema_version()">
      <title id="pgagent.function.pgagent-schema-version-title">
       pgagent_schema_version()
      </title>
      <titleabbrev id="pgagent.function.pgagent-schema-version-titleabbrev">
       pgagent_schema_version()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>smallint</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>
BEGIN
    -- RETURNS PGAGENT MAJOR VERSION
    -- WE WILL CHANGE THE MAJOR VERSION, ONLY IF THERE IS A SCHEMA CHANGE
    RETURN 3;
END;
</programlisting>
      </para>
    </section>

  </chapter>

  <chapter id="public.schema"
           xreflabel="public">
    <title>Schema public</title>
    <para>standard public schema</para>


      <section id="public.table.account-contacts"
               xreflabel="public.account_contacts">
        <title id="public.table.account-contacts-title">
         Table:
         
         <structname>account_contacts</structname>
        </title>
 

        <para>
          Usuarios de un abonado (cliente).
No hay como usar idacount como llave foranea porque es una tabla heredada, hay que hacer la comprobacion manualmente.
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>account_contacts</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

              <para>
                ID de la cuenta
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

              <para>
                ID asociado de la lista de contactos
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 5</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on account_contacts</title>

          <varlistentry>
            <term>index_account_contacts_appointment</term>
            <listitem><para>appointment) WHERE (appointment = &apos;oams_assigned&apos;::text</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.account-states"
               xreflabel="public.account_states">
        <title id="public.table.account-states-title">
         Table:
         
         <structname>account_states</structname>
        </title>
 

        <para>
          Lista de posibles estados de un abonado
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>account_states</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>state</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.accounts via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.accounts"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.account-types"
               xreflabel="public.account_types">
        <title id="public.table.account-types-title">
         Table:
         
         <structname>account_types</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>account_types</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>type</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.account-users"
               xreflabel="public.account_users">
        <title id="public.table.account-users-title">
         Table:
         
         <structname>account_users</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>account_users</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;account_users_idaccountuser_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 5</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_user</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>date_start</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>date_end</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>user</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on account_users</title>

          <varlistentry>
            <term>index_account_user__user_pwd</term>
            <listitem><para>account_user, account_pwd</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.accounts"
               xreflabel="public.accounts">
        <title id="public.table.accounts-title">
         Table:
         
         <structname>accounts</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>accounts</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;contacts_idcontact_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT true</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.account-states"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>end_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>cost_center</structfield></term>
              <listitem><para>
                <type>character varying(5)</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on accounts</title>

          <varlistentry>
            <term>accounts__account_idx</term>
            <listitem><para>account</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing events.datas via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.equipments"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.accounts"
               xreflabel="public.accounts__">
        <title id="public.table.accounts-title">
         Table:
         
         <structname>accounts__</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>accounts__</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;contacts_idcontact_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT true</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>first_name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>gender</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>end_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>








                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="public.table.divisions"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admins</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                Lista de administradores asignados a la cuenta
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>cost_center</structfield></term>
              <listitem><para>
                <type>character varying(5)</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on accounts__</title>

          <varlistentry>
            <term>index_accounts_account</term>
            <listitem><para>account</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing octopus.octopus_by_account via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="octopus.table.octopus-by-account"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.account-contacts"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.account-users"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-dbsizes"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-dbsizes-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-1990"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2016"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.admins"
               xreflabel="public.admins">
        <title id="public.table.admins-title">
         Table:
         
         <structname>admins</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>admins</structname>
            </title>


            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigserial</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="contacts.table.contacts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_username</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_sessionid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_ip</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_level</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_role</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_locked_date</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_failed_access_attempts</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;Admin&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_access</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_heartbeat</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha de ultimo registro cuando el usuario estaba conectado, sirve para determinar que usuarios estan conectados y para cerrar session en X tiempo que no se tiene reporte del usuario.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>divisions</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                Division a la que el administrador tendra acceso.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounts</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                Matriz de idaccounts asignados a este administrador
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>email_notification</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                Ids del email que se usara para notificaciones o informacion desde el sistema.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>xmpp_notification</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                ids de las cuentas de xmpp que se usaran para notificaciones al administrador.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_attention_group</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

              <para>
                Grupos de atencion, para poder asignar tareas segun el grupo de atencion que tengan.
Puede pertenecer a diferenctes grupos de atencion.


              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing events.datas_000112 via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas-000112"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-199001"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201504"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201506"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201508"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201509"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201510"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201511"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201610"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201701"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201704"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201705"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-1990"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2014"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-login-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2017"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.attachments"
               xreflabel="public.attachments">
        <title id="public.table.attachments-title">
         Table:
         
         <structname>attachments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>attachments</structname>
            </title>


            <varlistentry>
              <term><structfield>idattachment</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>file</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>md5</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.event_comments_attachments via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.event-comments-attachments"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.attention-group"
               xreflabel="public.attention_group">
        <title id="public.table.attention-group-title">
         Table:
         
         <structname>attention_group</structname>
        </title>
 

        <para>
          Define los grupos de atencion
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>attention_group</structname>
            </title>


            <varlistentry>
              <term><structfield>idattention_group</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>group</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.configuration-server"
               xreflabel="public.configuration_server">
        <title id="public.table.configuration-server-title">
         Table:
         
         <structname>configuration_server</structname>
        </title>
 

        <para>
          Tabla de configuracion en JSON para el servidor
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>configuration_server</structname>
            </title>


            <varlistentry>
              <term><structfield>idconfigserver</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>config_name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>configuration</structfield></term>
              <listitem><para>
                <type>json</type>



                <literal>NOT NULL</literal>





              </para>

              <para>
                Configuracion que sera usada por la aplicacion.
              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.divisions"
               xreflabel="public.divisions">
        <title id="public.table.divisions-title">
         Table:
         
         <structname>divisions</structname>
        </title>
 

        <para>
          Division, area, grupo empresarial, etc
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>divisions</structname>
            </title>


            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notes</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.accounts__ via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.accounts"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.groups"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.emails"
               xreflabel="public.emails">
        <title id="public.table.emails-title">
         Table:
         
         <structname>emails</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>emails</structname>
            </title>


            <varlistentry>
              <term><structfield>idemail</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>email</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT 1</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_if_administrator</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

              <para>
                Habilita envio de email de notificacion a esta direccion de corre cuando el email corresponde a un usuario administrador del sistema
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.equipments"
               xreflabel="public.equipments">
        <title id="public.table.equipments-title">
         Table:
         
         <structname>equipments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>equipments</structname>
            </title>


            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mark</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>model</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>serial_number</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Numero de serie que viene en el producto
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>installation_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uninstall_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code_ref</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>










              </para>

              <para>
                Codigo para uso interno
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>operability</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT 100</literal>



              </para>

              <para>
                Porcentage de operatividad del equipo
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>agreement_code_provider</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Numero de contrato, numero o codigo con que el proveedor nos conoce.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

              <para>
                Numero de validacion junto con el idequipment para aceptar eventos via http.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>eventtypes</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

              <para>
                Tipos de eventos que se van a monitorear de este equipo.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcustodian</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                corresponde al Idcontact de quien esta a cargo de ese equipo.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>additional_properties</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on equipments</title>

          <varlistentry>
            <term>index_equipment_eq</term>
            <listitem><para>equipment</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing octopus.octopus_by_equipment via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="octopus.table.octopus-by-equipment"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.event-comments"
               xreflabel="public.event_comments">
        <title id="public.table.event-comments-title">
         Table:
         
         <structname>event_comments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_comments</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventcomment</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>seconds</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>comment_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                Este campo es necesario para actualiza la tabla events cuando un comentario es ingresado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                Campo donde va registrado quien ingresa el cambio, idadmin ya no va porque lod contactos tambien ya pueden ingresar novedades y realizar cometarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on event_comments</title>

          <varlistentry>
            <term>index_ec_idevent</term>
            <listitem><para>idevent</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.event-comments-2016"
               xreflabel="public.event_comments_2016">
        <title id="public.table.event-comments-2016-title">
         Table:
         
         <structname>event_comments_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_comments_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventcomment</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;event_comments_ideventcomment_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>seconds</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>comment_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                Este campo es necesario para actualiza la tabla events cuando un comentario es ingresado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on event_comments_2016</title>

          <varlistentry>
            <term>event_comments_2016_idevent_idx</term>
            <listitem><para>idevent</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.event-comments-2017"
               xreflabel="public.event_comments_2017">
        <title id="public.table.event-comments-2017-title">
         Table:
         
         <structname>event_comments_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_comments_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventcomment</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;event_comments_ideventcomment_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>seconds</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>comment_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                Este campo es necesario para actualiza la tabla events cuando un comentario es ingresado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                Campo donde va registrado quien ingresa el cambio, idadmin ya no va porque lod contactos tambien ya pueden ingresar novedades y realizar cometarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on event_comments_2017</title>

          <varlistentry>
            <term>event_comments_2017_idevent_idx</term>
            <listitem><para>idevent</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.event-comments-attachments"
               xreflabel="public.event_comments_attachments">
        <title id="public.table.event-comments-attachments-title">
         Table:
         
         <structname>event_comments_attachments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_comments_attachments</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventcommentattach</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idattachment</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.attachments"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.event-reception-modes"
               xreflabel="public.event_reception_modes">
        <title id="public.table.event-reception-modes-title">
         Table:
         
         <structname>event_reception_modes</structname>
        </title>
 

        <para>
          Tipos de recepcion de eventos:
Puede ser:
GPRS
SMS
CALL
SYSTEM
LAN
VERBAL
ETC
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_reception_modes</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mode</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_mode</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.events_2016 via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.events-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-1990"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2014"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-login-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2017"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.event-statustypes"
               xreflabel="public.event_statustypes">
        <title id="public.table.event-statustypes-title">
         Table:
         
         <structname>event_statustypes</structname>
        </title>
 

        <para>
          Lista de los tipos de estado de un evento:
- Asignado
- En espera
- Cerrado
- En atencion
- etc
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>event_statustypes</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_status</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>internal</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.events via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.events"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2016"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.events"
               xreflabel="public.events">
        <title id="public.table.events-title">
         Table:
         
         <structname>events</structname>
        </title>
 

        <para>
          Las notificaciones de los ecentos solo se muestran al usuario si su proiridad es &lt;= 20
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>events</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-statustypes"/>


              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events</title>

          <varlistentry>
            <term>index_events_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-2015"
               xreflabel="public.events_2015">
        <title id="public.table.events-2015-title">
         Table:
         
         <structname>events_2015</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_2015</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_2015</title>

          <varlistentry>
            <term>events_2015_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-2016"
               xreflabel="public.events_2016">
        <title id="public.table.events-2016-title">
         Table:
         
         <structname>events_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-statustypes"/>


              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_2016</title>

          <varlistentry>
            <term>events_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_2016</title>

          <varlistentry>
            <term>index_events_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-2017"
               xreflabel="public.events_2017">
        <title id="public.table.events-2017-title">
         Table:
         
         <structname>events_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Campo no debe ser editado manualmente, se actualiza segun el idstatustype, se crea para crear un indice que mejore el tiempo de busqueda de eventos abiertos.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                id del administrador que al momento tiene a cargo el evento
              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_2017</title>

          <varlistentry>
            <term>events_2017_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_2017</title>

          <varlistentry>
            <term>events_2017_idaccount_ideventtype_idx</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-dbsizes"
               xreflabel="public.events_dbsizes">
        <title id="public.table.events-dbsizes-title">
         Table:
         
         <structname>events_dbsizes</structname>
        </title>
 

        <para>
          Aqui no debe crearse el check de fecha ya que ese check se lo crea en cada tabla hija
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_dbsizes</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_size</structfield></term>
              <listitem><para>
                <type>real</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_type</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-dbsizes-2015"
               xreflabel="public.events_dbsizes_2015">
        <title id="public.table.events-dbsizes-2015-title">
         Table:
         
         <structname>events_dbsizes_2015</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_dbsizes_2015</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_size</structfield></term>
              <listitem><para>
                <type>real</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_type</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-dbsizes-2016"
               xreflabel="public.events_dbsizes_2016">
        <title id="public.table.events-dbsizes-2016-title">
         Table:
         
         <structname>events_dbsizes_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_dbsizes_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_size</structfield></term>
              <listitem><para>
                <type>real</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>db_type</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_dbsizes_2016</title>

          <varlistentry>
            <term>events_dbsizes_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_dbsizes_2016</title>

          <varlistentry>
            <term>index_events_dbsizes_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_dbsizes_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-device-uptime"
               xreflabel="public.events_device_uptime">
        <title id="public.table.events-device-uptime-title">
         Table:
         
         <structname>events_device_uptime</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_device_uptime</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uptime</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-device-uptime-2015"
               xreflabel="public.events_device_uptime_2015">
        <title id="public.table.events-device-uptime-2015-title">
         Table:
         
         <structname>events_device_uptime_2015</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_device_uptime_2015</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uptime</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-device-uptime-2016"
               xreflabel="public.events_device_uptime_2016">
        <title id="public.table.events-device-uptime-2016-title">
         Table:
         
         <structname>events_device_uptime_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_device_uptime_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-statustypes"/>


              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uptime</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_device_uptime_2016</title>

          <varlistentry>
            <term>events_device_uptime_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_device_uptime_2016</title>

          <varlistentry>
            <term>index_events_device_uptime_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_device_uptime_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-device-uptime-2017"
               xreflabel="public.events_device_uptime_2017">
        <title id="public.table.events-device-uptime-2017-title">
         Table:
         
         <structname>events_device_uptime_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_device_uptime_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uptime</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_device_uptime_2017</title>

          <varlistentry>
            <term>events_device_uptime_2017_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_device_uptime_2017</title>

          <varlistentry>
            <term>index_events_device_uptime_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-diskspace"
               xreflabel="public.events_diskspace">
        <title id="public.table.events-diskspace-title">
         Table:
         
         <structname>events_diskspace</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_diskspace</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive</structfield></term>
              <listitem><para>
                <type>character(3)</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_size</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_free</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-diskspace-2015"
               xreflabel="public.events_diskspace_2015">
        <title id="public.table.events-diskspace-2015-title">
         Table:
         
         <structname>events_diskspace_2015</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_diskspace_2015</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive</structfield></term>
              <listitem><para>
                <type>character(3)</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_size</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_free</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_diskspace_2015</title>

          <varlistentry>
            <term>events_diskspace_check_ideventtype</term>
            <listitem><para>CHECK (((ideventtype = 62) OR (ideventtype = 52)))</para></listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-diskspace-2016"
               xreflabel="public.events_diskspace_2016">
        <title id="public.table.events-diskspace-2016-title">
         Table:
         
         <structname>events_diskspace_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_diskspace_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-statustypes"/>


              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive</structfield></term>
              <listitem><para>
                <type>character(3)</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_size</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_free</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_diskspace_2016</title>

          <varlistentry>
            <term>events_diskspace_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>events_diskspace_check_ideventtype</term>
            <listitem><para>CHECK (((ideventtype = 62) OR (ideventtype = 52)))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_diskspace_2016</title>

          <varlistentry>
            <term>index_events_diskspace_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_diskspace_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-diskspace-2017"
               xreflabel="public.events_diskspace_2017">
        <title id="public.table.events-diskspace-2017-title">
         Table:
         
         <structname>events_diskspace_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_diskspace_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive</structfield></term>
              <listitem><para>
                <type>character(3)</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_size</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>drive_free</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_diskspace_2017</title>

          <varlistentry>
            <term>events_diskspace_2017_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_diskspace_2017</title>

          <varlistentry>
            <term>index_events_diskspace_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-jobs"
               xreflabel="public.events_jobs">
        <title id="public.table.events-jobs-title">
         Table:
         
         <structname>events_jobs</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-jobs-1990"
               xreflabel="public.events_jobs_1990">
        <title id="public.table.events-jobs-1990-title">
         Table:
         
         <structname>events_jobs_1990</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs_1990</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_jobs_1990</title>

          <varlistentry>
            <term>events_jobs_1990_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (1990)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_jobs_1990</title>

          <varlistentry>
            <term>index_events_jobs_1990_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_jobs_1990_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-jobs-2014"
               xreflabel="public.events_jobs_2014">
        <title id="public.table.events-jobs-2014-title">
         Table:
         
         <structname>events_jobs_2014</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs_2014</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_jobs_2014</title>

          <varlistentry>
            <term>events_jobs_2014_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2014)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_jobs_2014</title>

          <varlistentry>
            <term>index_events_jobs_2014_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-jobs-2015"
               xreflabel="public.events_jobs_2015">
        <title id="public.table.events-jobs-2015-title">
         Table:
         
         <structname>events_jobs_2015</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs_2015</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_jobs_2015</title>

          <varlistentry>
            <term>events_jobs_2015_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2015)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_jobs_2015</title>

          <varlistentry>
            <term>index_events_jobs_2015_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_jobs_2015_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-jobs-2016"
               xreflabel="public.events_jobs_2016">
        <title id="public.table.events-jobs-2016-title">
         Table:
         
         <structname>events_jobs_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_jobs_2016</title>

          <varlistentry>
            <term>events_jobs_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_jobs_2016</title>

          <varlistentry>
            <term>index_events_jobs_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_jobs_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-jobs-2017"
               xreflabel="public.events_jobs_2017">
        <title id="public.table.events-jobs-2017-title">
         Table:
         
         <structname>events_jobs_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_jobs_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_date_create</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_status</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT &apos;-10&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_next_run</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_jobs_2017</title>

          <varlistentry>
            <term>events_jobs_2017_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_jobs_2017</title>

          <varlistentry>
            <term>index_events_jobs_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-last-idevent"
               xreflabel="public.events_last_idevent">
        <title id="public.table.events-last-idevent-title">
         Table:
         
         <structname>events_last_idevent</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_last_idevent</structname>
            </title>


            <varlistentry>
              <term><structfield>uuidevent</structfield></term>
              <listitem><para>
                <type>uuid</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-login"
               xreflabel="public.events_login">
        <title id="public.table.events-login-title">
         Table:
         
         <structname>events_login</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_login</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>useragent</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.events-login-2017"
               xreflabel="public.events_login_2017">
        <title id="public.table.events-login-2017-title">
         Table:
         
         <structname>events_login_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_login_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

              <para>
                idcontact de quien ingresa el evento, esto es creado para funcionalidad de mesa de ayuda ya que no solo administradores podran ingresar eventos, sino tambien usuarios.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>useragent</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_login_2017</title>

          <varlistentry>
            <term>index_events_login_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-networkdevice-ping"
               xreflabel="public.events_networkdevice_ping">
        <title id="public.table.events-networkdevice-ping-title">
         Table:
         
         <structname>events_networkdevice_ping</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_networkdevice_ping</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>roundtriptime</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;-100&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_networkdevice_ping</title>

          <varlistentry>
            <term>index_events_networkdevice_ping_isopen</term>
            <listitem><para>isopen) WHERE (isopen = true</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-networkdevice-ping-2016"
               xreflabel="public.events_networkdevice_ping_2016">
        <title id="public.table.events-networkdevice-ping-2016-title">
         Table:
         
         <structname>events_networkdevice_ping_2016</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_networkdevice_ping_2016</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.accounts"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>roundtriptime</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;-100&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_networkdevice_ping_2016</title>

          <varlistentry>
            <term>events_networkdevice_ping_2016_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2016)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_networkdevice_ping_2016</title>

          <varlistentry>
            <term>index_events_networkdevice_ping_2016_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_networkdevice_ping_2016_ideventstatustype_open</term>
            <listitem><para>ideventstatustype) WHERE (ideventstatustype = 0</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.events-networkdevice-ping-2017"
               xreflabel="public.events_networkdevice_ping_2017">
        <title id="public.table.events-networkdevice-ping-2017-title">
         Table:
         
         <structname>events_networkdevice_ping_2017</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>events_networkdevice_ping_2017</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;events_idevent_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>




                      <literal>UNIQUE#1</literal>






                <literal>DEFAULT now()</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventstatustype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

              <para>
                Este campo se actualiza automaticamente segun el estado del ultimo comentario ingresado para este evento.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>















                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.admins"/>


              </para>

              <para>
                IdAdmin del usuario que crea el evento, generalmente es el sistema quien ingresa el evento, por seguridad es necesario registrar si un administrador inserta un evento manualmente.

No se lo pone como llave foranea para no tener que crearlas en cada tabla heredada mas bien se hace la comprobacion antes de insertar en la tabla y de no existir se pone a null
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

              <para>
                Fecha del ultimo comentario registrado.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventreceptionmode</structfield></term>
              <listitem><para>
                <type>bigint</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.event-reception-modes"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>isopen</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin_assigned</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>roundtriptime</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;-100&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>



        <variablelist>
          <title>Constraints on events_networkdevice_ping_2017</title>

          <varlistentry>
            <term>events_networkdevice_ping_2017_dateevent_check</term>
            <listitem><para>CHECK ((date_part(&apos;year&apos;::text, dateevent) = (2017)::double precision))</para></listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on events_networkdevice_ping_2017</title>

          <varlistentry>
            <term>events_networkdevice_ping_2017_isopen_idx</term>
            <listitem><para>isopen) WHERE (isopen = true</para></listitem>
          </varlistentry>



          <varlistentry>
            <term>index_events_networkdevice_ping_2017_idaccideventt</term>
            <listitem><para>idaccount, ideventtype</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.eventtypes"
               xreflabel="public.eventtypes">
        <title id="public.table.eventtypes-title">
         Table:
         
         <structname>eventtypes</structname>
        </title>
 

        <para>
          Tipos de eventos definidos para el sistema.
A partir del evento 1000 son definidos internamente por oams y no deben ser utilizados por el usuario.
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>eventtypes</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Nombre del evento
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 100</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>treatment</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

              <para>
                Requiere tratamiento por parte del operador
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>manual</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

              <para>
                Puede ser creado el evento manualmente, la mayoria de los eventos deberian ser creados solo por un software y no generados a mano por razones de seguridad.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>date_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

              <para>
                Las fechas de los eventos NO deberian ser editables por razones de seguridda, a exepcion de las tareas que si podrian ser modificadas. 
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_timeout</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 10</literal>



              </para>

              <para>
                Tiempo que la notificacion sera visible para el usuario
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_closable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

              <para>
                La notificacion puede ser cerrada por el usuario antes de que se cierre automaticamente una vez trascurrido el timeout.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_img</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;/notifications_media/img/dialog-error.png&apos;::text</literal>



              </para>

              <para>
                Imagen a ser  mostrada en la notificacion
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_snd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Sonido a ser escuchado cuando la notificacion es mostrada.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Etiqueta que se mostrara en la interface grafica
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Codigo de alarma
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>notify_all_users</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Muestra la notificacion de este evento a todos los usuarios  o solo al usuario que lo genera.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>expiration</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT 525600</literal>



              </para>

              <para>
                Tiempo en que el evento permanece en espera de sewr atendido antes de ser cerrado automaticamente por el sistema, en minutos.
De fabrica 525600 = 365 dias.
Se puede usar este campo para auto cerrar los eventos que no requieren tratamiento por parte del operador seteando en valor a 0.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

              <para>
                Cierra el evento automaticamente si llega un evento con idevent listado en esta matriz.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enable_auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype_group</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.eventtypes-groups"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

              <para>
                Indica si este tipo de evento esta disponible
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>eventtype_attention_group</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                Grupos de atencion, para poder identificar que grupo de administradores se le va a asignar la tarea.
Puede pertenecer a diferentes grupos de atencion.

              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on eventtypes</title>

          <varlistentry>
            <term>index_eventtypes</term>
            <listitem><para>code</para></listitem>
          </varlistentry>

        </variablelist>





        <itemizedlist>
          <title>
            Tables referencing events.datas_000112 via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="events.table.datas-000112"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-199001"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201504"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201506"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201508"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201509"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201510"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201511"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201610"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201701"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201704"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="events.table.datas-201705"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-dbsizes"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-dbsizes-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-device-uptime-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-diskspace-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-1990"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2014"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2015"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-jobs-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-login-2017"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2016"/>
            </para>
          </listitem>



          <listitem>
            <para>
              <xref linkend="public.table.events-networkdevice-ping-2017"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.eventtypes-groups"
               xreflabel="public.eventtypes_groups">
        <title id="public.table.eventtypes-groups-title">
         Table:
         
         <structname>eventtypes_groups</structname>
        </title>
 

        <para>
          No esta siendo usada esta tabla
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>eventtypes_groups</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventtype_group</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>group</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>is_status</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.eventtypes via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.eventtypes"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.farma-lista-precios-farmacias"
               xreflabel="public.farma_lista_precios_farmacias">
        <title id="public.table.farma-lista-precios-farmacias-title">
         Table:
         
         <structname>farma_lista_precios_farmacias</structname>
        </title>
 

        <para>
          Tabla con la lista de precios de actuales de las farmacias
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>farma_lista_precios_farmacias</structname>
            </title>


            <varlistentry>
              <term><structfield>idlista_precios</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>principal</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>activa</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>productos</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts_lista_farmacia</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_activa</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_productos</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_principal</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts_lista_srv159</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>sincronizado</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>provincia</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on farma_lista_precios_farmacias</title>

          <varlistentry>
            <term>index_farma_lista_precios_idaccount</term>
            <listitem><para>idaccount</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.file-links"
               xreflabel="public.file_links">
        <title id="public.table.file-links-title">
         Table:
         
         <structname>file_links</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>file_links</structname>
            </title>


            <varlistentry>
              <term><structfield>idfilelinks</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateloadfile</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>path_file</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name_file</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>size_file</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.groups"
               xreflabel="public.groups">
        <title id="public.table.groups-title">
         Table:
         
         <structname>groups</structname>
        </title>
 

        <para>
          Grupos
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>groups</structname>
            </title>


            <varlistentry>
              <term><structfield>idgroup</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>








                      <literal>UNIQUE#1</literal>









                <literal>REFERENCES</literal> <xref linkend="public.table.divisions"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.identification-types"
               xreflabel="public.identification_types">
        <title id="public.table.identification-types-title">
         Table:
         
         <structname>identification_types</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>identification_types</structname>
            </title>


            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing contacts.contacts via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="contacts.table.contacts"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.network-devices"
               xreflabel="public.network_devices">
        <title id="public.table.network-devices-title">
         Table:
         
         <structname>network_devices</structname>
        </title>
 

        <para>
          Equipos que funcionan en red o estan conectados a una red y disponen de direccion IP.
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>network_devices</structname>
            </title>


            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;equipments_idequipment_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>





                      <literal>UNIQUE#2</literal>




                <literal>NOT NULL</literal>









              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mark</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>model</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>serial_number</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>





                      <literal>UNIQUE#2</literal>




                <literal>NOT NULL</literal>









              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>installation_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uninstall_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code_ref</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#2</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>operability</structfield></term>
              <listitem><para>
                <type>smallint</type>





                <literal>DEFAULT 100</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>agreement_code_provider</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>eventtypes</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcustodian</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>







              </para>

              <para>
                Direccion IP
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mac</structfield></term>
              <listitem><para>
                <type>macaddr</type>




                      <literal>UNIQUE</literal>










              </para>

              <para>
                MAC
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>network_access_method</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>connection_speed</structfield></term>
              <listitem><para>
                <type>real</type>





                <literal>DEFAULT &apos;-100&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>username</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>port</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>monitored</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>additional_properties</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on network_devices</title>

          <varlistentry>
            <term>index_network_devices_eq</term>
            <listitem><para>equipment</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.notification-area"
               xreflabel="public.notification_area">
        <title id="public.table.notification-area-title">
         Table:
         
         <structname>notification_area</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>notification_area</structname>
            </title>


            <varlistentry>
              <term><structfield>idnotify</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>urgency</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 10</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>timeout</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 15</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>closable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>img</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>snd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>title</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>body</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>sessionid</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;all&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmins</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

              <para>
                si esta vacio muestra las notificaciones a todos los usuarios, si contiene datos muestra unicamente a los administradores indicados.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>detail_json</structfield></term>
              <listitem><para>
                <type>json</type>







              </para>

              <para>
                Detalle de la notificacion en formato jSON
              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.phone-providers"
               xreflabel="public.phone_providers">
        <title id="public.table.phone-providers-title">
         Table:
         
         <structname>phone_providers</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>phone_providers</structname>
            </title>


            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>provider</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.phones via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.phones"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.phone-types"
               xreflabel="public.phone_types">
        <title id="public.table.phone-types-title">
         Table:
         
         <structname>phone_types</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>phone_types</structname>
            </title>


            <varlistentry>
              <term><structfield>idphonetype</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>type</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.phones via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.phones"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.table.phones"
               xreflabel="public.phones">
        <title id="public.table.phones-title">
         Table:
         
         <structname>phones</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>phones</structname>
            </title>


            <varlistentry>
              <term><structfield>idphone</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

              <para>
                Validar si existe este contacto hay que hacerlo manualmente ya que hay una tabla heredada accounts.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.phone-providers"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idphonetype</structfield></term>
              <listitem><para>
                <type>integer</type>












                <literal>REFERENCES</literal> <xref linkend="public.table.phone-types"/>


              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>number</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ext</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>



                <literal>DEFAULT &apos;&apos;::text</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 10</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.providers"
               xreflabel="public.providers">
        <title id="public.table.providers-title">
         Table:
         
         <structname>providers</structname>
        </title>
 

        <para>
          Lista de proveedores de productos y servicios
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>providers</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>









                <literal>DEFAULT nextval(&apos;contacts_idcontact_seq&apos;::regclass)</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>first_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>




                      <literal>UNIQUE#1</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>gender</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>is_admin</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_start</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_end</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_username</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE</literal>










              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_sessionid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_ip</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_level</structfield></term>
              <listitem><para>
                <type>integer</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>product_or_service</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.table-modification-log"
               xreflabel="public.table_modification_log">
        <title id="public.table.table-modification-log-title">
         Table:
         
         <structname>table_modification_log</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>table_modification_log</structname>
            </title>


            <varlistentry>
              <term><structfield>idtablemodif</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_modif</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>schema_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>





        <variablelist>
          <title>Indexes on table_modification_log</title>

          <varlistentry>
            <term>index_tml_tname_sname</term>
            <listitem><para>table_name, schema_name</para></listitem>
          </varlistentry>

        </variablelist>








      </para>
    </section>

      <section id="public.table.udc-columns"
               xreflabel="public.udc_columns">
        <title id="public.table.udc-columns-title">
         Table:
         
         <structname>udc_columns</structname>
        </title>
 

        <para>
          Detalle de columnas de cada tabla o vista
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>udc_columns</structname>
            </title>


            <varlistentry>
              <term><structfield>idtableview</structfield></term>
              <listitem><para>
                <type>bigint</type>








                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>






                <literal>REFERENCES</literal> <xref linkend="public.table.udc-tables-views"/>




              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_name</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>data_type</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_default</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_label</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_width</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_decorator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_class</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_rendercell</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_formatter</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_classname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_position</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 999</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_sortable</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editon</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_resizable</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_iconclass</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;glyphicon-pencil&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>field_placeholder</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autosave</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_autoselect</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_dismissonenter</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcolumn</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editor_args</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.udc-tables-columns"
               xreflabel="public.udc_tables_columns">
        <title id="public.table.udc-tables-columns-title">
         Table:
         
         <structname>udc_tables_columns</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>udc_tables_columns</structname>
            </title>


            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>text</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_name</structfield></term>
              <listitem><para>
                <type>text</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>data_type</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_default</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_label</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_width</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_decorator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_class</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_rendercell</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                renderCell(object, value, node)	

An optional function that will be called to render the value into the target cell. object refers to the record from the grid&apos;s collection for the row, and value refers to the specific value for the current cell (which may have been modified by the column definition&apos;s get function). node refers to the table cell that will be placed in the grid; if renderCell returns a node, that returned node will be placed inside the table cell. (Note: if a custom renderCell is specified, formatter will be ignored unless the custom renderCell accounts for it.)
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_formatter</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                formatter(value, object)	

An optional function that will return a string of HTML for rendering. The function is passed the value that would normally be rendered, and the object from the collection. If formatterScope is used, this can be a string instead of a function, in which case a function will be looked up on the formatterScope object using the given string. (Note: if a custom renderCell is specified, formatter will be ignored unless the custom renderCell accounts for it.)
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_classname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                className	

CSS class(es) to assign to the cells in the column. The value of this property may be a string to apply equally to all cells in the column, or a function which is passed the item for each row (or undefined for the header row) and should return a string. In either case, multiple classes may be specified space-delimited. In addition, a class in the format field-&lt;field&gt; is added if the column has a field defined.
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_position</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT 999</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>

      <section id="public.table.udc-tables-views"
               xreflabel="public.udc_tables_views">
        <title id="public.table.udc-tables-views-title">
         Table:
         
         <structname>udc_tables_views</structname>
        </title>
 

        <para>
          Lista de tablas y propiedades para Grid
        </para>


        <para>
          <variablelist>
            <title>
              Structure of <structname>udc_tables_views</structname>
            </title>


            <varlistentry>
              <term><structfield>title_dgrid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>row_selector_dgrid</structfield></term>
              <listitem><para>
                <type>boolean</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idtableview</structfield></term>
              <listitem><para>
                <type>bigint</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tv_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

              <para>
                Este Campo no es editable, se actualia automaticamente
              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>add_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>delete_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>export_button_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT false</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_selectionmode</structfield></term>
              <listitem><para>
                <type>text</type>





                <literal>DEFAULT &apos;none&apos;::text</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowtextselection</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_deselectonrefresh</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_allowselectall</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>







        <itemizedlist>
          <title>
            Tables referencing public.udc_columns via Foreign Key Constraints
          </title>

          <listitem>
            <para>
              <xref linkend="public.table.udc-columns"/>
            </para>
          </listitem>

        </itemizedlist>






      </para>
    </section>

      <section id="public.view.view-account-contacts"
               xreflabel="public.view_account_contacts">
        <title id="public.view.view-account-contacts-title">
         View:
         
         <structname>view_account_contacts</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_account_contacts</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geolink</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>first_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>contact_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_account_contacts</title>
         <programlisting>
SELECT account_contacts.idaccountuser
,
    account_contacts.ts
,
    account_contacts.idaccount
,
    accounts.enabled
,
    accounts.account
,
    accounts.account_name
,
    accounts.geox
,
    accounts.geoy
,
    
(
     (
           (
                 (
                       (
                             (
                                   (&apos;http://www.openstreetmap.org/?mlat=&apos;::text || accounts.geox) || &apos;&amp;mlon=&apos;::text
                             ) || accounts.geoy
                       ) || &apos;#map=19/&apos;::text
                 ) || accounts.geox
           ) || &apos;/&apos;::text
     ) || accounts.geoy
) AS geolink
,
    accounts.address
,
    accounts.address_ref
,
    account_contacts.idcontact
,
    contacts.first_name
,
    contacts.last_name
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS contact_name
,
    contacts.birthday
,
    contacts.identification
,
    account_contacts.appointment
,
    account_contacts.priority
,
    account_contacts.note
   
FROM contacts.contacts
,
    account_contacts
,
    accounts
  
WHERE (
     (account_contacts.idcontact = contacts.idcontact)
   AND (accounts.idaccount = account_contacts.idaccount)
)
  
ORDER BY account_contacts.priority;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-account-network-devices"
               xreflabel="public.view_account_network_devices">
        <title id="public.view.view-account-network-devices-title">
         View:
         
         <structname>view_account_network_devices</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_account_network_devices</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mark</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>model</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>serial_number</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mac</structfield></term>
              <listitem><para>
                <type>macaddr</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>username</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>port</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>monitored</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_account_network_devices</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.enabled
,
    accounts.account_name
,
    accounts.account
,
    accounts.idaccountstate
,
    accounts.idaccounttype
,
    accounts.iddivision
,
    accounts.geox
,
    accounts.geoy
,
    accounts.identification
,
    network_devices.idequipment
,
    network_devices.equipment
,
    network_devices.mark
,
    network_devices.model
,
    network_devices.serial_number
,
    network_devices.description
,
    network_devices.ip
,
    network_devices.code_ref
,
    network_devices.mac
,
    network_devices.username
,
    network_devices.pwd
,
    network_devices.port
,
    network_devices.monitored
,
    network_devices.report_validator
   
FROM accounts
,
    network_devices
  
WHERE (accounts.idaccount = network_devices.idaccount);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-account-users"
               xreflabel="public.view_account_users">
        <title id="public.view.view-account-users-title">
         View:
         
         <structname>view_account_users</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_account_users</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>user_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_user</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_account_users</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.account
,
    accounts.enabled
,
    accounts.account_name
,
    accounts.identification AS account_identification
,
    account_users.idaccountuser
,
    account_users.idcontact
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS user_name
,
    contacts.identification
,
    account_users.appointment
,
    account_users.priority
,
    account_users.account_user
,
    account_users.account_pwd
   
FROM accounts
,
    account_users
,
    contacts.contacts
  
WHERE (
     (accounts.idaccount = account_users.idaccount)
   AND (account_users.idcontact = contacts.idcontact)
)
  
ORDER BY account_users.priority;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-accounts"
               xreflabel="public.view_accounts">
        <title id="public.view.view-accounts-title">
         View:
         
         <structname>view_accounts</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_accounts</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification_type</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_division</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_type</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>start_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>end_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_accounts</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.ts
,
    accounts.enabled
,
    accounts.account_name
,
    accounts.identification
,
    accounts.ididtype
,
    identification_types.name AS identification_type
,
    accounts.iddivision
,
    divisions.name AS account_division
,
    accounts.postal_code
,
    accounts.geox
,
    accounts.geoy
,
    accounts.address
,
    accounts.address_ref
,
    accounts.idaccountstate
,
    accounts.idaccounttype
,
    account_types.type AS account_type
,
    accounts.start_date
,
    accounts.end_date
,
    accounts.account
,
    accounts.note
   
FROM (
     (
           (accounts
     
              JOIN divisions 
                ON (
                       (accounts.iddivision = divisions.iddivision)
                 )
           )
     
        JOIN account_types 
          ON (
                 (accounts.idaccounttype = account_types.idaccounttype)
           )
     )
     
  JOIN identification_types 
    ON (
           (accounts.ididtype = identification_types.ididtype)
     )
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-accounts-contacts-admins"
               xreflabel="public.view_accounts_contacts_admins">
        <title id="public.view.view-accounts-contacts-admins-title">
         View:
         
         <structname>view_accounts_contacts_admins</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_accounts_contacts_admins</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>contact_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_accounts_contacts_admins</title>
         <programlisting>
SELECT 0 AS idaccountuser
,
    accounts__.idcontact AS idaccount
,
    view_admins.idcontact
,
    view_admins.contact_name
,
    view_admins.appointment
,
    0 AS priority
   
FROM accounts__
,
    view_admins
  
WHERE (
     (view_admins.idadmin = ANY 
           (accounts__.admins)
     )
   AND (view_admins.enabled = true)
)
UNION
 
SELECT account_contacts.idaccountuser
,
    account_contacts.idaccount
,
    account_contacts.idcontact
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS contact_name
,
    account_contacts.appointment
,
    account_contacts.priority
   
FROM contacts.contacts
,
    account_contacts
,
    accounts__
  
WHERE (
     (account_contacts.idcontact = contacts.idcontact)
   AND (accounts__.idcontact = account_contacts.idaccount)
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-accounts-oams-assigned"
               xreflabel="public.view_accounts_oams_assigned">
        <title id="public.view.view-accounts-oams-assigned-title">
         View:
         
         <structname>view_accounts_oams_assigned</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_accounts_oams_assigned</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccountuser</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geolink</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>first_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>contact_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_accounts_oams_assigned</title>
         <programlisting>
SELECT view_account_contacts.idaccountuser
,
    view_account_contacts.ts
,
    view_account_contacts.idaccount
,
    view_account_contacts.account
,
    view_account_contacts.enabled
,
    view_account_contacts.account_name
,
    view_account_contacts.geox
,
    view_account_contacts.geoy
,
    view_account_contacts.geolink
,
    view_account_contacts.address
,
    view_account_contacts.address_ref
,
    view_account_contacts.idcontact
,
    view_account_contacts.first_name
,
    view_account_contacts.last_name
,
    view_account_contacts.contact_name
,
    view_account_contacts.birthday
,
    view_account_contacts.identification
,
    view_account_contacts.appointment
,
    view_account_contacts.priority
,
    view_account_contacts.note
   
FROM view_account_contacts
  
WHERE (view_account_contacts.appointment = &apos;Tcnico Responsable&apos;::text);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-accounts-users-pwd"
               xreflabel="public.view_accounts_users_pwd">
        <title id="public.view.view-accounts-users-pwd-title">
         View:
         
         <structname>view_accounts_users_pwd</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_accounts_users_pwd</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_account</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled_user</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_user</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_accounts_users_pwd</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.enabled AS enabled_account
,
    account_users.enabled AS enabled_user
,
    accounts.account_name
,
    accounts.identification
,
    accounts.account
,
    account_users.idcontact
,
    account_users.account_user
,
    account_users.account_pwd
,
    account_users.appointment
   
FROM accounts
,
    account_users
  
WHERE (accounts.idaccount = account_users.idaccount);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-admins"
               xreflabel="public.view_admins">
        <title id="public.view.view-admins-title">
         View:
         
         <structname>view_admins</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_admins</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>contact_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>appointment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>gender</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idadmin</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_username</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_pwd</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_sessionid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_ip</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_level</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_role</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_locked_date</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_failed_access_attempts</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_access</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_heartbeat</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>logged</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_admins</title>
         <programlisting>
SELECT contacts.idcontact
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS contact_name
,
    admins.appointment
,
    contacts.birthday
,
    contacts.identification
,
    contacts.ididtype
,
    contacts.gender
,
    contacts.address
,
    contacts.groups
,
    admins.idadmin
,
    admins.enabled
,
    admins.admin_start
,
    admins.admin_end
,
    admins.admin_username
,
    admins.admin_pwd
,
    admins.admin_sessionid
,
    admins.admin_ip
,
    admins.admin_level
,
    admins.admin_role
,
    admins.admin_locked_date
,
    admins.admin_failed_access_attempts
,
    admins.last_access
,
    admins.last_heartbeat
,
        CASE
            WHEN 
(admins.admin_sessionid IS NULL) THEN false
            WHEN 
(length
     (admins.admin_sessionid) &lt; 32
) THEN false
            ELSE true
        END AS logged
   
FROM admins
,
    contacts.contacts
  
WHERE (contacts.idcontact = admins.idcontact);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-contact-groups-they-belong"
               xreflabel="public.view_contact_groups_they_belong">
        <title id="public.view.view-contact-groups-they-belong-title">
         View:
         
         <structname>view_contact_groups_they_belong</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_contact_groups_they_belong</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idgroup</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ismember</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_contact_groups_they_belong</title>
         <programlisting>
SELECT fun_view_contact_groups_they_belong.idcontact
,
    fun_view_contact_groups_they_belong.idgroup
,
    fun_view_contact_groups_they_belong.ts
,
    fun_view_contact_groups_they_belong.ismember
,
    fun_view_contact_groups_they_belong.enabled
,
    fun_view_contact_groups_they_belong.name
,
    fun_view_contact_groups_they_belong.description
,
    fun_view_contact_groups_they_belong.note
   
FROM fun_view_contact_groups_they_belong
(
     (0)::bigint
) fun_view_contact_groups_they_belong
(idcontact
     , idgroup
     , ts
     , ismember
     , enabled
     , name
     , description
     , note
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-contacts"
               xreflabel="public.view_contacts">
        <title id="public.view.view-contacts-title">
         View:
         
         <structname>view_contacts</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_contacts</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>contact_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>birthday</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>postal_code</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>gender</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geox</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>geoy</structfield></term>
              <listitem><para>
                <type>double precision</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>groups</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_contacts</title>
         <programlisting>
SELECT contacts.idcontact
,
    contacts.ts
,
    contacts.enabled
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS contact_name
,
    contacts.birthday
,
    contacts.identification
,
    contacts.ididtype
,
    contacts.postal_code
,
    contacts.gender
,
    contacts.geox
,
    contacts.geoy
,
    contacts.address
,
    contacts.address_ref
,
    contacts.groups
,
    contacts.note
   
FROM contacts.contacts;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-equipments"
               xreflabel="public.view_equipments">
        <title id="public.view.view-equipments-title">
         View:
         
         <structname>view_equipments</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_equipments</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>accounttype</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>code_ref</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mark</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>model</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>serial_number</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>installation_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>uninstall_date</structfield></term>
              <listitem><para>
                <type>timestamp without time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>operability</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>oams_assigned</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>agreement_code_provider</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_equipments</title>
         <programlisting>
SELECT accounts.idaccount
,
    accounts.enabled
,
    accounts.account
,
    accounts.account_name
,
    accounts.idaccounttype
,
    
(
SELECT account_types.type
           
  FROM account_types
          
 WHERE (account_types.idaccounttype = accounts.idaccounttype)
) AS accounttype
,
    accounts.identification
,
    equipments.code_ref
,
    equipments.equipment
,
    equipments.mark
,
    equipments.model
,
    equipments.serial_number
,
    equipments.description
,
    equipments.installation_date
,
    equipments.uninstall_date
,
    equipments.operability
,
    equipments.note
,
    
(
SELECT string_agg
     (
           (
            SELECT (
                       (contacts.last_name || &apos; &apos;::text) || contacts.first_name
                 ) AS n
                   
              FROM contacts.contacts
                  
             WHERE (contacts.idcontact = account_contacts.idcontact)
           )
           ,&apos;, &apos;::text
     ) AS string_agg
           
  FROM account_contacts
          
 WHERE (
           (account_contacts.idaccount = accounts.idaccount)
         AND (account_contacts.appointment = &apos;Tcnico Responsable&apos;::text)
     )
) AS oams_assigned
,
    accounts.idaccountstate
,
    equipments.idequipment
,
    equipments.idprovider
,
    equipments.agreement_code_provider
   
FROM accounts
,
    equipments
  
WHERE (accounts.idaccount = equipments.idaccount);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-event-login-report"
               xreflabel="public.view_event_login_report">
        <title id="public.view.view-event-login-report-title">
         View:
         
         <structname>view_event_login_report</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_event_login_report</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>name_event</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact_user</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>fullname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>useragent</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_event_login_report</title>
         <programlisting>
SELECT events_login.idevent
,
    events_login.dateevent
,
    events_login.ideventtype
,
    eventtypes.label AS label_event
,
    eventtypes.name AS name_event
,
    events_login.description
,
    events_login.idcontact_user
,
    
(
     (contacts.last_name || &apos; &apos;::text) || contacts.first_name
) AS fullname
,
    events_login.ip
,
    events_login.useragent
   
FROM events_login
,
    contacts.contacts
,
    eventtypes
  
WHERE (
     (events_login.ideventtype = eventtypes.ideventtype)
   AND (events_login.idcontact_user = contacts.idcontact)
)
  
ORDER BY events_login.dateevent DESC
 LIMIT 500;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-jobs"
               xreflabel="public.view_events_jobs">
        <title id="public.view.view-events-jobs-title">
         View:
         
         <structname>view_events_jobs</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_jobs</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>job_run_duration</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_comment</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>oams_assigned</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_jobs</title>
         <programlisting>
SELECT events_jobs.idevent
,
    events_jobs.dateevent
,
    events_jobs.ideventstatustype AS status
,
    fun_event_status_get_label
(events_jobs.ideventstatustype) AS status_label
,
    events_jobs.idaccount
,
    events_jobs.zu
,
    events_jobs.priority
,
    events_jobs.ideventtype
,
    events_jobs.idequipment
,
    events_jobs.description
,
    events_jobs.job_name
,
    events_jobs.job_run_duration
,
    events_jobs.last_comment
,
    
(
     (accounts__.last_name || &apos; &apos;::text) || accounts__.first_name
) AS account_name
,
    accounts__.account
,
    eventtypes.label
,
    
(
SELECT string_agg
     (
           (
            SELECT (
                       (contacts.last_name || &apos; &apos;::text) || contacts.first_name
                 ) AS n
                   
              FROM contacts.contacts
                  
             WHERE (contacts.idcontact = account_contacts.idcontact)
           )
           ,&apos;, &apos;::text
     ) AS string_agg
           
  FROM account_contacts
          
 WHERE (
           (account_contacts.idaccount = events_jobs.idaccount)
         AND (account_contacts.appointment = &apos;Tcnico Responsable&apos;::text)
     )
) AS oams_assigned
   
FROM events_jobs
,
    accounts__
,
    eventtypes
  
WHERE (
     (events_jobs.idaccount = accounts__.idcontact)
   AND (events_jobs.ideventtype = eventtypes.ideventtype)
)
  
ORDER BY events_jobs.dateevent DESC
, events_jobs.idevent DESC;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-last-by-ideventtype"
               xreflabel="public.view_events_last_by_ideventtype">
        <title id="public.view.view-events-last-by-ideventtype-title">
         View:
         
         <structname>view_events_last_by_ideventtype</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_last_by_ideventtype</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_last_by_ideventtype</title>
         <programlisting>
SELECT y.idevent
,
    y.ideventtype
,
    y.zu
,
    y.idaccount
,
    y.idequipment
,
    y.dateevent
   
FROM (
SELECT events.idevent
     ,
            events.ideventtype
     ,
            events.zu
     ,
            events.idaccount
     ,
            events.idequipment
     ,
            events.dateevent
     ,
            max
     (events.dateevent) OVER 
     (PARTITI
          ON BY events.ideventtype
           , events.zu
           , events.idaccount
     ) AS de
           
  FROM events
) y
  
WHERE (y.dateevent = y.de)
  
ORDER BY y.ideventtype
, y.zu
, y.idaccount;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-monitor"
               xreflabel="public.view_events_monitor">
        <title id="public.view.view-events-monitor-title">
         View:
         
         <structname>view_events_monitor</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_monitor</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>oams_assigned</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_monitor</title>
         <programlisting>
SELECT events.idevent
,
    events.dateevent
,
    events.ideventstatustype AS status
,
    fun_event_status_get_label
(events.ideventstatustype) AS status_label
,
    events.idaccount
,
    events.zu
,
    events.priority
,
    events.ideventtype
,
    events.idequipment
,
    events.description
,
    
(
     (accounts__.last_name || &apos; &apos;::text) || accounts__.first_name
) AS account_name
,
    accounts__.account
,
    eventtypes.label
,
    
(
SELECT string_agg
     (view_admins.contact_name
           ,&apos; | &apos;::text
     ) AS c
           
  FROM view_admins
          
 WHERE (view_admins.idadmin = ANY 
           (accounts__.admins)
     )
) AS oams_assigned
   
FROM events
,
    accounts__
,
    eventtypes
  
WHERE (
     (events.ideventstatustype = 0)
   AND (events.idaccount = accounts__.idcontact)
   AND (events.ideventtype = eventtypes.ideventtype)
)
  
ORDER BY events.dateevent DESC
, events.idevent DESC;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-monitor-general"
               xreflabel="public.view_events_monitor_general">
        <title id="public.view.view-events-monitor-general-title">
         View:
         
         <structname>view_events_monitor_general</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_monitor_general</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_assigned</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_monitor_general</title>
         <programlisting>
SELECT events.idevent
,
    events.dateevent
,
    events.ideventstatustype AS status
,
    fun_event_status_get_label
(events.ideventstatustype) AS status_label
,
    events.idaccount
,
    events.zu
,
    events.priority
,
    events.ideventtype
,
    events.idequipment
,
    events.description
,
    
(
     (accounts__.last_name || &apos; &apos;::text) || accounts__.first_name
) AS account_name
,
    accounts__.account
,
    eventtypes.label
,
    
(
SELECT string_agg
     (view_admins.contact_name
           ,&apos; | &apos;::text
     ) AS c
           
  FROM view_admins
          
 WHERE (view_admins.idadmin = ANY 
           (accounts__.admins)
     )
) AS admin_assigned
   
FROM events
,
    accounts__
,
    eventtypes
  
WHERE (
     (events.ideventstatustype = 0)
   AND (events.idaccount = accounts__.idcontact)
   AND (events.ideventtype = eventtypes.ideventtype)
)
  
ORDER BY events.dateevent DESC
, events.idevent DESC;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-monitor-network-devices"
               xreflabel="public.view_events_monitor_network_devices">
        <title id="public.view.view-events-monitor-network-devices-title">
         View:
         
         <structname>view_events_monitor_network_devices</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_monitor_network_devices</structname>
            </title>


            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>identification</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ididtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccountstate</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccounttype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idequipment</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>monitored</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment_enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>mark</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>model</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>equipment_description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idprovider</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>agreement_code_provider</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>inet</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>report_validator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>loaded</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>priority</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admins</structfield></term>
              <listitem><para>
                <type>bigint[]</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>admin_assigned</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_monitor_network_devices</title>
         <programlisting>
SELECT accounts__.idcontact
,
    accounts__.enabled
,
    
(
     (accounts__.last_name || &apos; &apos;::text) || accounts__.first_name
) AS account_name
,
    accounts__.identification
,
    accounts__.account
,
    accounts__.ididtype
,
    accounts__.idaccountstate
,
    accounts__.idaccounttype
,
    accounts__.iddivision
,
    events.idequipment
,
    network_devices.monitored
,
    network_devices.enabled AS equipment_enabled
,
    network_devices.equipment
,
    network_devices.mark
,
    network_devices.model
,
    network_devices.description AS equipment_description
,
    network_devices.idprovider
,
    network_devices.agreement_code_provider
,
    network_devices.ip
,
    network_devices.report_validator
,
    events.loaded
,
    events.dateevent
,
    events.ideventstatustype AS status
,
    fun_event_status_get_label
(events.ideventstatustype) AS status_label
,
    events.priority
,
    events.ideventtype
,
    eventtypes.label
,
    events.description
,
    events.zu
,
    accounts__.admins
,
    
(
SELECT string_agg
     (view_admins.contact_name
           ,&apos; | &apos;::text
     ) AS c
           
  FROM view_admins
          
 WHERE (view_admins.idadmin = ANY 
           (accounts__.admins)
     )
) AS admin_assigned
   
FROM network_devices
,
    events
,
    accounts__
,
    eventtypes
  
WHERE (
     (network_devices.idequipment = events.idequipment)
   AND (accounts__.idcontact = network_devices.idaccount)
   AND (events.ideventtype = eventtypes.ideventtype)
   AND (events.ideventstatustype = 0)
)
  
ORDER BY events.dateevent DESC
, events.idevent DESC;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-events-with-eventtypes-detail"
               xreflabel="public.view_events_with_eventtypes_detail">
        <title id="public.view.view-events-with-eventtypes-detail-title">
         View:
         
         <structname>view_events_with_eventtypes_detail</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_events_with_eventtypes_detail</structname>
            </title>


            <varlistentry>
              <term><structfield>idevent</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateevent</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>zu</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enable_auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>auto_close_on_event_defined</structfield></term>
              <listitem><para>
                <type>integer[]</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_events_with_eventtypes_detail</title>
         <programlisting>
SELECT events.idevent
,
    events.dateevent
,
    events.ideventstatustype AS status
,
    events.zu
,
    events.idaccount
,
    events.ideventtype
,
    eventtypes.enable_auto_close_on_event_defined
,
    eventtypes.auto_close_on_event_defined
   
FROM events
,
    eventtypes
  
WHERE (
     (eventtypes.ideventtype = events.ideventtype)
   AND (events.ideventstatustype = 0)
   AND (eventtypes.enable_auto_close_on_event_defined = true)
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-eventtypes-to-client"
               xreflabel="public.view_eventtypes_to_client">
        <title id="public.view.view-eventtypes-to-client-title">
         View:
         
         <structname>view_eventtypes_to_client</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_eventtypes_to_client</structname>
            </title>


            <varlistentry>
              <term><structfield>ideventtype</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_eventtypes_to_client</title>
         <programlisting>
SELECT eventtypes.ideventtype
,
    eventtypes.label
   
FROM eventtypes
  
WHERE (eventtypes.manual = true);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-farma-lista-precios"
               xreflabel="public.view_farma_lista_precios">
        <title id="public.view.view-farma-lista-precios-title">
         View:
         
         <structname>view_farma_lista_precios</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_farma_lista_precios</structname>
            </title>


            <varlistentry>
              <term><structfield>idaccount</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>iddivision</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts_farmacia</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts_server159</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>address</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tecnico</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_principal</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_activa</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>srv159_productos</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>principal</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>activa</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>productos</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>estado</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>sincronizado</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>provincia</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ip</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_farma_lista_precios</title>
         <programlisting>
SELECT fun_view_farma_lista_precios.idaccount
,
    fun_view_farma_lista_precios.iddivision
,
    fun_view_farma_lista_precios.account
,
    fun_view_farma_lista_precios.ts_farmacia
,
    fun_view_farma_lista_precios.ts_server159
,
    fun_view_farma_lista_precios.account_name
,
    fun_view_farma_lista_precios.address
,
    fun_view_farma_lista_precios.tecnico
,
    fun_view_farma_lista_precios.note
,
    fun_view_farma_lista_precios.srv159_principal
,
    fun_view_farma_lista_precios.srv159_activa
,
    fun_view_farma_lista_precios.srv159_productos
,
    fun_view_farma_lista_precios.principal
,
    fun_view_farma_lista_precios.activa
,
    fun_view_farma_lista_precios.productos
,
    fun_view_farma_lista_precios.estado
,
    fun_view_farma_lista_precios.sincronizado
,
    fun_view_farma_lista_precios.provincia
,
    fun_view_farma_lista_precios.ip
   
FROM fun_view_farma_lista_precios
() fun_view_farma_lista_precios
(idaccount
     , iddivision
     , account
     , ts_farmacia
     , ts_server159
     , account_name
     , address
     , tecnico
     , note
     , srv159_principal
     , srv159_activa
     , srv159_productos
     , principal
     , activa
     , productos
     , estado
     , sincronizado
     , provincia
     , ip
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-last-modif-tables"
               xreflabel="public.view_last_modif_tables">
        <title id="public.view.view-last-modif-tables-title">
         View:
         
         <structname>view_last_modif_tables</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_last_modif_tables</structname>
            </title>


            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>schema_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idtablemodif</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>datetime_modif</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_last_modif_tables</title>
         <programlisting>
SELECT DISTINCT 
ON (table_modification_log.schema_name
     , table_modification_log.table_name
) table_modification_log.table_name
,
    table_modification_log.schema_name
,
    table_modification_log.idtablemodif
,
    table_modification_log.datetime_modif
,
    
(
     (table_modification_log.schema_name || &apos;.&apos;::text) || table_modification_log.table_name
) AS tschema_tname
   
FROM table_modification_log
  
ORDER BY table_modification_log.schema_name
, table_modification_log.table_name
, table_modification_log.idtablemodif DESC;</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-table-schema"
               xreflabel="public.view_table_schema">
        <title id="public.view.view-table-schema-title">
         View:
         
         <structname>view_table_schema</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_table_schema</structname>
            </title>


            <varlistentry>
              <term><structfield>hash_num</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>tschema_tname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_schema</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>table_name</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_name</structfield></term>
              <listitem><para>
                <type>information_schema.sql_identifier</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>data_type</structfield></term>
              <listitem><para>
                <type>information_schema.character_data</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_default</structfield></term>
              <listitem><para>
                <type>information_schema.character_data</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_table_schema</title>
         <programlisting>
SELECT md5
(
     (
           (
                 (columns.table_schema)::text || 
                 (columns.table_name)::text
           ) || 
           (columns.column_name)::text
     )
) AS hash_num
,
    
(
     (
           (columns.table_schema)::text || &apos;.&apos;::text
     ) || 
     (columns.table_name)::text
) AS tschema_tname
,
    columns.table_schema
,
    columns.table_name
,
    columns.column_name
,
    columns.data_type
,
    columns.column_default
   
FROM information_schema.columns
  
WHERE (
     (columns.table_schema)::text = ANY 
     (ARRAY[
           (&apos;public&apos;::character varying)::text
           , (&apos;events&apos;::character varying)::text
           , (&apos;scheduled_tasks&apos;::character varying)::text
           , (&apos;gui&apos;::character varying)::text]
     )
);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.view.view-udc-tables-views"
               xreflabel="public.view_udc_tables_views">
        <title id="public.view.view-udc-tables-views-title">
         View:
         
         <structname>view_udc_tables_views</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>view_udc_tables_views</structname>
            </title>


            <varlistentry>
              <term><structfield>idtableview</structfield></term>
              <listitem><para>
                <type>bigint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>label_dgrid</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>row_selector_dgrid</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_name</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>data_type</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_default</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_label</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_width</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_decorator</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_class</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_rendercell</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_formatter</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_classname</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>show</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>column_position</structfield></term>
              <listitem><para>
                <type>integer</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dgrid_editable</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>








        <figure>
         <title>Definition of view view_udc_tables_views</title>
         <programlisting>
SELECT udc_tables_views.idtableview
,
    udc_tables_views.title_dgrid AS label_dgrid
,
    udc_tables_views.row_selector_dgrid
,
    udc_columns.column_name
,
    udc_columns.data_type
,
    udc_columns.column_default
,
    udc_columns.column_label
,
    udc_columns.column_width
,
    udc_columns.ts
,
    udc_columns.column_decorator
,
    udc_columns.column_class
,
    udc_columns.dgrid_rendercell
,
    udc_columns.dgrid_formatter
,
    udc_columns.dgrid_classname
,
    udc_columns.show
,
    udc_columns.column_position
,
    udc_columns.dgrid_editable
   
FROM udc_columns
,
    udc_tables_views
  
WHERE (udc_tables_views.idtableview = udc_columns.idtableview);</programlisting>
        </figure>



      </para>
    </section>

      <section id="public.table.xmpps"
               xreflabel="public.xmpps">
        <title id="public.table.xmpps-title">
         Table:
         
         <structname>xmpps</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>xmpps</structname>
            </title>


            <varlistentry>
              <term><structfield>idxmpp</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>idcontact</structfield></term>
              <listitem><para>
                <type>bigint</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>account</structfield></term>
              <listitem><para>
                <type>text</type>




                      <literal>UNIQUE#1</literal>




                <literal>NOT NULL</literal>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>





                <literal>DEFAULT true</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>footprint_row</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>note</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>



<!-- Function accounts_insert_update() -->
    <section id="public.function.accounts-insert-update"
             xreflabel="publicaccounts_insert_update()">
      <title id="public.function.accounts-insert-update-title">
       accounts_insert_update()
      </title>
      <titleabbrev id="public.function.accounts-insert-update-titleabbrev">
       accounts_insert_update()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Realiza validacion de datos antes de insertar en la tabla.
        <programlisting>BEGIN

-- Si la fecha de fin es NULL se la setea a la fecha de inicio + 10 aos
IF NEW.end_date &lt; NEW.start_date OR NEW.end_date IS NULL THEN  
NEW.end_date := NEW.start_date+ interval &#39;15 year&#39;;
END IF;  

-- Cuando se inserta o actualiza un registro se verifica que no haya un numero de cuenta igual, caso contrario devuelve uno disponible
CASE 
    WHEN TG_OP = &#39;INSERT&#39; THEN

    IF NEW.iddivision IS NULL AND EXISTS(SELECT iddivision FROM divisions WHERE iddivision = 0) THEN
	NEW.iddivision := 0;
      END IF;
      
        NEW.account := fun_account_auto_account(NEW.account, NEW.iddivision);

    WHEN TG_OP = &#39;UPDATE&#39; AND EXISTS(SELECT idcontact FROM accounts WHERE idcontact != NEW.idcontact AND account = NEW.account AND iddivision = NEW.iddivision) THEN
        NEW.account := fun_account_auto_account(NEW.account, NEW.iddivision);
    ELSE
      --  msg := &#39;other value than one or two&#39;;
END CASE;

--NEW.note := TG_WHEN;

NEW.admins := ARRAY(SELECT DISTINCT UNNEST(NEW.admins::INTEGER[]) ORDER BY 1);
-- TODO Verificar que los grupos ingresados pertenescan a el iddivision registrado, caso contrario eliminarlos
NEW.groups := ARRAY(SELECT DISTINCT UNNEST(NEW.groups::INTEGER[]) ORDER BY 1);

-- setea end_date = a start_date si la fecha end_date es menor que start_date
IF NEW.end_date &lt; NEW.start_date THEN  
NEW.end_date := NEW.start_date;
END IF;    


	
RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function admins_insert_update() -->
    <section id="public.function.admins-insert-update"
             xreflabel="publicadmins_insert_update()">
      <title id="public.function.admins-insert-update-title">
       admins_insert_update()
      </title>
      <titleabbrev id="public.function.admins-insert-update-titleabbrev">
       admins_insert_update()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN


--  Creamos un username si no es proporcionado
IF NEW.admin_username IS NULL OR LENGTH(NEW.admin_username) &lt; 1 THEN
--NEW.admin_username :=  NEW.identification; 

SELECT identification INTO NEW.admin_username FROM contacts WHERE idcontact = NEW.idcontact;
END IF;

-- creamos una clave igual al md5 del user_name si no es proporcionada.
IF NEW.admin_pwd IS NULL OR LENGTH(NEW.admin_pwd) &lt; 1 THEN
 NEW.admin_pwd := md5(NEW.admin_username::TEXT); 
END IF;

/*
-- Clave como md5
IF TG_OP = &#39;UPDATE&#39; THEN
NEW.admin_pwd := md5(NEW.admin_pwd::TEXT);
END IF;
*/

-- setea end_date = a start_date si la fecha end_date es menor que start_date
IF NEW.admin_end &lt; NEW.admin_start OR NEW.admin_end IS NULL THEN  
NEW.admin_end := NEW.admin_start+ interval &#39;1 year&#39;;
END IF;  

RETURN NEW;
END;
</programlisting>
      </para>
    </section>

<!-- Function admins_update_admin_pwd() -->
    <section id="public.function.admins-update-admin-pwd"
             xreflabel="publicadmins_update_admin_pwd()">
      <title id="public.function.admins-update-admin-pwd-title">
       admins_update_admin_pwd()
      </title>
      <titleabbrev id="public.function.admins-update-admin-pwd-titleabbrev">
       admins_update_admin_pwd()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN

-- creamos una clave igual al md5 del numero de identificacion si no es proporcionada.
IF NEW.admin_pwd IS NULL OR LENGTH(NEW.admin_pwd) &lt; 1 THEN
NEW.admin_pwd := md5(NEW.identification::TEXT);
END IF;

-- Clave como md5
IF TG_OP = &#39;UPDATE&#39; THEN
NEW.admin_pwd := md5(NEW.admin_pwd::TEXT);
END IF;


RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function contacts_insert_update() -->
    <section id="public.function.contacts-insert-update"
             xreflabel="publiccontacts_insert_update()">
      <title id="public.function.contacts-insert-update-title">
       contacts_insert_update()
      </title>
      <titleabbrev id="public.function.contacts-insert-update-titleabbrev">
       contacts_insert_update()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN

-- Si no se ha ingresado el campo identification se crea uno automaticamente
IF NEW.identification IS NULL THEN
NEW.identification :=  md5(extract(epoch FROM now())::TEXT);
END IF;
/*
IF NEW.is_admin IS TRUE THEN

--  Creamos un username si no es proporcionado
IF NEW.admin_username IS NULL OR LENGTH(NEW.admin_username) &lt; 1 THEN
NEW.admin_username :=  NEW.identification;
END IF;


-- creamos una clave igual al md5 del numero de identificacion si no es proporcionada.
IF NEW.admin_pwd IS NULL OR LENGTH(NEW.admin_pwd) &lt; 1 THEN
NEW.admin_pwd := md5(NEW.identification::TEXT);
END IF;

-- Clave como md5
IF TG_OP = &#39;UPDATE&#39; THEN
NEW.admin_pwd := md5(NEW.admin_pwd::TEXT);
END IF;


-- setea end_date = a start_date si la fecha end_date es menor que start_date
IF NEW.admin_end &lt; NEW.admin_start OR NEW.admin_end IS NULL THEN  
NEW.admin_end := NEW.admin_start+ interval &#39;1 year&#39;;
END IF;  

END IF;
*/

/*
INSERT INTO contacts(
            idcontact, ts, enabled, first_name, last_name, birthday, identification, 
            ididtype, postal_code, gender, geox, geoy, note, address, address_ref, 
            is_admin, admin_start, admin_end, admin_username, admin_pwd, 
            admin_sessionid, admin_ip, admin_level)
    VALUES (?, ?, ?, ?, ?, ?, ?, 
            ?, ?, ?, ?, ?, ?, ?, ?, 
            ?, ?, ?, ?, ?, 
            ?, ?, ?);
            */
--NEW.ts := now();

RETURN NEW;
END;
</programlisting>
      </para>
    </section>

<!-- Function contacts_update_admin_pwd() -->
    <section id="public.function.contacts-update-admin-pwd"
             xreflabel="publiccontacts_update_admin_pwd()">
      <title id="public.function.contacts-update-admin-pwd-title">
       contacts_update_admin_pwd()
      </title>
      <titleabbrev id="public.function.contacts-update-admin-pwd-titleabbrev">
       contacts_update_admin_pwd()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Devuelve el md5 de la clave ingresada cuando se actualiza.
        <programlisting>BEGIN

-- creamos una clave igual al md5 del numero de identificacion si no es proporcionada.
IF NEW.admin_pwd IS NULL OR LENGTH(NEW.admin_pwd) &lt; 1 THEN
NEW.admin_pwd := md5(NEW.identification::TEXT);
END IF;

-- Clave como md5
IF TG_OP = &#39;UPDATE&#39; THEN
NEW.admin_pwd := md5(NEW.admin_pwd::TEXT);
END IF;


RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function equipment_insert_update() -->
    <section id="public.function.equipment-insert-update"
             xreflabel="publicequipment_insert_update()">
      <title id="public.function.equipment-insert-update-title">
       equipment_insert_update()
      </title>
      <titleabbrev id="public.function.equipment-insert-update-titleabbrev">
       equipment_insert_update()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN

IF NEW.serial_number IS NULL OR  LENGTH(NEW.serial_number) &lt; 1 THEN
NEW.serial_number :=  md5(extract(epoch FROM now())::TEXT||random()::TEXT);
END IF;

IF NEW.code_ref IS NULL OR  LENGTH(NEW.code_ref) &lt; 1 THEN
NEW.code_ref :=  NEW.serial_number;
END IF;

IF NEW.report_validator IS NULL OR  LENGTH(NEW.report_validator) &lt; 16 THEN
NEW.report_validator :=  md5(NEW.idequipment::TEXT||NEW.code_ref);
END IF;

/*
IF NOT EXISTS(SELECT idcontact FROM accounts WHERE idcontact = NEW.idaccount LIMIT 1) THEN
NEW.idaccount :=  NULL;
END IF;
*/


RAISE NOTICE &#39;1) *** idequipment (%) idaccount (%) -&gt; %&#39;, NEW.idequipment, NEW.idaccount, TG_TABLE_NAME;


/*
INSERT INTO equipments(
            idequipment, ts, equipment, mark, model, serial_number, description, 
            installation_date, uninstall_date, working, note, code_ref, idaccount)
    VALUES (?, ?, ?, ?, ?, ?, ?, 
            ?, ?, ?, ?, ?, ?);

            */
--NEW.ts := now();

RETURN NEW;
END;
</programlisting>
      </para>
    </section>

<!-- Function event_comments_after_insert() -->
    <section id="public.function.event-comments-after-insert"
             xreflabel="publicevent_comments_after_insert()">
      <title id="public.function.event-comments-after-insert-title">
       event_comments_after_insert()
      </title>
      <titleabbrev id="public.function.event-comments-after-insert-titleabbrev">
       event_comments_after_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--iideventstatustype BIGINT;
iisopen BOOLEAN;

BEGIN

SELECT isopen INTO iisopen  FROM  event_statustypes WHERE ideventstatustype = NEW.ideventstatustype;

UPDATE events SET ideventstatustype = NEW.ideventstatustype, isopen = iisopen WHERE idevent = NEW.idevent;




/*
UPDATE sys_table_ts SET ts = now() WHERE table_name = TG_TABLE_NAME;
        IF NOT found THEN
INSERT INTO sys_table_ts (table_name) VALUES (TG_TABLE_NAME);
        END IF;
*/
/*

IF NEW.timeout &lt; 5 THEN
NEW.timeout := 5;
END IF;

IF NEW.img IS NULL OR LENGTH(NEW.img) &lt; 4 THEN
NEW.img := &#39;/notifications_media/img/dialog-error.png&#39;;
END IF;

IF NEW.snd IS NULL OR LENGTH(NEW.snd) &lt; 4 THEN
NEW.snd := &#39;/notifications_media/snd/snd00.mp3&#39;;
END IF;

IF NEW.title IS NULL OR LENGTH(NEW.title) &lt; 3 THEN
NEW.title := &#39;Notification&#39;;
END IF;

IF NEW.body IS NULL OR  LENGTH(NEW.body) &lt; 3 THEN
NEW.body := &#39;Empty notification message&#39;;
END IF;
*/
RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function event_comments_before_insert_redirect_partition() -->
    <section id="public.function.event-comments-before-insert-redirect-partition"
             xreflabel="publicevent_comments_before_insert_redirect_partition()">
      <title id="public.function.event-comments-before-insert-redirect-partition-title">
       event_comments_before_insert_redirect_partition()
      </title>
      <titleabbrev id="public.function.event-comments-before-insert-redirect-partition-titleabbrev">
       event_comments_before_insert_redirect_partition()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

table_part TEXT DEFAULT &#39;&#39;;

begin

table_part := fun_create_table_partition(TG_TABLE_NAME, NOW():: timestamp without time zone);


IF NOT EXISTS(SELECT trigger_name  FROM information_schema.triggers
                     WHERE event_object_table = table_part
                     AND trigger_name = &#39;on_insert&#39;
                     ) 
                     
                    THEN
                               
EXECUTE &#39;CREATE TRIGGER on_insert
  AFTER INSERT
  ON &#39;||table_part||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE event_comments_after_insert();&#39;;                               
                                                          
     END IF ;
     


-- No funcionan llaves foraneas con tablas heredadas
/*
IF NOT EXISTS(SELECT * FROM information_schema.table_constraints WHERE constraint_type = &#39;FOREIGN KEY&#39; AND table_name = table_part AND constraint_name = &#39;fk_&#39;||table_part||&#39;_idadmin&#39;) THEN

EXECUTE &#39;ALTER TABLE &#39;||table_part||&#39;
 ADD CONSTRAINT fk_&#39;||table_part||&#39;_idadmin FOREIGN KEY (idadmin) REFERENCES contacts (idcontact) ON UPDATE CASCADE ON DELETE SET NULL;&#39;;     

END IF;

*/


-- No funcionan llaves foraneas con tablas heredadas
/*
--ALTER TABLE event_comments_201512
--  ADD CONSTRAINT fk_event_comments_idadmin FOREIGN KEY (idadmin) REFERENCES contacts (idcontact) ON UPDATE CASCADE ON DELETE SET NULL;

IF NOT EXISTS(SELECT * FROM information_schema.table_constraints WHERE constraint_type = &#39;FOREIGN KEY&#39; AND table_name = table_part AND constraint_name = &#39;fk_&#39;||table_part||&#39;_idevent&#39;) THEN

EXECUTE &#39;ALTER TABLE &#39;||table_part||&#39;
 ADD CONSTRAINT fk_&#39;||table_part||&#39;_idevent FOREIGN KEY (idevent) REFERENCES events (idevent) ON UPDATE CASCADE ON DELETE CASCADE;&#39;;     

END IF;
*/


EXECUTE &#39;INSERT INTO &#39; || quote_ident(table_part) || &#39; SELECT ($1).*&#39; USING NEW;

return NULL;
end;</programlisting>
      </para>
    </section>

<!-- Function events_assignment_check_before_insert() -->
    <section id="public.function.events-assignment-check-before-insert"
             xreflabel="publicevents_assignment_check_before_insert()">
      <title id="public.function.events-assignment-check-before-insert-title">
       events_assignment_check_before_insert()
      </title>
      <titleabbrev id="public.function.events-assignment-check-before-insert-titleabbrev">
       events_assignment_check_before_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE 
  table_part TEXT DEFAULT &#39;1990&#39;; 
constraint_name_table TEXT DEFAULT &#39;_dateevent_check&#39;; 
  dateevent_year INTEGER DEFAULT 1990; 
/*et eventtypes%ROWTYPE; 
  --tbl TEXT DEFAULT &#39;events&#39;; 
  is_valid  BOOLEAN DEFAULT FALSE; 
  iaenabled BOOLEAN DEFAULT FALSE; 
  
  
  --iuuidevent UUID; 
  --lastidevent BIGINT; */

BEGIN 
  table_part := fun_create_table_partition(tg_table_name, NEW.date_start:: timestamp WITH TIME zone);
  constraint_name_table := table_part 
  ||&#39;_dateevent_check&#39;; 
  dateevent_year := Extract(year FROM NEW.date_start); 


  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;CHECK&#39; 
           AND    table_name = table_part 
           AND    constraint_name = constraint_name_table ) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part::text 
    ||&#39;   ADD CONSTRAINT &#39; 
    ||constraint_name_table::text 
    ||&#39; CHECK (EXTRACT(YEAR FROM date_start) = &#39; 
    ||dateevent_year::text 
    ||&#39;::double precision);&#39;; 
  END IF ; 

/*
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||table_part 
                         ||&#39;_idcontact_admin&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||table_part 
    ||&#39;_idcontact_admin FOREIGN KEY (idcontact_admin) REFERENCES contacts (idcontact)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 


  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||table_part 
                         ||&#39;_idcontact_user&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||table_part 
    ||&#39;_idcontact_user FOREIGN KEY (idcontact_user) REFERENCES contacts (idcontact)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 


  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;UNIQUE&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;uniq_&#39; 
                         ||table_part 
                         ||&#39;_de_ide_idevt_zu_ida&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT uniq_&#39; 
    ||table_part 
    ||&#39;_de_ide_idevt_zu_ida UNIQUE(idaccount, idequipment, zu, ideventtype, dateevent);&#39;; 
  END IF; 
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = table_part 
           AND    indexname = &#39;index_&#39; 
                         ||table_part 
                         ||&#39;_status&#39;) THEN 
    EXECUTE &#39; CREATE INDEX index_&#39; 
    ||table_part 
    ||&#39;_status   ON &#39; 
    ||table_part 
    ||&#39; USING btree (status) WHERE status = 0;&#39;; 
  END IF; 
  -- El unico dato para validar si el equipo o la cuenta son correctos es el idaccount o el idequipment
  CASE 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment IS NULL THEN 
    RAISE notice &#39;1) El idaccount o el idequipment no pueden ser nulos&#39;; 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment &gt; 0 THEN 
    SELECT coalesce( 
                      ( 
                      SELECT idaccount 
                      FROM   equipments 
                      WHERE  idequipment = NEW.idequipment), -1000) 
    INTO   NEW.idaccount; 
     
    IF NEW.idaccount &gt; 0 THEN 
      is_valid := TRUE; 
    ELSE 
      is_valid := FALSE; 
      NEW.idaccount := NULL; 
      -- Debemos insertar un evento que indique que se trata de insertar un evento de un idequipment sin asociar a un idaccount que no existe
      RAISE notice &#39;2) **** idequipment (%) no tiene idaccount asociada o es incorrecta&#39;, NEW.idaccount;
    END IF; 
  WHEN NEW.idaccount &gt;= 0 THEN 
    is_valid := TRUE; 
    --NEW.idequipment := 0; 
    RAISE notice &#39;3) ***** idaccount (%)&#39;, NEW.idaccount; 
  ELSE 
    RAISE notice &#39;3) ***** No pasa nada (%)&#39;, NEW.idaccount; 
    is_valid := FALSE; 
  END CASE; 
  RAISE notice &#39;4) Vamos a la validacion de ideventtype y relacionados&#39;; 
  IF is_valid THEN -- Obtenemos los datos del tipo de evento 
    SELECT * 
    INTO   et 
    FROM   eventtypes 
    WHERE  ideventtype = NEW.ideventtype; 
     
    -- Obtenemos los datos de la cuenta 
    SELECT enabled 
    INTO   iaenabled 
    FROM   accounts 
    WHERE  idcontact = NEW.idaccount; 
     
    CASE 
    WHEN NOT iaenabled THEN 
      NEW.status := 9; 
    WHEN et.expiration &lt;= 0 THEN 
      NEW.status := 2; 
    ELSE 
      RAISE notice &#39;events_before_insert ???? &#39;; 
    END CASE; 


    -- Validamos ideventtype y relacionados 
    IF NEW.ideventtype IS NULL 
      OR 
      NEW.ideventtype &lt; 1 THEN 
      RAISE notice &#39;5) IF NEW.ideventtype IS NULL OR NEW.ideventtype &lt; 1&#39;; 
      NEW.ideventtype := 0; 
    END IF; 
    RAISE notice &#39;6) Hacemos un select del tipo de evento&#39;; 
    IF (NEW.description IS NULL 
      OR 
      Length(NEW.description) &lt; 1) 
      AND 
      et.label IS NOT NULL THEN 
      RAISE notice &#39;7) IF (NEW.description IS NULL OR LENGTH(NEW.description) &lt; 1) AND et.label IS NOT NULL&#39;;
      NEW.description := et.label; 
    END IF; 
    IF (NEW.priority IS NULL 
      OR 
      NEW.priority &lt; 1) 
      AND 
      et.priority IS NOT NULL THEN 
      RAISE notice &#39;8) IF (NEW.priority IS NULL OR NEW.priority &lt; 1) AND et.priority IS NOT NULL&#39;;
      NEW.priority := et.priority; 
    END IF; 
    RAISE notice &#39;9) Finaliza las verificaciones, ahora va a insertar en la particion %&#39;, table_part;
    ------------------------------------------------------------ 
    -- Este bloque es especifico para cada tabla 
    CASE 
      -------------------------------------------- 
      -- hacemos el check especifico para la tabla events_diskspace 
    WHEN tg_table_name = &#39;events&#39; THEN -- Creamos el uuidevent en base a los campos 

      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_dbsizes&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.db_name 
      ||NEW.db_type::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_dbsizes 
                 WHERE  idevent = lastidevent 
                 AND    db_size = NEW.db_size) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_device_uptime&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_device_uptime 
                 WHERE  idevent = lastidevent 
                 AND    uptime = NEW.uptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_diskspace&#39; THEN -- Creamos el uuidevent en base a los campos
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.drive)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_diskspace 
                 WHERE  idevent = lastidevent 
                 AND    drive_size = NEW.drive_size 
                 AND    drive_free = NEW.drive_free) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_jobs&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.job_name)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_jobs 
                 WHERE  idevent = lastidevent 
                 AND    job_date_create = NEW.job_date_create 
                 AND    job_run_duration = NEW.job_run_duration 
                 AND    job_run_status = NEW.job_run_status 
                 AND    job_next_run = NEW.job_next_run) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_networkdevice_ping&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_networkdevice_ping 
                 WHERE  idevent = lastidevent 
                 AND    roundtriptime = NEW.roundtriptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
    WHEN tg_table_name = &#39;events_raid&#39; THEN -- Creamos el uuidevent en base a los campos 
   
    ELSE 

    END CASE; 
    EXECUTE &#39;INSERT INTO &#39; 
    || quote_ident(table_part) 
    || &#39; SELECT ($1).*&#39; USING NEW; 
  END IF; 
  */

    EXECUTE &#39;INSERT INTO &#39; 
    || quote_ident(table_part) 
    || &#39; SELECT ($1).*&#39; USING NEW; 

  RETURN NULL; 
END;</programlisting>
      </para>
    </section>

<!-- Function events_check_before_insert() -->
    <section id="public.function.events-check-before-insert"
             xreflabel="publicevents_check_before_insert()">
      <title id="public.function.events-check-before-insert-title">
       events_check_before_insert()
      </title>
      <titleabbrev id="public.function.events-check-before-insert-titleabbrev">
       events_check_before_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE 
  table_part TEXT DEFAULT &#39;1990&#39;; 
  et eventtypes%ROWTYPE; 
  --tbl TEXT DEFAULT &#39;events&#39;; 
  is_valid  BOOLEAN DEFAULT FALSE; 
  iaenabled BOOLEAN DEFAULT FALSE; 
  constraint_name_table TEXT DEFAULT &#39;_dateevent_check&#39;; 
  dateevent_year INTEGER DEFAULT 1990; 
  iuuidevent UUID; 
  lastidevent BIGINT;
  iiddivision BIGINT; 
BEGIN 

--table_part := fun_create_table_partition_events_data(tg_table_name, NEW.dateevent:: timestamp WITH TIME zone);
  table_part := fun_create_table_partition(tg_table_name, NEW.dateevent:: timestamp WITH TIME zone);
  

/*
constraint_name_table := table_part 
  ||&#39;_dateevent_check&#39;; 
  dateevent_year := Extract(year FROM NEW.dateevent); 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;CHECK&#39; 
           AND    table_name = table_part 
           AND    constraint_name = constraint_name_table ) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part::text 
    ||&#39;   ADD CONSTRAINT &#39; 
    ||constraint_name_table::text 
    ||&#39; CHECK (EXTRACT(YEAR FROM dateevent) = &#39; 
    ||dateevent_year::text 
    ||&#39;::double precision);&#39;; 
  END IF ; 
*/

  /* 
select * from information_schema.table_constraints where constraint_type = &#39;CHECK&#39; 
*/ 



/*
CREATE TRIGGER on_before_update_ideventstatustype
  BEFORE UPDATE OF isopen
  ON events
  FOR EACH ROW
  EXECUTE PROCEDURE events_update_ideventstatustype();
*/

/*
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = table_part 
           AND    trigger_name = &#39;on_before_update_ideventstatustype&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_before_update_ideventstatustype   BEFORE UPDATE OF isopen   ON &#39; 
    ||table_part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events_update_ideventstatustype();&#39;; 
  END IF ; 
  */


-------------------------
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = table_part 
           AND    trigger_name = &#39;on_insert_event&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_insert_event   AFTER INSERT   ON &#39; 
    ||table_part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events_on_insert();&#39;; 
  END IF ; 

  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||table_part 
                         ||&#39;_idadmin&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||table_part 
    ||&#39;_idadmin FOREIGN KEY (idadmin) REFERENCES admins (idadmin)  ON UPDATE CASCADE ON DELETE CASCADE;&#39;;
  END IF; 
  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||table_part 
                         ||&#39;_ideventreceptionmode&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||table_part 
    ||&#39;_ideventreceptionmode FOREIGN KEY (ideventreceptionmode) REFERENCES event_reception_modes (ideventreceptionmode)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 



  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    table_name = table_part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||table_part 
                         ||&#39;_ideventtype&#39;) THEN 
    EXECUTE &#39;ALTER TABLE &#39; 
    ||table_part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||table_part 
    ||&#39;_ideventtype FOREIGN KEY (ideventtype) REFERENCES eventtypes (ideventtype)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 

  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = table_part 
           AND    indexname = &#39;index_&#39; 
                         ||table_part 
                         ||&#39;_isopen&#39;) THEN 
    EXECUTE &#39; CREATE UNIQUE INDEX index_&#39; 
    ||table_part 
    ||&#39;_isopen   ON &#39; 
    ||table_part 
    ||&#39; USING btree (dateevent, ideventstatustype, idaccount, ideventtype, zu, idequipment)
  WHERE isopen = true;&#39;; 
  END IF; 


  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = table_part 
           AND    indexname = &#39;index_&#39; 
                         ||table_part 
                         ||&#39;_idaccideventt&#39;) THEN 
    EXECUTE &#39; CREATE INDEX index_&#39; 
    ||table_part 
    ||&#39;_idaccideventt   ON &#39; 
    ||table_part 
    ||&#39; USING btree (idaccount, ideventtype)&#39;; 
  END IF; 


  
  -- El unico dato para validar si el equipo o la cuenta son correctos es el idaccount o el idequipment
  CASE 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment IS NULL THEN 
    RAISE notice &#39;1) El idaccount o el idequipment no pueden ser nulos&#39;; 
  WHEN NEW.idaccount IS NULL 
    AND 
    NEW.idequipment &gt; 0 THEN 
    SELECT coalesce( 
                      ( 
                      SELECT idaccount 
                      FROM   equipments 
                      WHERE  idequipment = NEW.idequipment), -1000) 
    INTO   NEW.idaccount; 
     
    IF NEW.idaccount &gt; 0 THEN 
      is_valid := TRUE; 
    ELSE 
      is_valid := FALSE; 
      NEW.idaccount := NULL; 
      -- Debemos insertar un evento que indique que se trata de insertar un evento de un idequipment sin asociar a un idaccount que no existe
      RAISE notice &#39;2) **** idequipment (%) no tiene idaccount asociada o es incorrecta&#39;, NEW.idaccount;
    END IF; 
  WHEN NEW.idaccount &gt;= 0 THEN 
    is_valid := TRUE; 
    --NEW.idequipment := 0; 
    RAISE notice &#39;3) ***** idaccount (%)&#39;, NEW.idaccount; 
  ELSE 
    RAISE notice &#39;3) ***** No pasa nada (%)&#39;, NEW.idaccount; 
    is_valid := FALSE; 
  END CASE; 
  RAISE notice &#39;4) Vamos a la validacion de ideventtype y relacionados&#39;; 
  IF is_valid THEN -- Obtenemos los datos del tipo de evento 
    SELECT * 
    INTO   et 
    FROM   eventtypes 
    WHERE  ideventtype = NEW.ideventtype; 
   
    -- Obtenemos los datos de la cuenta 
    SELECT enabled 
    INTO   iaenabled 
    FROM   accounts 
    WHERE  idcontact = NEW.idaccount; 
     
    CASE 
    WHEN NOT iaenabled THEN 
      NEW.ideventstatustype := 9; 
    WHEN et.expiration &lt;= 0 THEN 
      NEW.ideventstatustype := 2; 
    ELSE 
      RAISE notice &#39;events_before_insert ???? &#39;; 
    END CASE; 

/*
    ------------------------------------------------------------------------------------------------------- 
    -- Revisamos si el idcontact que ingresa el evento existe, si es null ponemos a 0 
    IF NOT EXISTS 
      ( 
             SELECT * 
             FROM   contacts 
             WHERE  idcontact = NEW.idcontact) THEN 
      NEW.idcontact := 0; 
    END IF;
    */
     


    -- Validamos ideventtype y relacionados 
    IF NEW.ideventtype IS NULL 
      OR 
      NEW.ideventtype &lt; 1 THEN 
      RAISE notice &#39;5) IF NEW.ideventtype IS NULL OR NEW.ideventtype &lt; 1&#39;; 
      NEW.ideventtype := 0; 
    END IF; 
    RAISE notice &#39;6) Hacemos un select del tipo de evento&#39;; 
    IF (NEW.description IS NULL 
      OR 
      Length(NEW.description) &lt; 1) 
      AND 
      et.label IS NOT NULL THEN 
      RAISE notice &#39;7) IF (NEW.description IS NULL OR LENGTH(NEW.description) &lt; 1) AND et.label IS NOT NULL&#39;;
      NEW.description := et.label; 
    END IF; 
    IF (NEW.priority IS NULL 
      OR 
      NEW.priority &lt; 1) 
      AND 
      et.priority IS NOT NULL THEN 
      RAISE notice &#39;8) IF (NEW.priority IS NULL OR NEW.priority &lt; 1) AND et.priority IS NOT NULL&#39;;
      NEW.priority := et.priority; 
    END IF; 
    RAISE notice &#39;9) Finaliza las verificaciones, ahora va a insertar en la particion %&#39;, table_part;
    ------------------------------------------------------------ 
    -- Este bloque es especifico para cada tabla 
    CASE 
      -------------------------------------------- 
      -- hacemos el check especifico para la tabla events_diskspace 
    WHEN tg_table_name = &#39;events&#39; THEN -- Creamos el uuidevent en base a los campos 
      /*  NEW.uuidevent := Md5(Extract(epoch FROM NEW.dateevent)::text 
||NEW.idaccount::text 
||NEW.ideventtype::text 
||NEW.zu::text 
||NEW.idequipment::text)::uuid; */ 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_dbsizes&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.db_name 
      ||NEW.db_type::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_dbsizes 
                 WHERE  idevent = lastidevent 
                 AND    db_size = NEW.db_size) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_device_uptime&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_device_uptime 
                 WHERE  idevent = lastidevent 
                 AND    uptime = NEW.uptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_diskspace&#39; THEN -- Creamos el uuidevent en base a los campos
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.drive)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_diskspace 
                 WHERE  idevent = lastidevent 
                 AND    drive_size = NEW.drive_size 
                 AND    drive_free = NEW.drive_free) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_jobs&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text 
      ||NEW.job_name)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_jobs 
                 WHERE  idevent = lastidevent 
                 AND    job_date_create = NEW.job_date_create 
                 AND    job_run_duration = NEW.job_run_duration 
                 AND    job_run_status = NEW.job_run_status 
                 AND    job_next_run = NEW.job_next_run) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
      -------------------------------------------- 
    WHEN tg_table_name = &#39;events_networkdevice_ping&#39; THEN -- Creamos el uuidevent en base a los campos 
      iuuidevent := Md5( NEW.idaccount::text 
      ||NEW.ideventtype::text 
      ||NEW.zu::text 
      ||NEW.idequipment::text)::uuid; 
      SELECT idevent 
      INTO   lastidevent 
      FROM   events_last_idevent 
      WHERE  uuidevent = iuuidevent; 
       
      IF lastidevent &gt; 0 THEN 
        IF EXISTS 
          ( 
                 SELECT * 
                 FROM   events_networkdevice_ping 
                 WHERE  idevent = lastidevent 
                 AND    roundtriptime = NEW.roundtriptime) THEN 
          RETURN NULL; 
        END IF; 
      END IF; 
    WHEN tg_table_name = &#39;events_raid&#39; THEN -- Creamos el uuidevent en base a los campos 
      /*NEW.uuidevent := Md5(Extract(epoch FROM NEW.dateevent)::text 
||NEW.idaccount::text 
||NEW.ideventtype::text 
||NEW.zu::text 
||NEW.idequipment::text)::uuid;   */ 
    ELSE 

    END CASE; 

SELECT isopen INTO NEW.isopen FROM event_statustypes WHERE ideventstatustype = NEW.ideventstatustype;


IF NEW.isopen = TRUE THEN
 NEW.idadmin_assigned := fun_event_assignment(NEW.idaccount, NEW.ideventtype, NEW.idadmin_assigned);
 
/*
-------------------- 
-- TODO - Debe haber un bloque que auto asigne el evento al administrador que sea conveniente si el status esta en 0
-- Buscamos que administradores tienen acceso a la division y al iaccount de la cuenta de este evento
SELECT iddivision INTO iiddivision FROM accounts WHERE idcontact = NEW.idaccount;

SELECT idadmin 
INTO   NEW.idadmin_assigned 
FROM   admins 
WHERE  iiddivision = ANY(divisions) 
AND    NEW.idaccount = ANY (idaccounts) limit 1; 
*/

END IF; 



    EXECUTE &#39;INSERT INTO &#39; 
    || quote_ident(table_part) 
    || &#39; SELECT ($1).*&#39; USING NEW; 
  END IF; 
  RETURN NULL; 
END;</programlisting>
      </para>
    </section>

<!-- Function events_on_insert() -->
    <section id="public.function.events-on-insert"
             xreflabel="publicevents_on_insert()">
      <title id="public.function.events-on-insert-title">
       events_on_insert()
      </title>
      <titleabbrev id="public.function.events-on-insert-titleabbrev">
       events_on_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Envia la notificacion al navegador cuando un evento es insertado en la tabla
        <programlisting>DECLARE 
  ilabel TEXT DEFAULT &#39;&#39;; 
  ibody TEXT DEFAULT &#39;&#39;; 
  iafn TEXT DEFAULT &#39;&#39;; 
  ialn TEXT DEFAULT &#39;&#39;; 
  iaccount TEXT DEFAULT &#39;&#39;; 
  iaenabled BOOLEAN DEFAULT TRUE; 
  isessionid TEXT DEFAULT &#39;&#39;; 
  iiddivision     BIGINT; 
  idadminassigned BIGINT; 
  iuuidevent UUID; 
  et eventtypes%ROWTYPE; 
  array_ideventtypes_closed_for_this_ideventtype INTEGER[]; 
  idevent_for_close_on_restore                   INT DEFAULT 0; 
BEGIN 
  RAISE notice &#39;&gt;&gt;&gt; 1) Inicia Trigger events_on_insert&#39;; 
  RAISE notice &#39;&gt;&gt;&gt; 2)&#39;; 
  -- Obtenemos los datos del tipo de evento 
  SELECT * 
  INTO   et 
  FROM   eventtypes 
  WHERE  ideventtype = NEW.ideventtype; 
   
  RAISE notice &#39;&gt;&gt;&gt;&gt; 3)&#39;; 
  -- Obtenemos los datos de la cuenta 
  SELECT account, 
         first_name, 
         last_name, 
         enabled, 
         iddivision 
  INTO   iaccount, 
         iafn, 
         ialn, 
         iaenabled, 
         iiddivision 
  FROM   accounts 
  WHERE  idcontact = NEW.idaccount; 
   
  RAISE notice &#39;&gt;&gt;&gt; 4)&#39;; 
  IF et.notify_all_users THEN 
    isessionid := &#39;all&#39;; 
 -- ELSE 
    -- Obtenemos el sessionid segun el idadmin 
-- TODO porque ya no se debe manejar asi
/*
    SELECT admin_sessionid 
    INTO   isessionid 
    FROM   contacts 
    WHERE  idcontact = NEW.idadmin; 
    */
   
  END IF; 
  RAISE notice &#39;&gt;&gt;&gt;&gt; 5)&#39;; 
  IF iaenabled 
    AND 
    NEW.priority &lt; 21 THEN 
    RAISE notice &#39;&gt;&gt;&gt; 6)&#39;; 
    -- Mostramos la notificacion solo si la prioridad es menor o = que 20 
    ilabel := ialn 
    ||&#39; &#39; 
    ||iafn 
    ||&#39; [&#39; 
    ||iaccount 
    ||&#39;]&lt;/br&gt;&#39; 
    ||et.label 
    ||&#39;&lt;/br&gt;&#39;; 
    INSERT INTO notification_area 
                ( 
                            urgency, 
                            timeout, 
                            closable, 
                            img, 
                            snd, 
                            title, 
                            BODY, 
                            sessionid 
                ) 
                VALUES 
                ( 
                            NEW.priority, 
                            et.notify_timeout, 
                            et.notify_closable, 
                            et.notify_img, 
                            et.notify_snd, 
                            ilabel, 
                            &#39;&lt;b&gt;&#39; 
                                        ||NEW.dateevent 
                                        ||&#39;&lt;/b&gt;&lt;/br&gt;&#39; 
                                        ||NEW.description, 
                            isessionid 
                ); 
   
  END IF; 

/*

  -- Auto cerramos los eventos si se ha programado para ser cerrados por la llegada de este evento
  -- 1. Obtenemos la lista de los ideventtypes que sern cerrados por el ideventtype de este evento
  IF et.enable_auto_close_on_event_defined THEN 
    RAISE notice &#39;&gt;&gt;&gt; 7) SELECT idevent FROM events WHERE ideventtype = ANY(%) AND ideventstatustype = 0 AND idaccount = % AND zu = % AND idevent != %&#39;, et.auto_close_on_event_defined, NEW.idaccount, NEW.zu, NEW.idevent;
    FOR idevent_for_close_on_restore IN 
    SELECT idevent 
    FROM   EVENTS 
    WHERE  ideventtype = ANY(et.auto_close_on_event_defined) 
    AND    ideventstatustype = 0 
    AND    idaccount = NEW.idaccount 
    AND    zu = NEW.zu 
    AND    idevent != NEW.idevent 
    AND    idequipment = NEW.idequipment LOOP RAISE notice &#39;&gt;&gt;&gt; 8) Se cierra automaticamente el evento % por restauracion&#39;,
           idevent_for_close_on_restore; 
     
    INSERT INTO event_comments 
                ( 
                            comment_event, 
                            idevent, 
                            ideventstatustype 
                ) 
                VALUES 
                ( 
                            &#39;Event closed for restoring or status changed event - idevent &#39; 
                                        ||NEW.idevent, 
                            idevent_for_close_on_restore, 
                            7 
                ); 
   
  END LOOP; 
END IF; 
*/




-- Auto cerramos los eventos se se haya programado para ser cerrados por la llegada de este evento
-- 1. Obtenemos la lista de los ideventtypes que sern cerrados por el ideventtype de este evento
IF et.enable_auto_close_on_event_defined THEN 
  RAISE notice &#39;&gt;&gt;&gt; 7) SELECT idevent FROM events WHERE ideventtype = ANY(%) AND ideventstatustype = 0 AND idaccount = % AND zu = % AND idevent != %&#39;, et.auto_close_on_event_defined, NEW.idaccount, NEW.zu, NEW.idevent;
  FOR idevent_for_close_on_restore IN 
  SELECT idevent 
  FROM   events 
  WHERE  ideventtype = ANY(et.auto_close_on_event_defined) 
  AND    isopen = true 
  AND    idaccount = NEW.idaccount 
  AND    zu = NEW.zu 
  AND    idevent != NEW.idevent LOOP RAISE notice &#39;&gt;&gt;&gt; 8) Se cierra automaticamente el evento % por restauracion&#39;,
         idevent_for_close_on_restore; 
   
  INSERT INTO event_comments 
              ( 
                          comment_event, 
                          idevent, 
                          ideventstatustype 
              ) 
              VALUES 
              ( 
                          &#39;Event closed for restoring or status changed event - idevent &#39; 
                                      ||NEW.idevent, 
                          idevent_for_close_on_restore, 
                          7 
              ); 

END LOOP; 
END IF; 




RAISE notice &#39;&gt;&gt;&gt; 9) TERMINA EVENTS_ON_INSERT&#39;; 

-----------------------------------
-- Este bloque es especifico de cada tabla heredada para determinar el idevent del ultimo evento segun los parametros que sean necesarios
CASE 
  WHEN tg_table_name LIKE &#39;events_dbsizes%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.db_name||NEW.db_type::TEXT)::uuid; 
  
WHEN tg_table_name LIKE &#39;events_device_uptime%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

WHEN tg_table_name LIKE &#39;events_diskspace%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.drive)::uuid; 

WHEN tg_table_name LIKE &#39;events_jobs%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text||NEW.job_name)::uuid; 

WHEN tg_table_name LIKE &#39;events_networkdevice_ping%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

WHEN tg_table_name LIKE &#39;events_login%&#39; THEN -- Creamos el uuidevent en base a los campos
  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  --||NEW.zu::text 
  ||NEW.idadmin::text)::uuid; 


RAISE notice &#39;&gt;&gt;&gt; 9) idaccount % / ideventtype = % / idadmin = %&#39;, NEW.idaccount, NEW.ideventtype, NEW.idadmin;
  
ELSE 

  iuuidevent := md5( 
  NEW.idaccount::text 
  ||NEW.ideventtype::text 
  ||NEW.zu::text 
  ||NEW.idequipment::text)::uuid; 

END CASE; 


  IF EXISTS 
    ( 
           SELECT * 
           FROM   events_last_idevent 
           WHERE  uuidevent = iuuidevent) 
    THEN 
    UPDATE events_last_idevent 
    SET    idevent = NEW.idevent 
    WHERE  uuidevent = iuuidevent; 
   
  ELSE 
    INSERT INTO events_last_idevent 
                ( 
                            uuidevent, 
                            idevent 
                ) 
                VALUES 
                ( 
                            iuuidevent, 
                            NEW.idevent 
                ); 
   
  END IF; 
  


/*
-------------------- 
-- TODO - Debe haber un bloque que auto asigne el evento al administrador que sea conveniente si el status esta en 0
-- Buscamos que administradores tienen acceso a la division y al iaccount de la cuenta de este evento
SELECT idadmin 
INTO   NEW.idadmin_assigned 
FROM   admins 
WHERE  iiddivision = ANY(divisions) 
AND    NEW.idaccount = ANY (idaccounts) limit 1; 

IF NEW.idadmin_assigned &gt; 0 
  AND 
  NEW.isopen = true THEN 
  --NEW.status := -12; 
  INSERT INTO events_assignment 
              ( 
                          idevent, 
                          idadmin 
              ) 
              VALUES 
              ( 
                          NEW.idevent, 
                          idadminassigned 
              ); 

END IF; 
*/
RETURN NULL; 
END;</programlisting>
      </para>
    </section>

<!-- Function eventtypes_before_insert_update() -->
    <section id="public.function.eventtypes-before-insert-update"
             xreflabel="publiceventtypes_before_insert_update()">
      <title id="public.function.eventtypes-before-insert-update-title">
       eventtypes_before_insert_update()
      </title>
      <titleabbrev id="public.function.eventtypes-before-insert-update-titleabbrev">
       eventtypes_before_insert_update()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN

IF array_length(NEW.auto_close_on_event_defined, 1) &gt; 0 THEN
NEW.auto_close_on_event_defined := ARRAY(SELECT DISTINCT UNNEST(NEW.auto_close_on_event_defined::INTEGER[]) ORDER BY 1);
END IF;


--NEW.groups := ARRAY(SELECT DISTINCT UNNEST(NEW.groups::INTEGER[]) ORDER BY 1);

RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_account_auto_account(idivision text, iaccount bigint) -->
    <section id="public.function.fun-account-auto-account-idivision-text-iaccount-bigint"
             xreflabel="publicfun_account_auto_account(idivision text, iaccount bigint)">
      <title id="public.function.fun-account-auto-account-idivision-text-iaccount-bigint-title">
       fun_account_auto_account(idivision text, iaccount bigint)
      </title>
      <titleabbrev id="public.function.fun-account-auto-account-idivision-text-iaccount-bigint-titleabbrev">
       fun_account_auto_account(idivision text, iaccount bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

r TEXT DEFAULT &#39;oams&#39;;
i INTEGER DEFAULT 0;

BEGIN

IF iaccount IS NULL OR LENGTH(iaccount) &lt; 1 THEN
iaccount := &#39;oams&#39;;
END IF;

r := iaccount;
RAISE NOTICE &#39;Asignado r(%)&#39;, r;
-- Chequeamo que el numero de la cuenta no se repita, si lo hace buscamos el siguiente numero disponible
WHILE EXISTS(SELECT * FROM accounts WHERE account = r AND iddivision = idivision) AND i &lt; 10 LOOP
    r := iaccount||&#39;(&#39;||i::text||&#39;)&#39;;
RAISE NOTICE &#39;Asignado rx(%)&#39;, r;
i := i+1;
END LOOP;



/*
SELECT idcontact, ts, enabled, first_name, last_name, birthday, identification, 
       ididtype, postal_code, gender, geox, geoy, note, address, address_ref, 
       idaccountstate, idaccounttype, start_date, end_date, account
  FROM accounts;

*/

/*
-- Chequeamo que el numero de la cuenta no se repita, si lo hace buscamos el siguiente numero disponible
WHILE usaga.fun_account_search_number(iaccount) &gt; 0 LOOP
    inaccount := initialaccount||&#39;(&#39;||i::text||&#39;)&#39;;
i := i+1;
END LOOP;
*/
RAISE NOTICE &#39;Asignado rs(%)&#39;, r;

RETURN  r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_check_sessionid_idadmin(iip text, isessionid text, iusername text) -->
    <section id="public.function.fun-check-sessionid-idadmin-iip-text-isessionid-text-iusername-text"
             xreflabel="publicfun_check_sessionid_idadmin(iip text, isessionid text, iusername text)">
      <title id="public.function.fun-check-sessionid-idadmin-iip-text-isessionid-text-iusername-text-title">
       fun_check_sessionid_idadmin(iip text, isessionid text, iusername text)
      </title>
      <titleabbrev id="public.function.fun-check-sessionid-idadmin-iip-text-isessionid-text-iusername-text-titleabbrev">
       fun_check_sessionid_idadmin(iip text, isessionid text, iusername text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--Now timestamp without time zone default now();
R INTEGER DEFAULT 1;

BEGIN
/*
R := COALESCE((SELECT idcontact FROM contacts WHERE admin_username = iusername AND admin_sessionid = isessionid AND is_admin = true LIMIT 1), -200);

IF R &lt; 1 THEN
--PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, 0, 0, 0, 1004, &#39;Unauthorized user &#39;||iusername::text, 0);
INSERT INTO events(
            status, idaccount, ideventtype, description)
    VALUES (0, 0, 1004, &#39;Unauthorized user &#39;||iusername::text||&#39; from IP &#39;||iip::text);

END IF;
*/

RETURN R;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_create_table_partition(idatetimeevent text, inherts_table timestamp with time zone) -->
    <section id="public.function.fun-create-table-partition-idatetimeevent-text-inherts-table-timestamp-with-time-zone"
             xreflabel="publicfun_create_table_partition(idatetimeevent text, inherts_table timestamp with time zone)">
      <title id="public.function.fun-create-table-partition-idatetimeevent-text-inherts-table-timestamp-with-time-zone-title">
       fun_create_table_partition(idatetimeevent text, inherts_table timestamp with time zone)
      </title>
      <titleabbrev id="public.function.fun-create-table-partition-idatetimeevent-text-inherts-table-timestamp-with-time-zone-titleabbrev">
       fun_create_table_partition(idatetimeevent text, inherts_table timestamp with time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

part TEXT DEFAULT &#39;19000101&#39;;

BEGIN

part := inherts_table||&#39;_&#39;||fun_sufix_name_by_date(idatetimeevent)::TEXT;

IF NOT EXISTS(SELECT table_name FROM information_schema.tables WHERE  table_schema = &#39;public&#39; AND table_name = part LIMIT 1) THEN

EXECUTE &#39;CREATE TABLE IF NOT EXISTS public.&#39;||part::TEXT||&#39;(
   LIKE public.&#39;||inherts_table||&#39; INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE INCLUDING COMMENTS
) 
INHERITS (&#39;||inherts_table||&#39;)
WITH (
  OIDS = FALSE,
  toast.autovacuum_enabled=true
);&#39;;


-- Trigger: on_changed_table on events

-- DROP TRIGGER on_changed_table ON events;

EXECUTE &#39;CREATE TRIGGER on_changed_table
  AFTER INSERT OR UPDATE OR DELETE
  ON &#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_changed_table();&#39;;

-- Trigger: on_insert_event on events

-- DROP TRIGGER on_insert_event ON events;
/*
EXECUTE &#39;CREATE TRIGGER on_insert_event
  AFTER INSERT
  ON &#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE events_on_insert();&#39;;
  */

-- Trigger: on_update_row on events

-- DROP TRIGGER on_update_row ON events;

EXECUTE &#39;CREATE TRIGGER on_update_row
  BEFORE UPDATE
  ON &#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_update_row_update_ts();&#39;;

END IF;


RETURN part;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_create_table_partition_events_data(idatetimeevent text, inherts_table timestamp with time zone) -->
    <section id="public.function.fun-create-table-partition-events-data-idatetimeevent-text-inherts-table-timestamp-with-time-zone"
             xreflabel="publicfun_create_table_partition_events_data(idatetimeevent text, inherts_table timestamp with time zone)">
      <title id="public.function.fun-create-table-partition-events-data-idatetimeevent-text-inherts-table-timestamp-with-time-zone-title">
       fun_create_table_partition_events_data(idatetimeevent text, inherts_table timestamp with time zone)
      </title>
      <titleabbrev id="public.function.fun-create-table-partition-events-data-idatetimeevent-text-inherts-table-timestamp-with-time-zone-titleabbrev">
       fun_create_table_partition_events_data(idatetimeevent text, inherts_table timestamp with time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

part TEXT DEFAULT &#39;19000101&#39;;
constraint_name_table TEXT DEFAULT &#39;_dateevent_check&#39;;
dateevent_year INTEGER DEFAULT 1990; 

BEGIN

part := inherts_table||&#39;_&#39;||fun_sufix_name_by_date(idatetimeevent)::TEXT;

IF NOT EXISTS(SELECT table_name FROM information_schema.tables WHERE  table_schema = &#39;events_data&#39; AND table_name = part LIMIT 1) THEN

EXECUTE &#39;CREATE TABLE IF NOT EXISTS events_data.&#39;||part::TEXT||&#39;(
   LIKE public.&#39;||inherts_table||&#39; INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE INCLUDING COMMENTS
) 
INHERITS (&#39;||inherts_table||&#39;)
WITH (
  OIDS = FALSE,
  toast.autovacuum_enabled=true
);&#39;;


-- Trigger: on_changed_table on events

-- DROP TRIGGER on_changed_table ON events;

EXECUTE &#39;CREATE TRIGGER on_changed_table
  AFTER INSERT OR UPDATE OR DELETE
  ON events_data.&#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_changed_table();&#39;;

-- Trigger: on_update_row on events

-- DROP TRIGGER on_update_row ON events;

EXECUTE &#39;CREATE TRIGGER on_update_row
  BEFORE UPDATE
  ON events_data.&#39;||part::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_update_row_update_ts();&#39;;


  constraint_name_table := part ||&#39;_dateevent_check&#39;; 
  dateevent_year := Extract(year FROM idatetimeevent); 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;CHECK&#39; 
           AND    table_name = part 
           AND    constraint_schema = &#39;events_data&#39; 
           AND    constraint_name = constraint_name_table ) THEN 
    EXECUTE &#39;ALTER TABLE events_data.&#39; 
    ||part::text 
    ||&#39;   ADD CONSTRAINT &#39; 
    ||constraint_name_table::text 
    ||&#39; CHECK (EXTRACT(YEAR FROM dateevent) = &#39; 
    ||dateevent_year::text 
    ||&#39;::double precision);&#39;; 
  END IF ; 



-----------------------------------------------

-------------------------
  IF NOT EXISTS 
    ( 
           SELECT trigger_name 
           FROM   information_schema.TRIGGERS 
           WHERE  event_object_table = part 
           AND    event_object_schema = &#39;events_data&#39; 
           AND    trigger_name = &#39;on_insert_event&#39; ) THEN 
    ---------------------- 
    EXECUTE &#39;CREATE TRIGGER on_insert_event   AFTER INSERT   ON events_data.&#39; 
    ||part::text 
    ||&#39;   FOR EACH ROW   EXECUTE PROCEDURE events_on_insert();&#39;; 
  END IF ; 

  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    constraint_schema = &#39;events_data&#39;            
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_idadmin&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events_data.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_idadmin FOREIGN KEY (idadmin) REFERENCES admins (idadmin)  ON UPDATE CASCADE ON DELETE CASCADE;&#39;;
  END IF; 
  
  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39; 
           AND    constraint_schema = &#39;events_data&#39;                       
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_ideventreceptionmode&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events_data.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_ideventreceptionmode FOREIGN KEY (ideventreceptionmode) REFERENCES event_reception_modes (ideventreceptionmode)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 



  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   information_schema.table_constraints 
           WHERE  constraint_type = &#39;FOREIGN KEY&#39;
	   AND    constraint_schema = &#39;events_data&#39;                       
           AND    table_name = part 
           AND    constraint_name = &#39;fk_&#39; 
                         ||part 
                         ||&#39;_ideventtype&#39;) THEN 
    EXECUTE &#39;ALTER TABLE events_data.&#39; 
    ||part 
    ||&#39;  ADD CONSTRAINT fk_&#39; 
    ||part 
    ||&#39;_ideventtype FOREIGN KEY (ideventtype) REFERENCES eventtypes (ideventtype)  ON UPDATE CASCADE ON DELETE SET NULL;&#39;;
  END IF; 

  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = part 
           AND schemaname = &#39;events_data&#39;
           AND    indexname = &#39;index_&#39; 
                         ||part 
                         ||&#39;_isopen&#39;) THEN 
    EXECUTE &#39; CREATE UNIQUE INDEX index_&#39; 
    ||part 
    ||&#39;_isopen   ON events_data.&#39; 
    ||part 
    ||&#39; USING btree (dateevent, ideventstatustype, idaccount, ideventtype, zu, idequipment)
  WHERE isopen = true;&#39;; 
  END IF; 


  ---------------------- 
  IF NOT EXISTS 
    ( 
           SELECT * 
           FROM   pg_indexes 
           WHERE  tablename = part 
           AND schemaname = &#39;events_data&#39;           
           AND    indexname = &#39;index_&#39; 
                         ||part 
                         ||&#39;_idaccideventt&#39;) THEN 
    EXECUTE &#39; CREATE INDEX index_&#39; 
    ||part 
    ||&#39;_idaccideventt   ON events_data.&#39; 
    ||part 
    ||&#39; USING btree (idaccount, ideventtype)&#39;; 
  END IF; 




  
  

END IF;


RETURN part;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_edit_event_comments(fun_msg integer, fun_return integer, iidevent timestamp without time zone, istatus integer, icomment_event text, iseconds integer, istart bigint) -->
    <section id="public.function.fun-edit-event-comments-fun-msg-integer-fun-return-integer-iidevent-timestamp-without-time-zone-istatus-integer-icomment-event-text-iseconds-integer-istart-bigint"
             xreflabel="publicfun_edit_event_comments(fun_msg integer, fun_return integer, iidevent timestamp without time zone, istatus integer, icomment_event text, iseconds integer, istart bigint)">
      <title id="public.function.fun-edit-event-comments-fun-msg-integer-fun-return-integer-iidevent-timestamp-without-time-zone-istatus-integer-icomment-event-text-iseconds-integer-istart-bigint-title">
       fun_edit_event_comments(fun_msg integer, fun_return integer, iidevent timestamp without time zone, istatus integer, icomment_event text, iseconds integer, istart bigint)
      </title>
      <titleabbrev id="public.function.fun-edit-event-comments-fun-msg-integer-fun-return-integer-iidevent-timestamp-without-time-zone-istatus-integer-icomment-event-text-iseconds-integer-istart-bigint-titleabbrev">
       fun_edit_event_comments(fun_msg integer, fun_return integer, iidevent timestamp without time zone, istatus integer, icomment_event text, iseconds integer, istart bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

CASE

	WHEN id = 0  THEN
-- Ingresamos un nuevo registro
INSERT INTO event_comments(
            idadmin, start, seconds, comment_event, status, 
            idevent)
    VALUES (iidadmin, istart, iseconds, icomment_event, istatus, 
            iidevent) RETURNING ideventcomment INTO fun_return;
fun_msg := &#39;Nuevo registro insertado&#39;;

	WHEN id &gt; 0  THEN
-- Actualizamos
UPDATE event_comments
   SET idadmin=iidadmin, start=istart, seconds=iseconds, comment_event=icomment_event, 
       status=istatus, idevent=iidevent
 WHERE  ideventcomment=id;
 fun_return = id;
 fun_msg := &#39;Registro Actualizado&#39;;

	WHEN id &lt; 0  THEN
-- Eliminamos
 DELETE FROM event_comments
 WHERE  ideventcomment=id;
 fun_return := 0;
 fun_msg := &#39;Registro Eliminado&#39;;

 END CASE;


RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint) -->
    <section id="public.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint"
             xreflabel="publicfun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)">
      <title id="public.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint-title">
       fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)
      </title>
      <titleabbrev id="public.function.fun-event-assignment-admin-assigned-bigint-iideventtype-bigint-iidaccount-bigint-titleabbrev">
       fun_event_assignment(admin_assigned bigint, iideventtype bigint, iidaccount bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>bigint</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

R BIGINT;
iiddivision BIGINT;
iisopen boolean DEFAULT FALSE;

BEGIN

IF EXISTS(SELECT * FROM admins WHERE idadmin = admin_assigned) THEN
R := admin_assigned;
ELSE   

-------------------- 
-- TODO - Debe haber un bloque que auto asigne el evento al administrador que sea conveniente si el status esta en 0
-- Buscamos que administradores tienen acceso a la division y al iaccount de la cuenta de este evento
SELECT iddivision INTO iiddivision FROM accounts WHERE idcontact = iidaccount;

SELECT idadmin 
INTO   R 
FROM   admins 
WHERE  iiddivision = ANY(divisions) 
AND    iidaccount = ANY (idaccounts) limit 1; 

END IF;


RETURN R;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_comment_insert_selected(fun_msg integer[], fun_return integer, iidadmin text, istatus integer, icomment integer) -->
    <section id="public.function.fun-event-comment-insert-selected-fun-msg-integerARRAY-fun-return-integer-iidadmin-text-istatus-integer-icomment-integer"
             xreflabel="publicfun_event_comment_insert_selected(fun_msg integer[], fun_return integer, iidadmin text, istatus integer, icomment integer)">
      <title id="public.function.fun-event-comment-insert-selected-fun-msg-integerARRAY-fun-return-integer-iidadmin-text-istatus-integer-icomment-integer-title">
       fun_event_comment_insert_selected(fun_msg integer[], fun_return integer, iidadmin text, istatus integer, icomment integer)
      </title>
      <titleabbrev id="public.function.fun-event-comment-insert-selected-fun-msg-integerARRAY-fun-return-integer-iidadmin-text-istatus-integer-icomment-integer-titleabbrev">
       fun_event_comment_insert_selected(fun_msg integer[], fun_return integer, iidadmin text, istatus integer, icomment integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

i INTEGER DEFAULT 0;
iidevent INTEGER;

BEGIN

fun_return := -100;
fun_msg := &#39;Comentario agregado a varios eventos&#39;;


   FOREACH iidevent IN ARRAY iidevents
   LOOP
      --RAISE NOTICE &#39;another_func(%,%)&#39;,m[1], m[2];
INSERT INTO event_comments(
            idadmin, seconds, comment_event, status, 
            idevent)
    VALUES (iidadmin, iseconds, icomment, istatus, 
            iidevent);

	i := i+1;
   END LOOP;


fun_return := i;
fun_msg := &#39;Comentario agregado a &#39;||i::TEXT||&#39; eventos&#39;;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_comments_table_create_partition(idatetimeevent timestamp without time zone) -->
    <section id="public.function.fun-event-comments-table-create-partition-idatetimeevent-timestamp-without-time-zone"
             xreflabel="publicfun_event_comments_table_create_partition(idatetimeevent timestamp without time zone)">
      <title id="public.function.fun-event-comments-table-create-partition-idatetimeevent-timestamp-without-time-zone-title">
       fun_event_comments_table_create_partition(idatetimeevent timestamp without time zone)
      </title>
      <titleabbrev id="public.function.fun-event-comments-table-create-partition-idatetimeevent-timestamp-without-time-zone-titleabbrev">
       fun_event_comments_table_create_partition(idatetimeevent timestamp without time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

r BOOLEAN DEFAULT TRUE;
dia TEXT DEFAULT &#39;19000101&#39;;

BEGIN

dia := &#39;event_comments_&#39;||fun_sufix_name_by_date(idatetimeevent);

IF NOT EXISTS(SELECT table_name FROM information_schema.tables WHERE table_catalog = &#39;open_ams&#39; AND table_schema = &#39;public&#39; AND table_name = dia LIMIT 1) THEN

EXECUTE &#39;CREATE TABLE IF NOT EXISTS public.&#39;||dia::TEXT||&#39;(
   LIKE public.event_comments INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE
) 
INHERITS (event_comments)
WITH (
  OIDS = FALSE,
  autovacuum_enabled=true,
  toast.autovacuum_enabled=true
);&#39;;

/*

CREATE TABLE public.events_comments_dia
(
   LIKE public.event_comments INCLUDING DEFAULTS INCLUDING CONSTRAINTS INCLUDING INDEXES INCLUDING STORAGE
) 
INHERITS (event_comments)
WITH (
  OIDS = FALSE
)
;

*/

-- Trigger: on_changed_table on event_comments

-- DROP TRIGGER on_changed_table ON event_comments;

EXECUTE  &#39;CREATE TRIGGER on_changed_table
  AFTER INSERT OR UPDATE OR DELETE
  ON &#39;||dia::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_changed_table();&#39;;

-- Trigger: on_insert on event_comments

-- DROP TRIGGER on_insert ON event_comments;

EXECUTE &#39;CREATE TRIGGER on_insert
  BEFORE INSERT
  ON &#39;||dia::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE event_comments_on_insert();&#39;;

-- Trigger: on_update_row on event_comments

-- DROP TRIGGER on_update_row ON event_comments;

EXECUTE &#39;CREATE TRIGGER on_update_row
  BEFORE UPDATE
  ON &#39;||dia::TEXT||&#39;
  FOR EACH ROW
  EXECUTE PROCEDURE on_update_row_update_ts();&#39;;


END IF;

RETURN r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_get_detail_as_json(iidevent bigint) -->
    <section id="public.function.fun-event-get-detail-as-json-iidevent-bigint"
             xreflabel="publicfun_event_get_detail_as_json(iidevent bigint)">
      <title id="public.function.fun-event-get-detail-as-json-iidevent-bigint-title">
       fun_event_get_detail_as_json(iidevent bigint)
      </title>
      <titleabbrev id="public.function.fun-event-get-detail-as-json-iidevent-bigint-titleabbrev">
       fun_event_get_detail_as_json(iidevent bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>json</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

origin_table TEXT;
rjson json;

BEGIN

--regclass

SELECT tableoid::regclass::TEXT INTO origin_table FROM events WHERE idevent = iidevent;

EXECUTE &#39;SELECT row_to_json(&#39;||origin_table||&#39;) FROM &#39;||origin_table||&#39; WHERE idevent = &#39;||iidevent::TEXT INTO rjson;




RETURN rjson;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_insert(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription text, iideventtype integer, ipriority integer, izu integer, icode text, iidaccount integer) -->
    <section id="public.function.fun-event-insert-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-text-iideventtype-integer-ipriority-integer-izu-integer-icode-text-iidaccount-integer"
             xreflabel="publicfun_event_insert(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription text, iideventtype integer, ipriority integer, izu integer, icode text, iidaccount integer)">
      <title id="public.function.fun-event-insert-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-text-iideventtype-integer-ipriority-integer-izu-integer-icode-text-iidaccount-integer-title">
       fun_event_insert(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription text, iideventtype integer, ipriority integer, izu integer, icode text, iidaccount integer)
      </title>
      <titleabbrev id="public.function.fun-event-insert-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-text-iideventtype-integer-ipriority-integer-izu-integer-icode-text-iidaccount-integer-titleabbrev">
       fun_event_insert(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription text, iideventtype integer, ipriority integer, izu integer, icode text, iidaccount integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

IF NOT EXISTS(SELECT idevent FROM eventtypes WHERE ideventtype = iideventtype) THEN
-- Verificamos si existe el ideventtype, caso contrario le asignamos como 0 (desconocido)
iideventtype := 0;
END IF;


SELECT * FROM fun_edit_events(0, idateevent, istatus, iidaccount, icode, izu, ipriority, iideventtype, idescription, iidadmin) INTO fun_return, fun_msg;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_insert_by_ideventtype(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer) -->
    <section id="public.function.fun-event-insert-by-ideventtype-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer"
             xreflabel="publicfun_event_insert_by_ideventtype(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)">
      <title id="public.function.fun-event-insert-by-ideventtype-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer-title">
       fun_event_insert_by_ideventtype(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)
      </title>
      <titleabbrev id="public.function.fun-event-insert-by-ideventtype-fun-msg-timestamp-without-time-zone-fun-return-integer-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer-titleabbrev">
       fun_event_insert_by_ideventtype(fun_msg timestamp without time zone, fun_return integer, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       Inserta un evento usando como parametros principales el ideventtype para buscar los datos de ese evento y el account para obtener el idcontact de la tabla accounts.
        <programlisting>DECLARE

istatus INTEGER DEFAULT 0;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

/*
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = iideventtype) THEN
-- Verificamos si existe el ideventtype, caso contrario le asignamos como 0 (desconocido)
iideventtype := 0;
END IF;
*/

-- Insertamos
SELECT * FROM fun_edit_events(0, idateevent, istatus, iidaccount, &#39;&#39;, izu, ipriority, iideventtype, idescription, iidadmin) INTO fun_return, fun_msg;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_insert_by_ideventtype_account(fun_msg timestamp without time zone, fun_return text, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer) -->
    <section id="public.function.fun-event-insert-by-ideventtype-account-fun-msg-timestamp-without-time-zone-fun-return-text-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer"
             xreflabel="publicfun_event_insert_by_ideventtype_account(fun_msg timestamp without time zone, fun_return text, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)">
      <title id="public.function.fun-event-insert-by-ideventtype-account-fun-msg-timestamp-without-time-zone-fun-return-text-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer-title">
       fun_event_insert_by_ideventtype_account(fun_msg timestamp without time zone, fun_return text, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)
      </title>
      <titleabbrev id="public.function.fun-event-insert-by-ideventtype-account-fun-msg-timestamp-without-time-zone-fun-return-text-iidadmin-integer-idescription-integer-iideventtype-integer-ipriority-text-izu-integer-titleabbrev">
       fun_event_insert_by_ideventtype_account(fun_msg timestamp without time zone, fun_return text, iidadmin integer, idescription integer, iideventtype integer, ipriority text, izu integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

iidaccount INTEGER DEFAULT 1;

BEGIN
iidaccount := fun_get_idaccount_by_account(iaccount);
-- Insertamos
SELECT * FROM fun_event_insert_by_ideventtype(idateevent, iidaccount, izu, ipriority, iideventtype, idescription, iidadmin) INTO fun_return, fun_msg;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_insert_diskspace(ofun_msg bigint, ofun_return text, isize real) -->
    <section id="public.function.fun-event-insert-diskspace-ofun-msg-bigint-ofun-return-text-isize-real"
             xreflabel="publicfun_event_insert_diskspace(ofun_msg bigint, ofun_return text, isize real)">
      <title id="public.function.fun-event-insert-diskspace-ofun-msg-bigint-ofun-return-text-isize-real-title">
       fun_event_insert_diskspace(ofun_msg bigint, ofun_return text, isize real)
      </title>
      <titleabbrev id="public.function.fun-event-insert-diskspace-ofun-msg-bigint-ofun-return-text-isize-real-titleabbrev">
       fun_event_insert_diskspace(ofun_msg bigint, ofun_return text, isize real)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

min_space INTEGER DEFAULT 50000;
idescrip TEXT DEFAULT &#39;&#39;;
iideventtype INTEGER DEFAULT 0;
iidaccount INTEGER DEFAULT 0;
last_size REAL DEFAULT -100;
row_network_device view_account_network_devices%ROWTYPE;

BEGIN


SELECT * INTO row_network_device FROM view_account_network_devices WHERE idequipment = iidequipment;

idescrip := &#39;&#39;;


--last_size := COALESCE((SELECT drive_size FROM events_diskspace WHERE idequipment = iidequipment  AND drive =  idrive ORDER BY idevent DESC LIMIT 1), -200);
--RAISE  &#39;DESPUES: %&#39;, timeofday();

CASE


	WHEN idrive = &#39;D&#39; OR idrive = &#39;E&#39; THEN
IF isize &gt; min_space THEN
iideventtype := 62;
idescrip := idescrip||&#39;&lt;b&gt;Drive:&lt;/b&gt; &#39;||idrive||&#39; &lt;/br&gt;&lt;b&gt;Size:&lt;/b&gt; &#39;||isize||&#39; MB&#39;;
ELSE
iideventtype := 52;
idescrip := idescrip||&#39;&lt;b&gt;Drive:&lt;/b&gt; &#39;||idrive||&#39; &lt;/br&gt;&lt;b&gt;Size:&lt;/b&gt; &#39;||isize||&#39; MB. &lt;/br&gt;Disk space lower than &#39;||min_space||&#39; MB.&#39;;
END IF;

ELSE

IF isize &gt; 15000 THEN
iideventtype := 62;
idescrip := idescrip||&#39;&lt;b&gt;Drive:&lt;/b&gt; &#39;||idrive||&#39; &lt;/br&gt;&lt;b&gt;Size:&lt;/b&gt; &#39;||isize||&#39; MB&#39;;
ELSE
iideventtype := 52;
idescrip := idescrip||&#39;&lt;b&gt;Drive:&lt;/b&gt; &#39;||idrive||&#39; &lt;/br&gt;&lt;b&gt;Size:&lt;/b&gt; &#39;||isize||&#39; MB. &lt;/br&gt;Disk space lower than &#39;||15000::text||&#39; MB.&#39;;
END IF;

END CASE;


 INSERT INTO events_diskspace (ideventtype, description, idaccount, drive, drive_free, zu, idequipment) VALUES (iideventtype, idescrip, row_network_device.idcontact, idrive, isize, ascii(idrive), iidequipment) RETURNING idevent INTO ofun_return;


RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_status_get_label(istatus integer) -->
    <section id="public.function.fun-event-status-get-label-istatus-integer"
             xreflabel="publicfun_event_status_get_label(istatus integer)">
      <title id="public.function.fun-event-status-get-label-istatus-integer-title">
       fun_event_status_get_label(istatus integer)
      </title>
      <titleabbrev id="public.function.fun-event-status-get-label-istatus-integer-titleabbrev">
       fun_event_status_get_label(istatus integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE
r TEXT DEFAULT &#39;Unknown&#39;;
BEGIN

CASE

	WHEN istatus = 0  THEN
-- Abierto
		r := &#39;Open&#39;;
	WHEN istatus = 1  THEN
-- Cerrado
		r := &#39;Close&#39;;
	WHEN istatus = 2  THEN
-- Cerrado automaticamente por el sistema
		r := &#39;Close (System)&#39;;
	WHEN istatus = 3  THEN
-- Pendiente
		r := &#39;Pending&#39;;
	WHEN istatus = 4  THEN
-- Reabierto		
		r := &#39;Reopen&#39;;
	WHEN istatus = 5  THEN	
		r := &#39;Expired&#39;;
	WHEN istatus = 6  THEN	
		r := &#39;Close (Like other previous event without closing)&#39;;
	WHEN istatus = 7  THEN						
		r := &#39;Close (For Restore)&#39;;
	WHEN istatus = 8  THEN						
		r := &#39;Close (Invalid account)&#39;;	
			WHEN istatus = 9  THEN						
		r := &#39;Close (Unabled account)&#39;;		
	ELSE
		r := &#39;yyy&#39;;
 END CASE;


RETURN r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_event_time_last_eventtype_account_not_closed(izu integer, iideventtype timestamp without time zone, idateevent integer, iidaccount bigint) -->
    <section id="public.function.fun-event-time-last-eventtype-account-not-closed-izu-integer-iideventtype-timestamp-without-time-zone-idateevent-integer-iidaccount-bigint"
             xreflabel="publicfun_event_time_last_eventtype_account_not_closed(izu integer, iideventtype timestamp without time zone, idateevent integer, iidaccount bigint)">
      <title id="public.function.fun-event-time-last-eventtype-account-not-closed-izu-integer-iideventtype-timestamp-without-time-zone-idateevent-integer-iidaccount-bigint-title">
       fun_event_time_last_eventtype_account_not_closed(izu integer, iideventtype timestamp without time zone, idateevent integer, iidaccount bigint)
      </title>
      <titleabbrev id="public.function.fun-event-time-last-eventtype-account-not-closed-izu-integer-iideventtype-timestamp-without-time-zone-idateevent-integer-iidaccount-bigint-titleabbrev">
       fun_event_time_last_eventtype_account_not_closed(izu integer, iideventtype timestamp without time zone, idateevent integer, iidaccount bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

-- Tiempo en minutos
itime integer default -1; 
ilastdateevent timestamp without time zone DEFAULT now();

BEGIN
RAISE NOTICE &#39;1) Inicia fun_event_time_last_eventtype_account_not_closed&#39;;
RAISE NOTICE &#39;2) Datos iideventtype % / iidaccount % / izu %&#39;, iideventtype::text, iidaccount::text, izu::text;


--dateevent timestamp without time zone DEFAULT now()
ilastdateevent := COALESCE((SELECT dateevent FROM events WHERE ideventtype = iideventtype AND idaccount = iidaccount AND zu = izu AND status IN(0, 4, 5) ORDER BY idevent DESC LIMIT 1), &#39;2099-01-01 00:00&#39;::timestamp without time zone);

RAISE NOTICE &#39;ilastdateevent(%)&#39;, ilastdateevent;
RAISE NOTICE &#39;idateevent(%)&#39;, idateevent;
RAISE NOTICE &#39;seg(%)&#39;, EXTRACT(epoch FROM age(ilastdateevent, idateevent));

itime := (EXTRACT(epoch FROM age(idateevent, ilastdateevent))/60)::INTEGER;


RETURN itime;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_expired_session() -->
    <section id="public.function.fun-expired-session"
             xreflabel="publicfun_expired_session()">
      <title id="public.function.fun-expired-session-title">
       fun_expired_session()
      </title>
      <titleabbrev id="public.function.fun-expired-session-titleabbrev">
       fun_expired_session()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR SELECT * FROM (SELECT idadmin, admin_sessionid, (extract(epoch from age(now(), last_heartbeat))/60) AS minutes_event from admins WHERE enabled = true AND admin_sessionid IS NOT NULL) s WHERE minutes_event &gt; 2;
    cursor1_row RECORD;

BEGIN

    FOR cursor1_row IN cursor1 LOOP
	PERFORM fun_logout(cursor1_row.idadmin, cursor1_row.admin_sessionid);
	fun_return := fun_return+1;
    END LOOP;
   

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_event_insert_jobs(ofun_msg bigint, ofun_return timestamp with time zone, ijob_next_run bigint, ijob_run_duration integer, ijob_date_create integer, ijob_description bigint, ijob_enabled text, ijob_name boolean, izu text, job_current_execution_status timestamp with time zone, last_run_outcome integer, iidaccount timestamp with time zone) -->
    <section id="public.function.fun-farma-event-insert-jobs-ofun-msg-bigint-ofun-return-timestamp-with-time-zone-ijob-next-run-bigint-ijob-run-duration-integer-ijob-date-create-integer-ijob-description-bigint-ijob-enabled-text-ijob-name-boolean-izu-text-job-current-execution-status-timestamp-with-time-zone-last-run-outcome-integer-iidaccount-timestamp-with-time-zone"
             xreflabel="publicfun_farma_event_insert_jobs(ofun_msg bigint, ofun_return timestamp with time zone, ijob_next_run bigint, ijob_run_duration integer, ijob_date_create integer, ijob_description bigint, ijob_enabled text, ijob_name boolean, izu text, job_current_execution_status timestamp with time zone, last_run_outcome integer, iidaccount timestamp with time zone)">
      <title id="public.function.fun-farma-event-insert-jobs-ofun-msg-bigint-ofun-return-timestamp-with-time-zone-ijob-next-run-bigint-ijob-run-duration-integer-ijob-date-create-integer-ijob-description-bigint-ijob-enabled-text-ijob-name-boolean-izu-text-job-current-execution-status-timestamp-with-time-zone-last-run-outcome-integer-iidaccount-timestamp-with-time-zone-title">
       fun_farma_event_insert_jobs(ofun_msg bigint, ofun_return timestamp with time zone, ijob_next_run bigint, ijob_run_duration integer, ijob_date_create integer, ijob_description bigint, ijob_enabled text, ijob_name boolean, izu text, job_current_execution_status timestamp with time zone, last_run_outcome integer, iidaccount timestamp with time zone)
      </title>
      <titleabbrev id="public.function.fun-farma-event-insert-jobs-ofun-msg-bigint-ofun-return-timestamp-with-time-zone-ijob-next-run-bigint-ijob-run-duration-integer-ijob-date-create-integer-ijob-description-bigint-ijob-enabled-text-ijob-name-boolean-izu-text-job-current-execution-status-timestamp-with-time-zone-last-run-outcome-integer-iidaccount-timestamp-with-time-zone-titleabbrev">
       fun_farma_event_insert_jobs(ofun_msg bigint, ofun_return timestamp with time zone, ijob_next_run bigint, ijob_run_duration integer, ijob_date_create integer, ijob_description bigint, ijob_enabled text, ijob_name boolean, izu text, job_current_execution_status timestamp with time zone, last_run_outcome integer, iidaccount timestamp with time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

row_network_device view_account_network_devices%ROWTYPE;
descrip TEXT DEFAULT &#39;&#39;;
descrip_current_status TEXT DEFAULT &#39;&#39;;
iideventtype_current_status BIGINT DEFAULT -1;
iideventtype_last_run_outcome BIGINT DEFAULT -1;

BEGIN

SELECT * INTO row_network_device FROM view_account_network_devices WHERE idequipment = iidequipment;

--descrip := &#39;&lt;b&gt;Equipo:&lt;/b&gt; &#39;||row_network_device.equipment||&#39;&lt;/br&gt; &lt;b&gt;IP:&lt;/b&gt; &#39;||row_network_device.ip::TEXT||&#39;&lt;/br&gt; &#39;|| &#39;&lt;b&gt;JOB: &#39;||ijob_name||&#39;&lt;/b&gt; &lt;/br&gt; &lt;b&gt;Description:&lt;/b&gt; &#39;||ijob_description||&#39;&lt;/br&gt; &lt;b&gt;Next Run:&lt;/b&gt; &#39;||ijob_next_run::TEXT||&#39;&lt;/br&gt;&#39;;
--descrip_current_status := equip;
descrip := &#39;&lt;b&gt;JOB: &#39;||ijob_name||&#39;&lt;/b&gt; &lt;/br&gt; &lt;b&gt;Description:&lt;/b&gt; &#39;||ijob_description;


CASE

WHEN job_current_execution_status = 0 THEN
iideventtype_current_status := 67;
descrip_current_status := descrip||&#39; [Are not idle or suspended]&#39;;

WHEN job_current_execution_status = 1 THEN
iideventtype_current_status := 69;
descrip_current_status := descrip||&#39; [Executing]&#39;;

WHEN job_current_execution_status = 2 THEN
iideventtype_current_status := 70;
descrip_current_status := descrip||&#39; [Waiting for thread]&#39;;

WHEN job_current_execution_status = 3 THEN
iideventtype_current_status := 71;
descrip_current_status := descrip||&#39; [Between retries]&#39;;

WHEN job_current_execution_status = 4 THEN
iideventtype_current_status := 72;
descrip_current_status := descrip||&#39; [Idle]&#39;;

WHEN job_current_execution_status = 5 THEN
iideventtype_current_status := 73;
descrip_current_status := descrip||&#39; [Suspended]&#39;;

WHEN job_current_execution_status = 7 THEN
iideventtype_current_status := 74;
descrip_current_status := descrip||&#39; [Performing completion actions]&#39;;


ELSE
iideventtype_current_status := 75;
descrip_current_status := descrip||&#39; [???]&#39;;
END CASE;

BEGIN
-- Inserta el estado actual del JOB
INSERT INTO events(ideventtype, description, idaccount, zu, idequipment) VALUES (iideventtype_current_status, descrip_current_status, iidaccount, izu, iidequipment);

  EXCEPTION WHEN unique_violation THEN
            -- do nothing, and loop to try the UPDATE again


END;

--descrip := &#39;&lt;b&gt;Equipo:&lt;/b&gt; &#39;||row_network_device.equipment||&#39;&lt;/br&gt; &lt;b&gt;IP:&lt;/b&gt; &#39;||row_network_device.ip::TEXT||&#39;&lt;/br&gt; &#39;|| &#39;&lt;b&gt;JOB: &#39;||ijob_name||&#39;&lt;/b&gt;  &lt;/br&gt; &lt;b&gt;Description:&lt;/b&gt; &#39;||ijob_description||&#39;&lt;/br&gt; &lt;b&gt;Next Run:&lt;/b&gt; &#39;||ijob_next_run::TEXT||&#39;&lt;/br&gt;&#39;;
descrip := &#39;&lt;b&gt;JOB: &#39;||ijob_name||&#39;&lt;/b&gt;  &lt;/br&gt; &lt;b&gt;Description:&lt;/b&gt; &#39;||ijob_description;

CASE

WHEN last_run_outcome = 0 THEN
iideventtype_last_run_outcome := 29;
descrip := descrip||&#39; &lt;b&gt;[Failed]&lt;/b&gt;&#39;;

WHEN last_run_outcome = 1 THEN
iideventtype_last_run_outcome := 30;
descrip := descrip||&#39; &lt;b&gt;[Succeeded]&lt;/b&gt;&#39;;

WHEN last_run_outcome = 3 THEN
iideventtype_last_run_outcome := 31;
descrip := descrip||&#39; &lt;b&gt;[Canceled]&lt;/b&gt;&#39;;

WHEN last_run_outcome = 5 THEN
iideventtype_last_run_outcome := 32;
descrip := descrip||&#39; &lt;b&gt;[Unknown]&lt;/b&gt;&#39;;


ELSE
iideventtype_last_run_outcome := 0;
descrip := descrip||&#39; &lt;b&gt;[???]&lt;/b&gt;&#39;;

END CASE;



/*
switch($row[&quot;last_run_outcome&quot;]){

	case 0:
		$ideventtype = 29;
		$description_event = $description_event.&quot; &lt;b&gt;[Failed]&lt;/b&gt; &quot;;
		$jobs_fail++;
	break;
	case 1:
		$ideventtype = 30;
		$description_event = $description_event.&quot; [Succeeded] &quot;;
	break;
	case 3:
		$ideventtype = 31;
		$description_event = $description_event.&quot; [Canceled] &quot;;
	break;
	case 5:
		$ideventtype = 32;
		$description_event = $description_event.&quot; [Unknown] &quot;;
	break;
	default:
		$ideventtype = 0;
		$description_event = $description_event.&quot; [???] &quot;;
	break;
}
*/

BEGIN

INSERT INTO events_jobs(
            dateevent, ideventtype, description, idaccount, idequipment,
            zu, job_name, job_enabled, job_description, job_date_create, 
            job_run_duration, job_run_status, job_next_run)
    VALUES (idateevent, iideventtype_last_run_outcome, descrip, iidaccount, iidequipment,
            izu, ijob_name, ijob_enabled, ijob_description, ijob_date_create, 
            ijob_run_duration, last_run_outcome, ijob_next_run);


  EXCEPTION WHEN unique_violation THEN
            -- do nothing, and loop to try the UPDATE again
            END;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_event_insert_lista_precios(icantidad_productos text, ilista_activa text, ilista_principal text, ioficina integer) -->
    <section id="public.function.fun-farma-event-insert-lista-precios-icantidad-productos-text-ilista-activa-text-ilista-principal-text-ioficina-integer"
             xreflabel="publicfun_farma_event_insert_lista_precios(icantidad_productos text, ilista_activa text, ilista_principal text, ioficina integer)">
      <title id="public.function.fun-farma-event-insert-lista-precios-icantidad-productos-text-ilista-activa-text-ilista-principal-text-ioficina-integer-title">
       fun_farma_event_insert_lista_precios(icantidad_productos text, ilista_activa text, ilista_principal text, ioficina integer)
      </title>
      <titleabbrev id="public.function.fun-farma-event-insert-lista-precios-icantidad-productos-text-ilista-activa-text-ilista-principal-text-ioficina-integer-titleabbrev">
       fun_farma_event_insert_lista_precios(icantidad_productos text, ilista_activa text, ilista_principal text, ioficina integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE  

Retorno boolean DEFAULT false;
iideventtype INTEGER DEFAULT 0;
idescription TEXT DEFAULT &#39;----&#39;;
iidaccount INTEGER DEFAULT 0;
temp_descrip TEXT DEFAULT &#39;-----&#39;;

BEGIN

iidaccount := fun_get_idaccount_by_account(ioficina, 1);

-- Revisa si la lista de precios es 0
IF icantidad_productos &lt; 100 THEN
iideventtype := 54;
idescription := &#39;La lista de precios activa: &lt;b&gt;&#39;||ilista_activa||&#39;&lt;/b&gt; tiene  &lt;b&gt;&#39;||icantidad_productos::TEXT||&#39;&lt;/b&gt; productos.&#39;;
PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, iidaccount, 0, 0, iideventtype, idescription, 0);
END IF;

-- Revisa si la lista activa es igual a la lista principal
IF ilista_principal != ilista_activa THEN
iideventtype := 57;
idescription := &#39;La lista principal &lt;b&gt;[&#39;||ilista_principal||&#39;]&lt;/b&gt; no es igual a la lista activa &lt;b&gt;[&#39;||ilista_activa||&#39;]&lt;/b&gt;&#39;;
PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, iidaccount, 0, 0, iideventtype, idescription, 0);
END IF;


-- Revisa si la lista activa de productos ha cambiado
iideventtype := 55;
idescription := &#39;La lista activa de productos a cambiado a &lt;b&gt;&#39;||ilista_activa||&#39;&lt;/b&gt;&#39;;
--SELECT description INTO temp_descrip FROM events WHERE ideventtype = iideventtype AND idaccount = iidaccount ORDER BY idevent DESC LIMIT 1;
temp_descrip:= COALESCE((SELECT description FROM events WHERE ideventtype = iideventtype AND idaccount = iidaccount ORDER BY idevent DESC LIMIT 1), &#39;&#39;);
IF idescription != temp_descrip THEN
PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, iidaccount, 0, 0, iideventtype, idescription, 0);
END IF;

-- Revisa si la lista principal ha cambiado
iideventtype := 56;
idescription := &#39;La lista principal de productos a cambiado a &lt;b&gt;&#39;||ilista_principal||&#39;&lt;/b&gt;&#39;;
temp_descrip:= COALESCE((SELECT description FROM events WHERE ideventtype = iideventtype AND idaccount = iidaccount ORDER BY idevent DESC LIMIT 1), &#39;&#39;);
--SELECT description INTO temp_descrip FROM events WHERE ideventtype = iideventtype AND idaccount = iidaccount ORDER BY idevent DESC LIMIT 1;
IF idescription != temp_descrip THEN
PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, iidaccount, 0, 0, iideventtype, idescription, 0);
END IF;



RETURN Retorno; 
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_event_insert_sqlserver_uptime(iuptime bigint, iidequipment integer) -->
    <section id="public.function.fun-farma-event-insert-sqlserver-uptime-iuptime-bigint-iidequipment-integer"
             xreflabel="publicfun_farma_event_insert_sqlserver_uptime(iuptime bigint, iidequipment integer)">
      <title id="public.function.fun-farma-event-insert-sqlserver-uptime-iuptime-bigint-iidequipment-integer-title">
       fun_farma_event_insert_sqlserver_uptime(iuptime bigint, iidequipment integer)
      </title>
      <titleabbrev id="public.function.fun-farma-event-insert-sqlserver-uptime-iuptime-bigint-iidequipment-integer-titleabbrev">
       fun_farma_event_insert_sqlserver_uptime(iuptime bigint, iidequipment integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>bigint</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--R INTEGER DEFAULT 0;
--last_uptime REAL DEFAULT -100.1;
limit_uptime REAL DEFAULT 14; 
iideventtype BIGINT DEFAULT 0;
idescrip TEXT DEFAULT &#39;&#39;;
days_uptime REAL DEFAULT -1.1;


BEGIN

--last_uptime := COALESCE((SELECT uptime FROM events_device_uptime WHERE idequipment = iidequipment ORDER BY idevent DESC LIMIT 1), -1);

days_uptime := round((iuptime / 1440.0), 1);

--idescrip :=  &#39;&lt;b&gt;Servidor encendido&lt;/b&gt;  desde hace &lt;b&gt;&#39;||iuptime::text||&#39; minutos. o sea &#39;||days_uptime::text||&#39; dias&lt;/b&gt; &#39;;
idescrip :=  &#39;&lt;b&gt;Servidor encendido&lt;/b&gt;  desde hace &lt;b&gt;&#39;||days_uptime::text||&#39; das&lt;/b&gt; &#39;;

CASE 

WHEN days_uptime &gt;= limit_uptime THEN
iideventtype := 59;

--WHEN days_uptime &lt; 1 THEN
--iideventtype := 87;


WHEN days_uptime &lt; limit_uptime THEN
iideventtype := 58;



ELSE

END CASE;



--IF (last_uptime != days_uptime) AND iideventtype &gt; 0 THEN
IF iideventtype &gt; 0 THEN
INSERT INTO events_device_uptime(
            ideventtype, description, idequipment, uptime)
    VALUES (iideventtype, idescrip, iidequipment, days_uptime);
END IF;

--END IF;

RETURN iidequipment;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_event_insert_statusdb_account(ofun_msg bigint, ofun_return bigint, idblogsize text, idbfilesize bigint, istate_des integer, istatus text, izu real, inamedb real) -->
    <section id="public.function.fun-farma-event-insert-statusdb-account-ofun-msg-bigint-ofun-return-bigint-idblogsize-text-idbfilesize-bigint-istate-des-integer-istatus-text-izu-real-inamedb-real"
             xreflabel="publicfun_farma_event_insert_statusdb_account(ofun_msg bigint, ofun_return bigint, idblogsize text, idbfilesize bigint, istate_des integer, istatus text, izu real, inamedb real)">
      <title id="public.function.fun-farma-event-insert-statusdb-account-ofun-msg-bigint-ofun-return-bigint-idblogsize-text-idbfilesize-bigint-istate-des-integer-istatus-text-izu-real-inamedb-real-title">
       fun_farma_event_insert_statusdb_account(ofun_msg bigint, ofun_return bigint, idblogsize text, idbfilesize bigint, istate_des integer, istatus text, izu real, inamedb real)
      </title>
      <titleabbrev id="public.function.fun-farma-event-insert-statusdb-account-ofun-msg-bigint-ofun-return-bigint-idblogsize-text-idbfilesize-bigint-istate-des-integer-istatus-text-izu-real-inamedb-real-titleabbrev">
       fun_farma_event_insert_statusdb_account(ofun_msg bigint, ofun_return bigint, idblogsize text, idbfilesize bigint, istate_des integer, istatus text, izu real, inamedb real)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--iidaccount INTEGER DEFAULT 1;
iideventtype INTEGER DEFAULT 0;
--idescrip_logsize TEXT DEFAULT &#39;&#39;;
--idescrip_dbsize TEXT DEFAULT &#39;&#39;;
idescrip TEXT DEFAULT &#39;&#39;;
--duplicado BOOLEAN DEFAULT FALSE;
max_size_log INTEGER DEFAULT 2000;
max_size_db INTEGER DEFAULT 15000;
row_network_device view_account_network_devices%ROWTYPE;
equip TEXT DEFAULT &#39;&#39;;

BEGIN

 SELECT * INTO row_network_device FROM view_account_network_devices WHERE idequipment = iidequipment;

equip := &#39;&#39;;



-- // BLOQUE DE ESTADOS //--
idescrip  := equip||&#39;&lt;b&gt;Data Base:&lt;/b&gt; &#39;||inamedb||&#39;&lt;/br&gt;&lt;b&gt; Status:&lt;/b&gt; &#39;||istate_des;
CASE

WHEN istatus = 0 THEN
-- ONLINE 
iideventtype := 34;

WHEN istatus = 1 THEN
-- RESTORING 
iideventtype := 35;

WHEN istatus = 2 THEN
-- RECOVERING
iideventtype := 36;

WHEN istatus = 3 THEN
-- RECOVERING PENDING
iideventtype := 38;

WHEN istatus = 4 THEN
-- SUSPECT
iideventtype := 33;

WHEN istatus = 5 THEN
-- EMERGENCY
iideventtype := 44;

WHEN istatus = 6 THEN
-- OFFLINE
iideventtype := 45;

WHEN istatus = 7 THEN
-- COPYING
iideventtype := 46;

ELSE

END CASE;



INSERT INTO events(
            ideventtype, description, idaccount, zu)
    VALUES (iideventtype, idescrip, iidaccount, izu);




-- // BLOQUE DE TAMAO LOGS //--
-- limite establecido para los logs
IF idblogsize &gt; max_size_log THEN
iideventtype := 47;
idescrip  := equip||&#39;&lt;b&gt;Data Base:&lt;/b&gt; &#39;||inamedb||&#39;&lt;/br&gt;&lt;b&gt; Log Size:&lt;/b&gt; &#39;||idblogsize::text||&#39; MB &lt;/br&gt;Exceeds the maximum size set to &#39;||max_size_log||&#39; MB&#39;;
ELSE
iideventtype := 61;
idescrip  := equip||&#39;&lt;b&gt;Data Base:&lt;/b&gt; &#39;||inamedb||&#39;&lt;/br&gt;&lt;b&gt; Log Size:&lt;/b&gt; &#39;||idblogsize::text||&#39; MB&#39;;
END IF;


INSERT INTO events_dbsizes(
            ideventtype, description, idaccount, zu,
            db_name, db_size, db_type)
    VALUES (iideventtype, idescrip, iidaccount, izu,
            inamedb, idblogsize, 1);








IF idbfilesize &gt; max_size_db THEN
iideventtype := 48;
idescrip  := equip||&#39;&lt;b&gt;Data Base:&lt;/b&gt; &#39;||inamedb||&#39;&lt;/br&gt;&lt;b&gt; Size:&lt;/b&gt; &#39;||idbfilesize::text||&#39; MB &lt;/br&gt;Exceeds the maximum size set to &#39;||max_size_db||&#39; MB&#39;;
ELSE
iideventtype := 60;
idescrip  := equip||&#39;&lt;b&gt;Data Base:&lt;/b&gt; &#39;||inamedb||&#39;&lt;/br&gt;&lt;b&gt; Size:&lt;/b&gt; &#39;||idbfilesize::text||&#39; MB&#39;;
END IF;


INSERT INTO events_dbsizes(
            ideventtype, description, idaccount, zu,
            db_name, db_size, db_type)
    VALUES (iideventtype, idescrip, iidaccount, izu,
            inamedb, idbfilesize, 0);





RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text) -->
    <section id="public.function.fun-farma-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text"
             xreflabel="publicfun_farma_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)">
      <title id="public.function.fun-farma-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text-title">
       fun_farma_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text-titleabbrev">
       fun_farma_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE
id BIGINT DEFAULT 0;
ienabled BOOLEAN DEFAULT TRUE;
idldf INTEGER DEFAULT 0;
ifirst_name text default &#39;&#39;;
iidaccounttype INTEGER DEFAULT 0;

ifname text default &#39;&#39;;
ilname text default &#39;&#39;;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;
id := fun_get_idaccount_by_account(iaccount, 1);
idldf := COALESCE((SELECT idcontact FROM contacts WHERE identification = cedula_sup_operativo LIMIT 1), 0);

CASE
WHEN position(&#39;MEDI &#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 6 for 100);
ilname := &#39;MEDI&#39;;

WHEN position(&#39;ECO &#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 5 for 100);
ilname := &#39;ECO&#39;;

WHEN position(&#39;PAF &#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 5 for 100);
ilname := &#39;PAF&#39;;

ELSE

ifname := &#39; *&#39;;
ilname := ilast_name;

END CASE;

IF istatus != &#39;A&#39; THEN
ienabled := FALSE;
END IF;

IF franquicia = &#39;N&#39; THEN
iidaccounttype := 3;
ELSE
iidaccounttype := 4;
END IF;

RAISE NOTICE &#39;Account (%) con ID (%)&#39;, iaccount, id;

-- Para este caso ilast_name se lo utiliza como nombre y * como apellido

CASE

	WHEN id &lt;= 1 THEN
	BEGIN

-- Verificamos que no se repita el abonado
	iaccount := fun_account_auto_account(iaccount);

-- Ingresamos un nuevo registro
INSERT INTO accounts(
            enabled, first_name, last_name, birthday, identification, 
            address, address_ref, 
            start_date, end_date, account, idaccounttype, iddivision)
    VALUES (ienabled,  ilname, ifname, istart_date, iaccount, 
            iaddress, iaddress_ref, 
            istart_date, iend_date, iaccount, iidaccounttype, 1)
 RETURNING idcontact INTO fun_return;
fun_msg := &#39;Nuevo registro insertado&#39;;

IF fun_return &gt; 0 THEN

PERFORM fun_farma_import_accounts_insertphone(fun_return, telf1);
PERFORM fun_farma_import_accounts_insertphone(fun_return, telf2);
PERFORM fun_farma_import_accounts_insertemail(fun_return, iemail);

DELETE FROM account_contacts WHERE appointment = &#39;Farma_LDF&#39; AND idaccount = fun_return;
IF idldf &gt; 0 THEN
INSERT INTO account_contacts (idaccount, idcontact, appointment, priority) VALUES (fun_return, idldf, &#39;Farma_LDF&#39;, 2);
END IF;

END IF;

fun_msg := fun_return;

EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -2;
 fun_msg := &#39;Registro tiene campos que deben ser unicos&#39;||iaccount||&#39; &#39;||ilast_name||&#39; &#39;||iaccount;
END;


	WHEN id &gt; 1  THEN
BEGIN	
-- Actualizamos
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar cuenta&#39;, iaccount, id;
UPDATE accounts
   SET iddivision = 1, first_name=ifname, last_name=ilname, birthday=istart_date, 
       identification=iaccount, address=iaddress, address_ref=iaddress_ref, start_date=istart_date, end_date=iend_date, account=iaccount, idaccounttype = iidaccounttype
 WHERE idcontact = id;
 fun_return := id;
 fun_msg := &#39;Registro Actualizado&#39;;
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar telefonos&#39;, iaccount, id;

PERFORM fun_farma_import_accounts_insertphone(id, telf1);
PERFORM fun_farma_import_accounts_insertphone(id, telf2);
PERFORM fun_farma_import_accounts_insertemail(id, iemail);

RAISE NOTICE &#39;Account (%) con ID (%) para actualizar - Eliminamos el LDF&#39;, iaccount, id;
DELETE FROM account_contacts WHERE appointment = &#39;Farma_LDF&#39; AND idaccount = id;

RAISE NOTICE &#39;Account (%) con ID (%) para actualizar ldf&#39;, iaccount, id;
IF idldf &gt; 0 THEN
INSERT INTO account_contacts (idaccount, idcontact, appointment, priority) VALUES (id, idldf, &#39;Farma_LDF&#39;, 2);
END IF;

/*
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar datos del servidor (% =&gt; %)&#39;, iaccount, id, idb_user, idb_pwd;
-- Actualizamos los datos del servidor
UPDATE network_devices
   SET username=idb_user, pwd=idb_pwd WHERE idaccount=id AND equipment=&#39;Server&#39; AND mark=&#39;Farma01&#39;;
        IF NOT found THEN

IF id &gt; 0 THEN
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar / Datos del servidor no encontrados, se inserta.&#39;, iaccount, id;        
INSERT INTO network_devices(
            equipment, mark, description, 
            username, pwd, idaccount)
    VALUES (&#39;Server&#39;, &#39;Farma01&#39;, &#39;Servidor de farmacia Nueva &#39;||id::text, 
            idb_user, idb_pwd, fun_return);
END IF;
        END IF;
*/
 /*
-- Actualizamos los datos del gateway
UPDATE network_devices
   SET note = &#39;No modificar esta nota&#39; WHERE idaccount=fun_return AND equipment=&#39;Gateway&#39;;
        IF NOT found THEN
IF fun_return &gt; 0 THEN
INSERT INTO network_devices(
            equipment, description, idaccount, note)
    VALUES (&#39;Gateway&#39;, &#39;Gateway de farmacia &#39;||fun_return::text, 
            fun_return, &#39;No modificar o borrar esta nota&#39;);
END IF;
        END IF;
*/

fun_msg := id;

 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -3;
 fun_msg := &#39;Registro tiene campos que deben ser unicos id=&#39;||id::TEXT||&#39; &#39;||iaccount||&#39; &#39;||ilast_name||;
 
END;




	WHEN id &lt; 0  THEN
-- Eliminamos
/*DELETE FROM accounts
 WHERE idcontact=id;
 fun_return := 0;
 fun_msg := &#39;Registro Eliminado&#39;;*/

ELSE

 END CASE;


RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_accounts_insertemail(iemail bigint, iidcontact text) -->
    <section id="public.function.fun-farma-import-accounts-insertemail-iemail-bigint-iidcontact-text"
             xreflabel="publicfun_farma_import_accounts_insertemail(iemail bigint, iidcontact text)">
      <title id="public.function.fun-farma-import-accounts-insertemail-iemail-bigint-iidcontact-text-title">
       fun_farma_import_accounts_insertemail(iemail bigint, iidcontact text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-accounts-insertemail-iemail-bigint-iidcontact-text-titleabbrev">
       fun_farma_import_accounts_insertemail(iemail bigint, iidcontact text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN

INSERT INTO emails (idcontact, email) VALUES (iidcontact, iemail);
RETURN true;
 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 --fun_msg := &#39;El numero &#39;||inumber::TEXT||&#39; ya existe para el contacto &#39;||idcontact::text;

RETURN false;
END;
</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_accounts_insertphone(inumber bigint, iidcontact text) -->
    <section id="public.function.fun-farma-import-accounts-insertphone-inumber-bigint-iidcontact-text"
             xreflabel="publicfun_farma_import_accounts_insertphone(inumber bigint, iidcontact text)">
      <title id="public.function.fun-farma-import-accounts-insertphone-inumber-bigint-iidcontact-text-title">
       fun_farma_import_accounts_insertphone(inumber bigint, iidcontact text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-accounts-insertphone-inumber-bigint-iidcontact-text-titleabbrev">
       fun_farma_import_accounts_insertphone(inumber bigint, iidcontact text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       Funcion de apoyo para importar datos de telefonos de la cuenta
        <programlisting>BEGIN

INSERT INTO phones (idcontact, number) VALUES (iidcontact, inumber);
return true;
 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 --fun_msg := &#39;El numero &#39;||inumber::TEXT||&#39; ya existe para el contacto &#39;||idcontact::text;

RETURN false;
END;
</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_asig_personal_farma(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text) -->
    <section id="public.function.fun-farma-import-asig-personal-farma-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text"
             xreflabel="publicfun_farma_import_asig_personal_farma(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)">
      <title id="public.function.fun-farma-import-asig-personal-farma-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text-title">
       fun_farma_import_asig_personal_farma(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-asig-personal-farma-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text-titleabbrev">
       fun_farma_import_asig_personal_farma(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

iidaccount INTEGER;
iidcontact INTEGER;
ipriority INTEGER DEFAULT 5;


BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;


-- Buscamos el idcontact segun la cedula
SELECT idcontact INTO iidcontact FROM contacts WHERE identification = cedula;

IF perfil_referencia LIKE &#39;PVAdm%&#39; THEN
ipriority := 3;
END IF;


-- Buscamos el idaccount segun la oficina
--iidaccount := fun_get_idaccount_by_account(oficina);
--iidaccount := fun_get_idaccount_by_account(oficina, 1);
iidaccount := fun_get_idaccount_by_account(oficina, 1);

IF iidaccount IS NOT NULL AND iidcontact IS NOT NULL THEN

INSERT INTO account_users(
            idaccount, idcontact, appointment, note, account_user, account_pwd, date_end, enabled, priority)
    VALUES (iidaccount, iidcontact, &#39;farma_&#39;||perfil_referencia::TEXT, &#39;Usuario asignado por Farmaenlace, no modificar el appointment&#39;, nombrecorto, pwd, &#39;2050-01-01 00:00&#39;, estado, ipriority) RETURNING idaccountuser INTO fun_return;

 fun_msg := &#39;Registro insertado&#39;;
ELSE

fun_return := -1;
 fun_msg := &#39;El registro no pudo ser insertado, idaccount e idcontact no pueden ser nulos&#39;;
END IF;


 



RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_nomina(fun_msg text, fun_return text, iemail timestamp without time zone, itelf2 text, itelf1 integer, iaddress_ref text, iaddress text, inote text, igender text, iidentification text, ibirthday text) -->
    <section id="public.function.fun-farma-import-nomina-fun-msg-text-fun-return-text-iemail-timestamp-without-time-zone-itelf2-text-itelf1-integer-iaddress-ref-text-iaddress-text-inote-text-igender-text-iidentification-text-ibirthday-text"
             xreflabel="publicfun_farma_import_nomina(fun_msg text, fun_return text, iemail timestamp without time zone, itelf2 text, itelf1 integer, iaddress_ref text, iaddress text, inote text, igender text, iidentification text, ibirthday text)">
      <title id="public.function.fun-farma-import-nomina-fun-msg-text-fun-return-text-iemail-timestamp-without-time-zone-itelf2-text-itelf1-integer-iaddress-ref-text-iaddress-text-inote-text-igender-text-iidentification-text-ibirthday-text-title">
       fun_farma_import_nomina(fun_msg text, fun_return text, iemail timestamp without time zone, itelf2 text, itelf1 integer, iaddress_ref text, iaddress text, inote text, igender text, iidentification text, ibirthday text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-nomina-fun-msg-text-fun-return-text-iemail-timestamp-without-time-zone-itelf2-text-itelf1-integer-iaddress-ref-text-iaddress-text-inote-text-igender-text-iidentification-text-ibirthday-text-titleabbrev">
       fun_farma_import_nomina(fun_msg text, fun_return text, iemail timestamp without time zone, itelf2 text, itelf1 integer, iaddress_ref text, iaddress text, inote text, igender text, iidentification text, ibirthday text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE


BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

UPDATE contacts
   SET first_name=ifirst_name, last_name=ilast_name, birthday=ibirthday, 
       gender=igender, note=inote, address=iaddress, address_ref=iaddress_ref WHERE identification=iidentification;

fun_return := 999;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
INSERT INTO contacts(
            first_name, last_name, birthday, identification, 
            gender,  note, address, address_ref)
    VALUES (ifirst_name, ilast_name, ibirthday, iidentification, 
            igender,  inote, iaddress, iaddress_ref) RETURNING idcontact INTO fun_return;
--fun_return := -100;
fun_msg := &#39;Nuevo registro insertado&#39;;
ELSE

fun_return := (SELECT idcontact FROM contacts WHERE identification=iidentification AND first_name=ifirst_name AND last_name=ilast_name LIMIT 1);

        END IF;

PERFORM fun_farma_import_nomina_telf(fun_return, itelf1);
PERFORM fun_farma_import_nomina_telf(fun_return, itelf2);
PERFORM fun_farma_import_nomina_email(fun_return, iemail);
 
 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -3;
 fun_msg := &#39;Registro tiene campos que deben ser unicos id=&#39;||iidentification::TEXT;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_nomina_email(fun_msg integer, fun_return text) -->
    <section id="public.function.fun-farma-import-nomina-email-fun-msg-integer-fun-return-text"
             xreflabel="publicfun_farma_import_nomina_email(fun_msg integer, fun_return text)">
      <title id="public.function.fun-farma-import-nomina-email-fun-msg-integer-fun-return-text-title">
       fun_farma_import_nomina_email(fun_msg integer, fun_return text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-nomina-email-fun-msg-integer-fun-return-text-titleabbrev">
       fun_farma_import_nomina_email(fun_msg integer, fun_return text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

iidemail INTEGER DEFAULT 0;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

SELECT idemail INTO iidemail FROM emails WHERE email = iemail;

-- 
UPDATE emails
   SET idcontact=iidcontact WHERE idemail = iidemail;

fun_return := 999;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
INSERT INTO emails(
            idcontact, email)
    VALUES (iidcontact, iemail) RETURNING idemail INTO fun_return;
--fun_return := -100;
fun_msg := &#39;Nuevo registro insertado&#39;;
        END IF;
 

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_nomina_telf(fun_msg integer, fun_return text) -->
    <section id="public.function.fun-farma-import-nomina-telf-fun-msg-integer-fun-return-text"
             xreflabel="publicfun_farma_import_nomina_telf(fun_msg integer, fun_return text)">
      <title id="public.function.fun-farma-import-nomina-telf-fun-msg-integer-fun-return-text-title">
       fun_farma_import_nomina_telf(fun_msg integer, fun_return text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-nomina-telf-fun-msg-integer-fun-return-text-titleabbrev">
       fun_farma_import_nomina_telf(fun_msg integer, fun_return text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

iidphone INTEGER DEFAULT 0;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

SELECT idphone INTO iidphone FROM phones WHERE &quot;number&quot; = itelf;

-- 
UPDATE phones
   SET idcontact=iidcontact WHERE idphone = iidphone;

fun_return := 999;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
INSERT INTO phones(
            idcontact, &quot;number&quot;)
    VALUES (iidcontact, itelf) RETURNING idphone INTO fun_return;
--fun_return := -100;
fun_msg := &#39;Nuevo registro insertado&#39;;
        END IF;
 

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_tec(fun_msg text, fun_return text, itype text, iidentification text) -->
    <section id="public.function.fun-farma-import-tec-fun-msg-text-fun-return-text-itype-text-iidentification-text"
             xreflabel="publicfun_farma_import_tec(fun_msg text, fun_return text, itype text, iidentification text)">
      <title id="public.function.fun-farma-import-tec-fun-msg-text-fun-return-text-itype-text-iidentification-text-title">
       fun_farma_import_tec(fun_msg text, fun_return text, itype text, iidentification text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-tec-fun-msg-text-fun-return-text-itype-text-iidentification-text-titleabbrev">
       fun_farma_import_tec(fun_msg text, fun_return text, itype text, iidentification text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE
--isadmin BOOLEAN DEFAULT false;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

UPDATE contacts SET first_name=ifirst_name, last_name=ilast_name WHERE identification=iidentification;

fun_return := 999;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
INSERT INTO contacts(
            first_name, last_name, identification)
    VALUES (ifirst_name, ilast_name, iidentification) RETURNING idcontact INTO fun_return;
--fun_return := -100;
fun_msg := &#39;Nuevo registro insertado&#39;;
        END IF;
 
 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -3;
 fun_msg := &#39;Registro tiene campos que deben ser unicos id=&#39;||iidentification::TEXT;

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_import_tec_asig(fun_msg text, fun_return text) -->
    <section id="public.function.fun-farma-import-tec-asig-fun-msg-text-fun-return-text"
             xreflabel="publicfun_farma_import_tec_asig(fun_msg text, fun_return text)">
      <title id="public.function.fun-farma-import-tec-asig-fun-msg-text-fun-return-text-title">
       fun_farma_import_tec_asig(fun_msg text, fun_return text)
      </title>
      <titleabbrev id="public.function.fun-farma-import-tec-asig-fun-msg-text-fun-return-text-titleabbrev">
       fun_farma_import_tec_asig(fun_msg text, fun_return text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

idtec INTEGER DEFAULT 0;
idofi INTEGER DEFAULT 0;
iidadmin BIGINT;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

SELECT  idcontact, idadmin INTO idtec, iidadmin  FROM view_admins WHERE identification = iidentification;
SELECT  idcontact INTO idofi FROM accounts WHERE account = ioficina AND iddivision = 1;

IF idtec &gt; 0 AND idofi &gt; 0 THEN

--assigned
--DELETE FROM account_contacts WHERE idaccount = idofi AND appointment = &#39;Tcnico Responsable&#39;;
UPDATE accounts SET admins = array_prepend(iidadmin, admins) WHERE idcontact = idofi;

UPDATE admins SET idaccounts = array(SELECT idcontact FROM accounts WHERE iidadmin = ANY(admins)) WHERE idadmin = iidadmin;


INSERT INTO account_contacts(
            idaccount, idcontact, appointment, priority, 
            note)
    VALUES (idofi, idtec, &#39;Tcnico Responsable&#39;, 1, 
            &#39;Importado desde el servidor 159 [EasyGestionEmpresarial].[dbo].[SP_PAR_AsignacionFarmacias]&#39;) RETURNING idaccountuser INTO fun_return;
 

 --fun_return := -3;
 fun_msg := &#39;Registro insertado&#39;;

END IF;



RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_update_lista_precios_farmacias(fun_msg integer, fun_return text, iprovincia text, i159productos integer, i159activa text, i159principal text, iproductos integer, iactiva text) -->
    <section id="public.function.fun-farma-update-lista-precios-farmacias-fun-msg-integer-fun-return-text-iprovincia-text-i159productos-integer-i159activa-text-i159principal-text-iproductos-integer-iactiva-text"
             xreflabel="publicfun_farma_update_lista_precios_farmacias(fun_msg integer, fun_return text, iprovincia text, i159productos integer, i159activa text, i159principal text, iproductos integer, iactiva text)">
      <title id="public.function.fun-farma-update-lista-precios-farmacias-fun-msg-integer-fun-return-text-iprovincia-text-i159productos-integer-i159activa-text-i159principal-text-iproductos-integer-iactiva-text-title">
       fun_farma_update_lista_precios_farmacias(fun_msg integer, fun_return text, iprovincia text, i159productos integer, i159activa text, i159principal text, iproductos integer, iactiva text)
      </title>
      <titleabbrev id="public.function.fun-farma-update-lista-precios-farmacias-fun-msg-integer-fun-return-text-iprovincia-text-i159productos-integer-i159activa-text-i159principal-text-iproductos-integer-iactiva-text-titleabbrev">
       fun_farma_update_lista_precios_farmacias(fun_msg integer, fun_return text, iprovincia text, i159productos integer, i159activa text, i159principal text, iproductos integer, iactiva text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

istatus TEXT DEFAULT &#39;INDEFINIDO&#39;;
isincro TEXT DEFAULT &#39;INDEFINIDO&#39;;
iip INET;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

IF (iprincipal = iactiva)  AND  iproductos &gt; 0 THEN
istatus := &#39;OK&#39;;
ELSE
istatus := &#39;ERROR&#39;;
END IF;

IF iprincipal = i159principal AND iactiva = i159activa  THEN
--IF EXISTS(SELECT * FROM farma_lista_precios_farmacias WHERE idaccount=iidaccount AND srv159_activa = activa AND productos = srv159_productos AND srv159_principal = principal)  THEN
isincro := &#39;OK&#39;;
ELSE
isincro := &#39;ERROR&#39;;
END IF;

select ip INTO iip from view_account_network_devices where idcontact = iidaccount AND  equipment ILIKE &#39;%SQL%&#39; LIMIT 1;

RAISE NOTICE &#39;(%) (%) &#39;, iprincipal, iactiva;
RAISE NOTICE &#39;(%) (%) &#39;, i159principal, i159activa;


--
UPDATE farma_lista_precios_farmacias
SET principal=iprincipal, 
activa=iactiva, 
productos=iproductos,
srv159_principal=i159principal, 
srv159_activa=i159activa, 
srv159_productos=i159productos, 

status = istatus,
sincronizado = isincro, 
ip = iip::text, 
provincia = iprovincia,
ts_lista_farmacia = now(),   
ts_lista_srv159 = now()
 WHERE idaccount=iidaccount;

RAISE NOTICE &#39;(%) (%) &#39;, iprincipal, iactiva;
RAISE NOTICE &#39;(%) (%) &#39;, i159principal, i159activa;

fun_return := 1;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
/*
INSERT INTO farma_lista_precios_farmacias(
            idaccount, principal, activa, productos, status, sincronizado, ts_lista_farmacia, ip)
    VALUES (iidaccount, iprincipal, iactiva, iproductos, istatus, isincro, now(), iip::text) RETURNING idlista_precios INTO fun_return;
*/
INSERT INTO farma_lista_precios_farmacias(
            idaccount, principal, activa, productos, status, 
            ts, ts_lista_farmacia, srv159_activa, srv159_productos, srv159_principal, 
            ts_lista_srv159, sincronizado, provincia, ip)
    VALUES (iidaccount, iprincipal, iactiva, iproductos, istatus, 
           now(), now(), i159activa, i159productos, i159principal, 
            now(), isincro, iprovincia, iip);
fun_msg := &#39;Nuevo registro insertado&#39;;
        END IF;
 

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_farma_update_lista_precios_srv159(fun_msg text, fun_return text, iproductos text, iactiva integer) -->
    <section id="public.function.fun-farma-update-lista-precios-srv159-fun-msg-text-fun-return-text-iproductos-text-iactiva-integer"
             xreflabel="publicfun_farma_update_lista_precios_srv159(fun_msg text, fun_return text, iproductos text, iactiva integer)">
      <title id="public.function.fun-farma-update-lista-precios-srv159-fun-msg-text-fun-return-text-iproductos-text-iactiva-integer-title">
       fun_farma_update_lista_precios_srv159(fun_msg text, fun_return text, iproductos text, iactiva integer)
      </title>
      <titleabbrev id="public.function.fun-farma-update-lista-precios-srv159-fun-msg-text-fun-return-text-iproductos-text-iactiva-integer-titleabbrev">
       fun_farma_update_lista_precios_srv159(fun_msg text, fun_return text, iproductos text, iactiva integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

istatus TEXT DEFAULT &#39;INDEFINIDO&#39;;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;

IF (iprincipal = iactiva)  AND  iproductos &gt; 0 THEN
istatus := &#39;OK&#39;;
ELSE
istatus := &#39;ERROR&#39;;
END IF;

-- 
UPDATE farma_lista_precios_farmacias
   SET principal=iprincipal, activa=iactiva, productos=iproductos, status = istatus
 WHERE idaccount=iidaccount;

fun_return := 1;
fun_msg := &#39;Registro actualizado&#39;;

        IF NOT found THEN
INSERT INTO farma_lista_precios_farmacias(
            idaccount, principal, activa, productos, status)
    VALUES (iidaccount, iprincipal, iactiva, iproductos, istatus) RETURNING idlista_precios INTO fun_return;
--fun_return := -100;
fun_msg := &#39;Nuevo registro insertado&#39;;
        END IF;
 

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_firts_load() -->
    <section id="public.function.fun-firts-load"
             xreflabel="publicfun_firts_load()">
      <title id="public.function.fun-firts-load-title">
       fun_firts_load()
      </title>
      <titleabbrev id="public.function.fun-firts-load-titleabbrev">
       fun_firts_load()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

BEGIN

fun_return := 0;
fun_msg := &#39;Carga inicial completada&#39;;

-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM identification_types WHERE ididtype = 0) THEN
INSERT INTO identification_types(
            ididtype, enabled, name, note)
    VALUES (0, true, &#39;Undefined&#39;, &#39;Valor inicial del sistema (No modificar)&#39;);
END IF;

-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM account_types WHERE idaccounttype = 0) THEN
INSERT INTO account_types(
            idaccounttype, type, note)
    VALUES (0, &#39;Undefined&#39;, &#39;Valor inicial del sistema (No modificar)&#39;);

END IF;

-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM account_states WHERE idaccountstate = 0) THEN
INSERT INTO account_states(
            idaccountstate, state, note)
    VALUES (0, &#39;Undefined&#39;, &#39;Valor inicial del sistema (No modificar)&#39;);
END IF;


-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM groups WHERE idgroup = 0) THEN
INSERT INTO groups(
            idgroup, enabled, name, description, note)
    VALUES (0, true, &#39;None&#39;, &#39;Ningun grupo establecido&#39;, &#39;Valor inicial del sistema (No modificar)&#39;);
END IF;


-- Insertamos el registro -1 si no existe
IF NOT EXISTS(SELECT * FROM groups WHERE idgroup = -1) THEN
INSERT INTO groups(
            idgroup, enabled, name, description, note)
    VALUES (-1, true, &#39;oams_admin&#39;, &#39;Admins&#39;, &#39;Grupo de Administradores&#39;);
END IF;


-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM phone_types WHERE idphonetype = 0) THEN
INSERT INTO phone_types(
            idphonetype, type)
    VALUES (0, &#39;Undefined&#39;);
END IF;

-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 0) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (0, &#39;unknown&#39;, 50, true, false, false, &#39;Valor inicial del sistema (No modificar)&#39;, &#39;Evento Desconocido&#39;, &#39;oams-0&#39;);
END IF;

----------------------------------------------------------------------
-- Insertamos el registro 1000 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 1000) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (1000, &#39;login&#39;, 100, false, false, false, &#39;Evento del sistema, no modificar&#39;, &#39;User Login&#39;, &#39;oams-1000&#39;);
END IF;

-- Insertamos el registro 1001 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 1001) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (1001, &#39;logout&#39;, 100, false, false, false, &#39;Evento del sistema, no modificar&#39;, &#39;User Logout&#39;, &#39;oams-1001&#39;);
END IF;

-- Insertamos el registro 1002 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 1002) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (1002, &#39;login fail&#39;, 20, false, false, false, &#39;Evento del sistema, no modificar&#39;, &#39;Login fail&#39;, &#39;oams-1002&#39;);
END IF;

-- Insertamos el registro 1003 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 1003) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (1003, &#39;account_unknown&#39;, 20, false, false, false, &#39;Evento del sistema, no modificar&#39;, &#39;&quot;account_unknown&quot;&#39;, &#39;oams-1003&#39;);
END IF;


-- Insertamos el registro 1003 si no existe
IF NOT EXISTS(SELECT * FROM eventtypes WHERE ideventtype = 1004) THEN
INSERT INTO eventtypes(
            ideventtype, name, priority, treatment, manual, date_editable, note, label, code)
    VALUES (1004, &#39;Unauthorized&#39;, 10, false, false, false, &#39;Evento del sistema, no modificar&#39;, &#39;&quot;System Unauthorized Access&quot;&#39;, &#39;oams-1004&#39;);
END IF;

---------------------------------------------------------------
-- Insertamos el abonado 0 si no existe
IF NOT EXISTS(SELECT * FROM accounts WHERE idcontact = 0) THEN
INSERT INTO accounts(
            idcontact, enabled, first_name, last_name, birthday, identification, 
            ididtype, postal_code, gender, geox, geoy, note, address, address_ref, 
            idaccountstate, idaccounttype, start_date, end_date, account)
    VALUES (0, true, &#39;AMS&#39;, &#39;Open&#39;, now(), md5(&#39;oams&#39;), 
            0, &#39;0000&#39;, 0, 0, 0, &#39;&#39;, &#39;&#39;, &#39;&#39;, 
            0, 0, now(), &#39;2099-01-01 00:00&#39;, &#39;System&#39;);
END IF;

-- Insertamos el abonado 1 si no existe
IF NOT EXISTS(SELECT * FROM accounts WHERE idcontact = 1) THEN
INSERT INTO accounts(
            idcontact, enabled, first_name, last_name, birthday, identification, 
            ididtype, postal_code, gender, geox, geoy, note, address, address_ref, 
            idaccountstate, idaccounttype, start_date, end_date, account)
    VALUES (1, true, &#39;undefined&#39;, &#39;account&#39;, now(), md5(&#39;oams-undefined&#39;), 
            0, &#39;00000&#39;, 0, 0, 0, &#39;&#39;, &#39;&#39;, &#39;&#39;, 
            0, 0, now(), &#39;2099-01-01 00:00&#39;, &#39;undefined&#39;);
END IF;


-----------------------------------------------------------------
-- Insertamos el registro 0 si no existe
IF NOT EXISTS(SELECT * FROM providers WHERE idprovider = 0) THEN
INSERT INTO providers(
            idprovider, provider)
    VALUES (0, &#39;Undefined&#39;);
END IF;

----------------------------------------------------------------
-- Insertamos el registro 0 si no existe (Default) 
IF NOT EXISTS(SELECT * FROM contacts WHERE idcontact = -1) THEN
INSERT INTO contacts(
            idcontact, enabled, first_name, last_name, identification, 
            is_admin, admin_start, admin_end, admin_username, admin_pwd, 
            admin_level)
    VALUES (-1, true, &#39;Alarm Management System&#39;, &#39;Open&#39;, &#39;oams&#39;, 
            true, now(), &#39;2050-01-01 00:00:00&#39;, &#39;admin&#39;, &#39;admin&#39;, 
            0);
END IF;



RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_general_login(msg text, idcontact text, fullname text, username inet, login boolean) -->
    <section id="public.function.fun-general-login-msg-text-idcontact-text-fullname-text-username-inet-login-boolean"
             xreflabel="publicfun_general_login(msg text, idcontact text, fullname text, username inet, login boolean)">
      <title id="public.function.fun-general-login-msg-text-idcontact-text-fullname-text-username-inet-login-boolean-title">
       fun_general_login(msg text, idcontact text, fullname text, username inet, login boolean)
      </title>
      <titleabbrev id="public.function.fun-general-login-msg-text-idcontact-text-fullname-text-username-inet-login-boolean-titleabbrev">
       fun_general_login(msg text, idcontact text, fullname text, username inet, login boolean)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

idcontact_admin bigint DEFAULT -100;
iideventtype INTEGER DEFAULT 0;

BEGIN

idcontact_admin := -500;
login := false;
fullname := &#39;anonymous&#39;;
msg := &#39;Error desconocido&#39;;
username := &#39;anonymous&#39;;
--sessionid := &#39;----&#39;;


IF isadmin THEN

CASE

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iusername) THEN 
msg := &#39;- Intento de acceso con el usuario &#39;||iusername||&#39; no existe o no esta habilitado como administrador.&lt;/br&gt; [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
iideventtype := 1002;

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iusername AND admin_pwd = md5(ipwd)) THEN
msg := &#39;- Intento de acceso con el usuario &#39;||iusername||&#39; - Usuario o clave incorrecta. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
iideventtype := 1002;

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iusername AND admin_pwd = md5(ipwd) AND (now() BETWEEN admin_start AND admin_end)) THEN
msg := &#39;- Intento de acceso del usuario &#39;||iusername||&#39; fuera del rango de fechas autorizadas para l. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
iideventtype := 1002;

WHEN EXISTS(SELECT * FROM admins WHERE admin_username = iusername AND admin_pwd = md5(ipwd)) THEN
-- Actualizamos el ssessionid en la tabla
--UPDATE admins SET isessionid = md5(iusername||&#39;+&#39;||iip||&#39;+&#39;||iuseragent||&#39;+&#39;||(extract(epoch FROM now())::TEXT)), admin_ip = iip, last_access = now(), last_heartbeat = now() WHERE admin_username = iusername AND admin_pwd = md5(ipwd) RETURNING admins.idadmin, admins.idcontact INTO idadmin, idcontact_admin;
-- Insertamos en el log del sistema el ingreso
msg := &#39;- Acceso al sistema. Usuario: &#39;||iusername||&#39;. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
iideventtype := 1000;
--sessionid := md5(iusername||&#39;+&#39;||iip||&#39;+&#39;||iuseragent||&#39;+&#39;||(extract(epoch FROM now())::TEXT));

--SELECT admin_username, admin_sessionid INTO username, sessionid FROM admins WHERE idcontact = idcontact_admin;
SELECT contacts.idcontact,   (contacts.last_name ||&#39; &#39;|| contacts.first_name) as full_name INTO idcontact, fullname FROM public.contacts, public.admins WHERE contacts.idcontact = admins.idcontact AND admins.admin_username = iusername AND admins.admin_pwd = md5(ipwd);

login := true;

PERFORM fun_notification_app_send(10, 10, true, &#39;&#39;, &#39;&#39;, &#39;Bienvenid@&#39;, fullname, idcontact);
PERFORM fun_notification_app_send(10, 10, TRUE, &#39;&#39;, &#39;&#39;, &#39;Usuario conectado&#39;, fullname, null);


ELSE

msg := &#39;- Ninguna validacion ha sido realizada para el usuario &#39;||iusername||&#39; no existe o no esta habilitado. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
iideventtype := 1002;
--INSERT INTO event_login(            idaccount, ideventtype, description, idcontact)    VALUES (0, 1002, msg, idcontact);

END CASE;




ELSE
-------------------------------
-- Intenta como usuario
-------------------------------


END IF;

INSERT INTO events_login(idaccount, ideventtype, description, ip, idcontact) VALUES (0, iideventtype, msg, iip, idcontact);

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_get_idaccount_by_account(iiddivision text, iaccount bigint) -->
    <section id="public.function.fun-get-idaccount-by-account-iiddivision-text-iaccount-bigint"
             xreflabel="publicfun_get_idaccount_by_account(iiddivision text, iaccount bigint)">
      <title id="public.function.fun-get-idaccount-by-account-iiddivision-text-iaccount-bigint-title">
       fun_get_idaccount_by_account(iiddivision text, iaccount bigint)
      </title>
      <titleabbrev id="public.function.fun-get-idaccount-by-account-iiddivision-text-iaccount-bigint-titleabbrev">
       fun_get_idaccount_by_account(iiddivision text, iaccount bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

R INTEGER DEFAULT 1;

BEGIN

R := COALESCE((SELECT idcontact FROM accounts WHERE account = iaccount AND iddivision = iiddivision ORDER BY idcontact  DESC LIMIT 1), 1);

IF R &lt; 2 THEN
-- Verificamos si existe el account, caso contrario le asignamos como 0 (desconocido)
--PERFORM fun_event_insert_by_ideventtype(now()::timestamp without time zone, R, 0, 0, 1003, &#39;Account &#39;||iaccount||&#39; no found&#39;, 0);
INSERT INTO events( ideventtype, description)
    VALUES (1003, &#39;Account &#39;||iaccount||&#39; no found&#39;);

--R := 1;
END IF;

RETURN R;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_heartbeat(isessionid bigint, iidadmin text) -->
    <section id="public.function.fun-heartbeat-isessionid-bigint-iidadmin-text"
             xreflabel="publicfun_heartbeat(isessionid bigint, iidadmin text)">
      <title id="public.function.fun-heartbeat-isessionid-bigint-iidadmin-text-title">
       fun_heartbeat(isessionid bigint, iidadmin text)
      </title>
      <titleabbrev id="public.function.fun-heartbeat-isessionid-bigint-iidadmin-text-titleabbrev">
       fun_heartbeat(isessionid bigint, iidadmin text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE
r boolean DEFAULT false;
idupdated bigint DEFAULT 0;
BEGIN
/*
PERFORM fun_expired_session();

IF EXISTS(SELECT * FROM admins WHERE idadmin = iidadmin AND admin_sessionid = isessionid) THEN
UPDATE admins SET last_heartbeat = now() WHERE idadmin = iidadmin AND admin_sessionid = isessionid;
r := true;
END IF;
*/

RETURN r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_last_modified_table_remove_olds() -->
    <section id="public.function.fun-last-modified-table-remove-olds"
             xreflabel="publicfun_last_modified_table_remove_olds()">
      <title id="public.function.fun-last-modified-table-remove-olds-title">
       fun_last_modified_table_remove_olds()
      </title>
      <titleabbrev id="public.function.fun-last-modified-table-remove-olds-titleabbrev">
       fun_last_modified_table_remove_olds()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR SELECT * FROM view_last_modif_tables;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP

 DELETE FROM table_modification_log WHERE table_name = cursor1_row.table_name AND schema_name = cursor1_row.schema_name AND idtablemodif &lt; cursor1_row.idtablemodif;
fun_return := fun_return+1;
    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_login_system(iuseragent text, iip text, ipwd inet, iuser text) -->
    <section id="public.function.fun-login-system-iuseragent-text-iip-text-ipwd-inet-iuser-text"
             xreflabel="publicfun_login_system(iuseragent text, iip text, ipwd inet, iuser text)">
      <title id="public.function.fun-login-system-iuseragent-text-iip-text-ipwd-inet-iuser-text-title">
       fun_login_system(iuseragent text, iip text, ipwd inet, iuser text)
      </title>
      <titleabbrev id="public.function.fun-login-system-iuseragent-text-iip-text-ipwd-inet-iuser-text-titleabbrev">
       fun_login_system(iuseragent text, iip text, ipwd inet, iuser text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>json</seg>
        </seglistitem>
       </segmentedlist>
 
       Retorna los datos del usuario o administrador
        <programlisting>DECLARE

r JSON;
iideventtype BIGINT;
msg TEXT;
islogged BOOLEAN DEFAULT false;

BEGIN

----------- Busca primero los datos como administrador -------------------
CASE

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iuser) THEN 
--msg := &#39;- Intento de acceso con el usuario &#39;||iuser||&#39; no existe o no esta habilitado como administrador.&lt;/br&gt; [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
msg := &#39;- Intento de acceso con el usuario &#39;||iuser||&#39; no existe o no esta habilitado como administrador.&lt;/br&gt;&#39;;
iideventtype := 1002;

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iuser AND admin_pwd = md5(ipwd)) THEN
--msg := &#39;- Intento de acceso con el usuario &#39;||iuser||&#39; - Usuario o clave incorrecta. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
msg := &#39;- Intento de acceso con el usuario &#39;||iuser||&#39; - Usuario o clave incorrecta.&#39;;
iideventtype := 1002;

WHEN NOT EXISTS(SELECT * FROM admins WHERE admin_username = iuser AND admin_pwd = md5(ipwd) AND (now() BETWEEN admin_start AND admin_end)) THEN
--msg := &#39;- Intento de acceso del usuario &#39;||iuser||&#39; fuera del rango de fechas autorizadas para l. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
msg := &#39;- Intento de acceso del usuario &#39;||iuser||&#39; fuera del rango de fechas autorizadas para l.&#39;;
iideventtype := 1002;

WHEN EXISTS(SELECT * FROM admins WHERE admin_username = iuser AND admin_pwd = md5(ipwd)) THEN
--msg := &#39;- Acceso al sistema. Administrador: &#39;||iuser||&#39;. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
msg := &#39;- Acceso al sistema. Administrador: &#39;||iuser;

iideventtype := 1000;

SELECT row_to_json(t) INTO r
from (
   SELECT *, &#39;A&#39;||idadmin as idlogin, contact_name as fullname, true as isadmin FROM public.view_admins WHERE admin_username = iuser AND admin_pwd = md5(ipwd)
) t;

islogged := true;

ELSE
------ Buscamos como usuario ------
IF EXISTS(SELECT * FROM view_account_users WHERE account_user = iuser AND account_pwd = decode(ipwd::BYTEA, &#39;base64&#39;)) THEN
SELECT row_to_json(t) INTO r
from (
   SELECT * FROM view_account_users WHERE account_user = iuser AND account_pwd = decode(ipwd::BYTEA, &#39;base64&#39;)
) t;
islogged := true;
--msg := &#39;- Acceso autorizado al sistema. Usuario: &#39;||iuser||&#39;. [IP: &#39;||iip||&#39;] [Navegador: &#39;||iuseragent||&#39;]&#39;;
msg := &#39;- Acceso autorizado al sistema. Usuario: &#39;||iuser;
iideventtype := 1002;

ELSE

msg := &#39;- Intento de acceso al sistema. Usuario: &#39;||iuser;
iideventtype := 1002;
END IF;

END CASE;


RAISE NOTICE &#39;1) Es adsmin %&#39;, r-&gt;&gt;&#39;isadmin&#39;;
RAISE NOTICE &#39;2) Es idadmin %&#39;, r-&gt;&gt;&#39;idadmin&#39;;

IF r-&gt;&gt;&#39;isadmin&#39; = &#39;true&#39; THEN
INSERT INTO events.datas(
            idaccount, ideventtype, description, idadmin, idcontact_user, details)
    VALUES (0, iideventtype, msg, (r-&gt;&gt;&#39;idadmin&#39;)::BIGINT, (r-&gt;&gt;&#39;idcontact&#39;)::BIGINT, (SELECT row_to_json(t)from (  select iuseragent as useragent, iip as ip ) t));
ELSE

    
END IF;


IF islogged THEN
--PERFORM fun_notification_app_send(10, 10, true, &#39;&#39;, &#39;&#39;, &#39;Bienvenid@&#39;, fullname, idadmin);
PERFORM fun_notification_app_send(10, 10, TRUE, &#39;&#39;, &#39;&#39;, &#39;Usuario conectado&#39;, r-&gt;&gt;&#39;fullname&#39;, null);
END IF;



return r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_logout_system(iip boolean, ifullname bigint, iid text, iisadmin inet) -->
    <section id="public.function.fun-logout-system-iip-boolean-ifullname-bigint-iid-text-iisadmin-inet"
             xreflabel="publicfun_logout_system(iip boolean, ifullname bigint, iid text, iisadmin inet)">
      <title id="public.function.fun-logout-system-iip-boolean-ifullname-bigint-iid-text-iisadmin-inet-title">
       fun_logout_system(iip boolean, ifullname bigint, iid text, iisadmin inet)
      </title>
      <titleabbrev id="public.function.fun-logout-system-iip-boolean-ifullname-bigint-iid-text-iisadmin-inet-titleabbrev">
       fun_logout_system(iip boolean, ifullname bigint, iid text, iisadmin inet)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--Now timestamp without time zone default now();
R boolean DEFAULT FALSE;
iidcontact BIGINT;

BEGIN

IF iisadmin THEN

   SELECT idcontact INTO iidcontact FROM view_admins  WHERE idadmin = iid;


INSERT INTO events_login(
            idaccount, 
            ideventtype, idadmin, ip, isopen, idcontact_user)
    VALUES (0, 
            1001, iid, iip, FALSE, iidcontact);

PERFORM fun_notification_app_send(10, 10, TRUE, &#39;&#39;, &#39;&#39;, &#39;Usuario desconectado&#39;, ifullname, null);
            
ELSE

--SELECT idcontact INTO iidcontact FROM view_account_users WHERE idadmin = idadmin;


END IF;

            
R := TRUE;
RETURN R;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_notification_app_send(iidadmin integer, inbody integer, intitle boolean, insnd text, inimg text, incloseable text, intimeout text, ipriority bigint) -->
    <section id="public.function.fun-notification-app-send-iidadmin-integer-inbody-integer-intitle-boolean-insnd-text-inimg-text-incloseable-text-intimeout-text-ipriority-bigint"
             xreflabel="publicfun_notification_app_send(iidadmin integer, inbody integer, intitle boolean, insnd text, inimg text, incloseable text, intimeout text, ipriority bigint)">
      <title id="public.function.fun-notification-app-send-iidadmin-integer-inbody-integer-intitle-boolean-insnd-text-inimg-text-incloseable-text-intimeout-text-ipriority-bigint-title">
       fun_notification_app_send(iidadmin integer, inbody integer, intitle boolean, insnd text, inimg text, incloseable text, intimeout text, ipriority bigint)
      </title>
      <titleabbrev id="public.function.fun-notification-app-send-iidadmin-integer-inbody-integer-intitle-boolean-insnd-text-inimg-text-incloseable-text-intimeout-text-ipriority-bigint-titleabbrev">
       fun_notification_app_send(iidadmin integer, inbody integer, intitle boolean, insnd text, inimg text, incloseable text, intimeout text, ipriority bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

isessionid text default &#39;all&#39;;

BEGIN

isessionid := COALESCE((SELECT admin_sessionid FROM admins WHERE idadmin = iidadmin limit 1), &#39;all&#39;);

INSERT INTO notification_area(
            urgency, timeout, closable, img, snd, title, body, 
            sessionid)
    VALUES (ipriority, intimeout, incloseable, inimg, insnd, intitle, inbody, 
            isessionid);


RETURN 0;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_oams_mapper() -->
    <section id="public.function.fun-oams-mapper"
             xreflabel="publicfun_oams_mapper()">
      <title id="public.function.fun-oams-mapper-title">
       fun_oams_mapper()
      </title>
      <titleabbrev id="public.function.fun-oams-mapper-titleabbrev">
       fun_oams_mapper()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR SELECT table_name, column_name, data_type, column_default from information_schema.columns where table_name NOT LIKE &#39;%_20%&#39; AND table_name NOT LIKE &#39;%_19%&#39; AND table_catalog = &#39;open_ams&#39;  and table_schema = &#39;public&#39; ORDER BY table_name, column_name, data_type;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP
    
UPDATE oams_table_columns
   SET data_type=cursor1_row.data_type, column_default=cursor1_row.column_default
 WHERE table_name=cursor1_row.table_name AND column_name=cursor1_row.column_name;
        IF NOT found THEN
INSERT INTO oams_table_columns(
            table_name, column_name, data_type, column_default, 
            column_label)
    VALUES (cursor1_row.table_name, cursor1_row.column_name, cursor1_row.data_type, cursor1_row.column_default, 
            cursor1_row.column_name);
        END IF;


    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_pnatural_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text) -->
    <section id="public.function.fun-pnatural-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text"
             xreflabel="publicfun_pnatural_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)">
      <title id="public.function.fun-pnatural-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text-title">
       fun_pnatural_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)
      </title>
      <titleabbrev id="public.function.fun-pnatural-import-accounts-fun-msg-text-fun-return-text-cedula-sup-operativo-text-iemail-text-telf2-text-telf1-timestamp-without-time-zone-idb-pwd-timestamp-without-time-zone-idb-user-text-iaccount-text-iend-date-text-istart-date-text-iaddress-ref-text-iaddress-text-ilast-name-text-titleabbrev">
       fun_pnatural_import_accounts(fun_msg text, fun_return text, cedula_sup_operativo text, iemail text, telf2 text, telf1 timestamp without time zone, idb_pwd timestamp without time zone, idb_user text, iaccount text, iend_date text, istart_date text, iaddress_ref text, iaddress text, ilast_name text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE
id BIGINT DEFAULT 0;
ienabled BOOLEAN DEFAULT TRUE;
idldf INTEGER DEFAULT 0;
ifirst_name text default &#39;&#39;;
iidaccounttype INTEGER DEFAULT 0;

ifname text default &#39;&#39;;
ilname text default &#39;&#39;;

BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;
id := fun_get_idaccount_by_account(iaccount, 1);
idldf := COALESCE((SELECT idcontact FROM contacts WHERE identification = cedula_sup_operativo LIMIT 1), 0);

CASE
WHEN position(&#39;PUNTO&#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 6 for 100);
ilname := &#39;PUNTO NATURAL&#39;;

WHEN position(&#39;ECO &#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 5 for 100);
ilname := &#39;ECO&#39;;

WHEN position(&#39;PAF &#39; in ilast_name) = 1 THEN
ifname := substring(ilast_name from 5 for 100);
ilname := &#39;PAF&#39;;

ELSE

ifname := &#39; *&#39;;
ilname := ilast_name;

END CASE;

IF istatus != &#39;A&#39; THEN
ienabled := FALSE;
END IF;

IF franquicia = &#39;N&#39; THEN
iidaccounttype := 3;
ELSE
iidaccounttype := 4;
END IF;

RAISE NOTICE &#39;Account (%) con ID (%)&#39;, iaccount, id;

-- Para este caso ilast_name se lo utiliza como nombre y * como apellido

CASE

	WHEN id &lt;= 1 THEN
	BEGIN

-- Verificamos que no se repita el abonado
	iaccount := fun_account_auto_account(iaccount);

-- Ingresamos un nuevo registro
INSERT INTO accounts(
            enabled, first_name, last_name, birthday, identification, 
            address, address_ref, 
            start_date, end_date, account, idaccounttype, iddivision)
    VALUES (ienabled,  ilname, ifname, istart_date, iaccount, 
            iaddress, iaddress_ref, 
            istart_date, iend_date, iaccount, iidaccounttype, 2)
 RETURNING idcontact INTO fun_return;
fun_msg := &#39;Nuevo registro insertado&#39;;

IF fun_return &gt; 0 THEN

PERFORM fun_farma_import_accounts_insertphone(fun_return, telf1);
PERFORM fun_farma_import_accounts_insertphone(fun_return, telf2);
PERFORM fun_farma_import_accounts_insertemail(fun_return, iemail);

DELETE FROM account_contacts WHERE appointment = &#39;PNatural_LDF&#39; AND idaccount = fun_return;
IF idldf &gt; 0 THEN
INSERT INTO account_contacts (idaccount, idcontact, appointment, priority) VALUES (fun_return, idldf, &#39;PNatural_LDF&#39;, 2);
END IF;

END IF;

fun_msg := fun_return;

EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -2;
 fun_msg := &#39;Registro tiene campos que deben ser unicos&#39;||iaccount||&#39; &#39;||ilast_name||&#39; &#39;||iaccount;
END;


	WHEN id &gt; 1  THEN
BEGIN	
-- Actualizamos
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar cuenta&#39;, iaccount, id;
UPDATE accounts
   SET iddivision = 1, first_name=ifname, last_name=ilname, birthday=istart_date, 
       identification=iaccount, address=iaddress, address_ref=iaddress_ref, start_date=istart_date, end_date=iend_date, account=iaccount, idaccounttype = iidaccounttype
 WHERE idcontact = id;
 fun_return := id;
 fun_msg := &#39;Registro Actualizado&#39;;
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar telefonos&#39;, iaccount, id;

PERFORM fun_farma_import_accounts_insertphone(id, telf1);
PERFORM fun_farma_import_accounts_insertphone(id, telf2);
PERFORM fun_farma_import_accounts_insertemail(id, iemail);

RAISE NOTICE &#39;Account (%) con ID (%) para actualizar - Eliminamos el LDF&#39;, iaccount, id;
DELETE FROM account_contacts WHERE appointment = &#39;PNatural_LDF&#39; AND idaccount = id;

RAISE NOTICE &#39;Account (%) con ID (%) para actualizar ldf&#39;, iaccount, id;
IF idldf &gt; 0 THEN
INSERT INTO account_contacts (idaccount, idcontact, appointment, priority) VALUES (id, idldf, &#39;PNatural_LDF&#39;, 2);
END IF;

/*
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar datos del servidor (% =&gt; %)&#39;, iaccount, id, idb_user, idb_pwd;
-- Actualizamos los datos del servidor
UPDATE network_devices
   SET username=idb_user, pwd=idb_pwd WHERE idaccount=id AND equipment=&#39;Server&#39; AND mark=&#39;Farma01&#39;;
        IF NOT found THEN

IF id &gt; 0 THEN
RAISE NOTICE &#39;Account (%) con ID (%) para actualizar / Datos del servidor no encontrados, se inserta.&#39;, iaccount, id;        
INSERT INTO network_devices(
            equipment, mark, description, 
            username, pwd, idaccount)
    VALUES (&#39;Server&#39;, &#39;Farma01&#39;, &#39;Servidor de farmacia Nueva &#39;||id::text, 
            idb_user, idb_pwd, fun_return);
END IF;
        END IF;
*/
 /*
-- Actualizamos los datos del gateway
UPDATE network_devices
   SET note = &#39;No modificar esta nota&#39; WHERE idaccount=fun_return AND equipment=&#39;Gateway&#39;;
        IF NOT found THEN
IF fun_return &gt; 0 THEN
INSERT INTO network_devices(
            equipment, description, idaccount, note)
    VALUES (&#39;Gateway&#39;, &#39;Gateway de farmacia &#39;||fun_return::text, 
            fun_return, &#39;No modificar o borrar esta nota&#39;);
END IF;
        END IF;
*/

fun_msg := id;

 EXCEPTION WHEN unique_violation THEN
 -- do nothing
 fun_return := -3;
 fun_msg := &#39;Registro tiene campos que deben ser unicos id=&#39;||id::TEXT||&#39; &#39;||iaccount||&#39; &#39;||ilast_name||;
 
END;




	WHEN id &lt; 0  THEN
-- Eliminamos
/*DELETE FROM accounts
 WHERE idcontact=id;
 fun_return := 0;
 fun_msg := &#39;Registro Eliminado&#39;;*/

ELSE

 END CASE;


RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_pnatural_import_asig_personal_pnatural(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text) -->
    <section id="public.function.fun-pnatural-import-asig-personal-pnatural-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text"
             xreflabel="publicfun_pnatural_import_asig_personal_pnatural(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)">
      <title id="public.function.fun-pnatural-import-asig-personal-pnatural-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text-title">
       fun_pnatural_import_asig_personal_pnatural(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)
      </title>
      <titleabbrev id="public.function.fun-pnatural-import-asig-personal-pnatural-fun-msg-text-fun-return-text-oficina-text-estado-text-perfil-referencia-boolean-pwd-text-titleabbrev">
       fun_pnatural_import_asig_personal_pnatural(fun_msg text, fun_return text, oficina text, estado text, perfil_referencia boolean, pwd text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

iidaccount INTEGER;
iidcontact INTEGER;
ipriority INTEGER DEFAULT 5;


BEGIN

fun_return := -100;
fun_msg := &#39;Error desconocido&#39;;


-- Buscamos el idcontact segun la cedula
SELECT idcontact INTO iidcontact FROM contacts WHERE identification = cedula;

IF perfil_referencia LIKE &#39;PVAdm%&#39; THEN
ipriority := 3;
END IF;


-- Buscamos el idaccount segun la oficina
--iidaccount := fun_get_idaccount_by_account(oficina);
--iidaccount := fun_get_idaccount_by_account(oficina, 1);
iidaccount := fun_get_idaccount_by_account(oficina, 2);

IF iidaccount IS NOT NULL AND iidcontact IS NOT NULL THEN

INSERT INTO account_users(
            idaccount, idcontact, appointment, note, account_user, account_pwd, date_end, enabled, priority)
    VALUES (iidaccount, iidcontact, &#39;pnatural_&#39;||perfil_referencia::TEXT, &#39;Usuario asignado por Punto Natural, no modificar el appointment&#39;, nombrecorto, pwd, &#39;2050-01-01 00:00&#39;, estado, ipriority) RETURNING idaccountuser INTO fun_return;

 fun_msg := &#39;Registro insertado&#39;;
ELSE

fun_return := -1;
 fun_msg := &#39;El registro no pudo ser insertado, idaccount e idcontact no pueden ser nulos&#39;;
END IF;


 



RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_quick_create_account(fun_msg integer, fun_return integer, iaddress_ref text, iaddress text, iididtype text, iidentification text, ilast_name integer, ifirst_name text, iaccount text) -->
    <section id="public.function.fun-quick-create-account-fun-msg-integer-fun-return-integer-iaddress-ref-text-iaddress-text-iididtype-text-iidentification-text-ilast-name-integer-ifirst-name-text-iaccount-text"
             xreflabel="publicfun_quick_create_account(fun_msg integer, fun_return integer, iaddress_ref text, iaddress text, iididtype text, iidentification text, ilast_name integer, ifirst_name text, iaccount text)">
      <title id="public.function.fun-quick-create-account-fun-msg-integer-fun-return-integer-iaddress-ref-text-iaddress-text-iididtype-text-iidentification-text-ilast-name-integer-ifirst-name-text-iaccount-text-title">
       fun_quick_create_account(fun_msg integer, fun_return integer, iaddress_ref text, iaddress text, iididtype text, iidentification text, ilast_name integer, ifirst_name text, iaccount text)
      </title>
      <titleabbrev id="public.function.fun-quick-create-account-fun-msg-integer-fun-return-integer-iaddress-ref-text-iaddress-text-iididtype-text-iidentification-text-ilast-name-integer-ifirst-name-text-iaccount-text-titleabbrev">
       fun_quick_create_account(fun_msg integer, fun_return integer, iaddress_ref text, iaddress text, iididtype text, iidentification text, ilast_name integer, ifirst_name text, iaccount text)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

--iidcontact INTEGER DEFAULT 0;
--iidaccount INTEGER DEFAULT 0;

BEGIN
fun_msg := &#39;Ninguna accion realizada&#39;;
fun_return := 0;
  CASE

	WHEN EXISTS(SELECT * FROM accounts WHERE identification = iidentification AND ididtype = iididtype) THEN
		fun_msg := &#39;El numero de identificacin ya existe&#39;;
	WHEN EXISTS(SELECT * FROM accounts WHERE first_name = ifirst_name AND last_name = ilast_name) THEN 
		fun_msg := &#39;Un abonado o contacto ya existe con esos nombres&#39;;
  ELSE

INSERT INTO accounts(
            first_name, last_name, identification, 
            ididtype, address, address_ref, 
            idaccountstate, idaccounttype, account)
    VALUES (ifirst_name, ilast_name, iidentification, 
            iididtype, iaddress, iaddress_ref, 
            iidaccountstate, iidaccounttype, iaccount) RETURNING idcontact INTO fun_return;

IF fun_return &gt; 0 THEN
fun_msg := &#39;El abonado ha sido creado&#39;;
END IF;

  END CASE;          

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_receiver_raid_reports(fun_msg text, fun_return timestamp without time zone, iline_file text, idescription text, iproducttype text, ihostname integer) -->
    <section id="public.function.fun-receiver-raid-reports-fun-msg-text-fun-return-timestamp-without-time-zone-iline-file-text-idescription-text-iproducttype-text-ihostname-integer"
             xreflabel="publicfun_receiver_raid_reports(fun_msg text, fun_return timestamp without time zone, iline_file text, idescription text, iproducttype text, ihostname integer)">
      <title id="public.function.fun-receiver-raid-reports-fun-msg-text-fun-return-timestamp-without-time-zone-iline-file-text-idescription-text-iproducttype-text-ihostname-integer-title">
       fun_receiver_raid_reports(fun_msg text, fun_return timestamp without time zone, iline_file text, idescription text, iproducttype text, ihostname integer)
      </title>
      <titleabbrev id="public.function.fun-receiver-raid-reports-fun-msg-text-fun-return-timestamp-without-time-zone-iline-file-text-idescription-text-iproducttype-text-ihostname-integer-titleabbrev">
       fun_receiver_raid_reports(fun_msg text, fun_return timestamp without time zone, iline_file text, idescription text, iproducttype text, ihostname integer)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

descript text default &#39;&#39;;
idaccount INTEGER DEFAULT 1;
ideventtype INTEGER DEFAULT 0;

BEGIN

-- Determinamos el ideventtype segun el texto de la descripcion
CASE

WHEN idescription LIKE &#39;Logical drive%goes critical%&#39;  THEN
 ideventtype := 4;

WHEN idescription LIKE &#39;Port%unplugged%&#39;  THEN
 ideventtype := 5;

wHEN idescription LIKE &#39;Port%down%&#39;  THEN
 ideventtype := 6;
 
wHEN idescription LIKE &#39;Rebuild on logical drive%completed%&#39;  THEN
 ideventtype := 11; 

wHEN idescription LIKE &#39;Rebuild on logical drive%started%&#39;  THEN
 ideventtype := 12;

wHEN idescription LIKE &#39;Redundancy Check on logical drive%completed%&#39;  THEN
 ideventtype := 13; 

wHEN idescription LIKE &#39;S.M.A.R.T threshold exceeded%&#39;  THEN
 ideventtype := 14;

wHEN idescription LIKE &#39;Synchronization is requested to perform on the logical drive%that has never been initialized%&#39;  THEN
 ideventtype := 17;

wHEN idescription LIKE &#39;Synchronization on logical drive%completed%&#39;  THEN
 ideventtype := 18;

wHEN idescription LIKE &#39;%disk error%&#39;  THEN
 ideventtype := 19;

wHEN idescription LIKE &#39;%timeout on port%&#39;  THEN
 ideventtype := 20;

wHEN idescription LIKE &#39;%Unknown Event%&#39;  THEN
 ideventtype := 21;

END CASE;

SELECT account INTO ioficina FROM view_account_network_devices WHERE ip = ihostname::inet;

idaccount := fun_get_idaccount_by_account(ioficina::TEXT, 1);
descript := &#39;&lt;b&gt;IP:&lt;/b&gt; &#39;||ihostname||&#39;&lt;/br&gt;&lt;b&gt; Product Type:&lt;/b&gt; &#39;||iproducttype||&#39;&lt;/br&gt; &#39;||idescription; 
--fun_event_insert_by_ideventtype(IN idateevent timestamp without time zone, IN iidaccount integer, IN izu integer, IN ipriority integer, IN iideventtype integer, IN idescription text, IN iidadmin integer, OUT fun_return integer, OUT fun_msg text)
--SELECT * FROM fun_event_insert_by_ideventtype(ireceivetime, idaccount, 0, 0, ideventtype, descript, 0) INTO fun_return, fun_msg;  
INSERT INTO events_raid(
            dateevent, idaccount, ideventtype, description, hostname, line_file)
    VALUES (ireceivetime, idaccount, ideventtype, descript, ihostname::inet, iline_file);

RETURN;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_remove_notifications_old() -->
    <section id="public.function.fun-remove-notifications-old"
             xreflabel="publicfun_remove_notifications_old()">
      <title id="public.function.fun-remove-notifications-old-title">
       fun_remove_notifications_old()
      </title>
      <titleabbrev id="public.function.fun-remove-notifications-old-titleabbrev">
       fun_remove_notifications_old()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>boolean</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>BEGIN
DELETE FROM notification_area 
WHERE EXTRACT(EPOCH FROM (now() - ts) / 60) &gt; 2;
RETURN TRUE;
END;
</programlisting>
      </para>
    </section>

<!-- Function fun_set_expired_events() -->
    <section id="public.function.fun-set-expired-events"
             xreflabel="publicfun_set_expired_events()">
      <title id="public.function.fun-set-expired-events-title">
       fun_set_expired_events()
      </title>
      <titleabbrev id="public.function.fun-set-expired-events-titleabbrev">
       fun_set_expired_events()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

fun_return INTEGER DEFAULT 0;
cursor1 CURSOR FOR select * from (select idevent, dateevent, ideventtype, (extract(epoch from age(now(), dateevent))/60) AS minutes_event, (select expiration from eventtypes where ideventtype = ev.ideventtype) as limit_expiration
 from events ev where isopen = true ) as v WHERE minutes_event &gt;=  limit_expiration;
    cursor1_row RECORD;

BEGIN


    FOR cursor1_row IN cursor1 LOOP
            -- if cursor1_row.minutes_event &gt;=  cursor1_row.limit_expiration then
        --  PERFORM fun_edit_event_comments(0, 0, now()::timestamp without time zone, 1, &#39;Event expired. Automatically closed by the system.&#39;::text, 5, cursor1_row.idevent::bigint);   
INSERT INTO event_comments(
            idadmin, start, seconds, comment_event, ideventstatustype, idevent)
    VALUES (0, now(), 1, &#39;Event expired. Automatically closed by the system.&#39;, 5, cursor1_row.idevent::bigint);
fun_return := fun_return+1;
  --     end if;  
    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_sufix_name_by_date(idate timestamp with time zone) -->
    <section id="public.function.fun-sufix-name-by-date-idate-timestamp-with-time-zone"
             xreflabel="publicfun_sufix_name_by_date(idate timestamp with time zone)">
      <title id="public.function.fun-sufix-name-by-date-idate-timestamp-with-time-zone-title">
       fun_sufix_name_by_date(idate timestamp with time zone)
      </title>
      <titleabbrev id="public.function.fun-sufix-name-by-date-idate-timestamp-with-time-zone-titleabbrev">
       fun_sufix_name_by_date(idate timestamp with time zone)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

r TEXT DEFAULT &#39;19900101&#39;;

BEGIN
--r := to_char(idate, &#39;YYYYMMDD&#39;)::TEXT;
--r := to_char(idate, &#39;YYYYMM&#39;)::TEXT;
r := to_char(idate, &#39;YYYY&#39;)::TEXT;

return r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_udc_get_structure_table_view(table_view_fields text, table_view_name text[]) -->
    <section id="public.function.fun-udc-get-structure-table-view-table-view-fields-text-table-view-name-textARRAY"
             xreflabel="publicfun_udc_get_structure_table_view(table_view_fields text, table_view_name text[])">
      <title id="public.function.fun-udc-get-structure-table-view-table-view-fields-text-table-view-name-textARRAY-title">
       fun_udc_get_structure_table_view(table_view_fields text, table_view_name text[])
      </title>
      <titleabbrev id="public.function.fun-udc-get-structure-table-view-table-view-fields-text-table-view-name-textARRAY-titleabbrev">
       fun_udc_get_structure_table_view(table_view_fields text, table_view_name text[])
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>

DECLARE

r text;

BEGIN

select row_to_json(t) into r  
from (
  select *,
    (
      select array_to_json(array_agg(row_to_json(d)))
      from (
      -- dgrid_editable as &quot;canEdit&quot;,
        select dgrid_editor_args as &quot;editorArgs&quot;, dgrid_sortable as sortable, dgrid_editon as &quot;editOn&quot;, dgrid_resizable as resizable, column_name as field, column_label as &quot;label&quot;, dgrid_rendercell as &quot;renderCell&quot;, dgrid_classname as &quot;className&quot;, dgrid_formatter as formatter, dgrid_editor as editor
        from udc_columns where idtableview = udc_tables_views.idtableview AND &quot;show&quot; = true AND column_name = ANY(table_view_fields) ORDER BY column_position
      ) d
    ) as udc_column_definition
  from udc_tables_views where idtableview = (SELECT oid FROM pg_class WHERE relname = table_view_name)::bigint
) t;


return r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_udc_get_structure_table_view_all(table_view_fields text, table_view_name text[]) -->
    <section id="public.function.fun-udc-get-structure-table-view-all-table-view-fields-text-table-view-name-textARRAY"
             xreflabel="publicfun_udc_get_structure_table_view_all(table_view_fields text, table_view_name text[])">
      <title id="public.function.fun-udc-get-structure-table-view-all-table-view-fields-text-table-view-name-textARRAY-title">
       fun_udc_get_structure_table_view_all(table_view_fields text, table_view_name text[])
      </title>
      <titleabbrev id="public.function.fun-udc-get-structure-table-view-all-table-view-fields-text-table-view-name-textARRAY-titleabbrev">
       fun_udc_get_structure_table_view_all(table_view_fields text, table_view_name text[])
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>text</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>

DECLARE

r text;

BEGIN

select row_to_json(t) into r  
from (
  select *,
    (
      select array_to_json(array_agg(row_to_json(d)))
      from (
      -- dgrid_editable as &quot;canEdit&quot;,
        select dgrid_editor_args as &quot;editorArgs&quot;, dgrid_sortable as sortable, dgrid_editon as &quot;editOn&quot;, dgrid_resizable as resizable, column_name as field, column_label as &quot;label&quot;, dgrid_rendercell as &quot;renderCell&quot;, dgrid_classname as &quot;className&quot;, dgrid_formatter as formatter, dgrid_editor as editor
        from udc_columns where idtableview = udc_tables_views.idtableview  ORDER BY column_position
      ) d
    ) as udc_column_definition
  from udc_tables_views
) t;


return r;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_udc_mapper_tables_views() -->
    <section id="public.function.fun-udc-mapper-tables-views"
             xreflabel="publicfun_udc_mapper_tables_views()">
      <title id="public.function.fun-udc-mapper-tables-views-title">
       fun_udc_mapper_tables_views()
      </title>
      <titleabbrev id="public.function.fun-udc-mapper-tables-views-titleabbrev">
       fun_udc_mapper_tables_views()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>integer</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>DECLARE

old_idtableview BIGINT;
idata_type text;
--oid_id BIGINT;
fun_return INTEGER DEFAULT 0;

cursor1 CURSOR FOR SELECT (SELECT oid FROM pg_class WHERE relname = ics.table_name)::bigint as idtableview, table_name, column_name, data_type, column_default, udt_name from information_schema.columns ics where table_name NOT LIKE &#39;%_20%&#39; AND table_name NOT LIKE &#39;%_19%&#39; AND table_schema = &#39;public&#39; ORDER BY table_name, column_name, data_type;
    cursor1_row RECORD;

--cursor2 CURSOR FOR SELECT table_name, column_name, data_type, column_default, udt_name from information_schema.columns where table_name NOT LIKE &#39;%_20%&#39; AND table_name NOT LIKE &#39;%_19%&#39; AND table_schema = &#39;public&#39; ORDER BY table_name, column_name, data_type;
  --  cursor2_row RECORD;


BEGIN

------------------------------------
    FOR cursor1_row IN cursor1 LOOP

-- Verificamos si el nombre de la tabla ya existe, si es asi obtenemos el idtableview y actualizamos en udc_tables_views
IF  EXISTS(SELECT * FROM udc_tables_views WHERE tv_name = cursor1_row.table_name) THEN
SELECT idtableview INTO old_idtableview FROM udc_tables_views WHERE tv_name = cursor1_row.table_name;
-- Actualizamos el idtableview
IF old_idtableview != cursor1_row.idtableview THEN
UPDATE udc_tables_views SET idtableview = cursor1_row.idtableview WHERE idtableview = old_idtableview;
END IF;

END IF;


  
-- Actualizamos el nombre de la tabla si ha cambiado el nombre de la tabla manteniendo el mismo OID
UPDATE udc_tables_views SET tv_name=cursor1_row.table_name WHERE idtableview = cursor1_row.idtableview;

-- Si no existe creamos el registro
        IF NOT found THEN
INSERT INTO udc_tables_views(
            idtableview, title_dgrid, tv_name)
    VALUES (cursor1_row.idtableview, cursor1_row.table_name, cursor1_row.table_name);
        END IF;

 END LOOP;



------------------------------------
    FOR cursor1_row IN cursor1 LOOP

idata_type := cursor1_row.data_type;

IF cursor1_row.data_type::TEXT = &#39;ARRAY&#39; THEN
idata_type := replace(cursor1_row.udt_name::TEXT, &#39;_&#39;, &#39;&#39;)||&#39;[]&#39;;
END IF;

   
UPDATE udc_columns
   SET data_type=idata_type, column_default=cursor1_row.column_default
 WHERE idtableview=cursor1_row.idtableview AND column_name=cursor1_row.column_name;
        IF NOT found THEN
INSERT INTO udc_columns(
            idtableview, column_name, data_type, column_default, 
            column_label)
    VALUES (cursor1_row.idtableview, cursor1_row.column_name, cursor1_row.data_type, cursor1_row.column_default, 
            cursor1_row.column_name);
        END IF;


    END LOOP;

    

RETURN fun_return;
END;</programlisting>
      </para>
    </section>

<!-- Function fun_view_contact_groups_they_belong(note bigint) -->
    <section id="public.function.fun-view-contact-groups-they-belong-note-bigint"
             xreflabel="publicfun_view_contact_groups_they_belong(note bigint)">
      <title id="public.function.fun-view-contact-groups-they-belong-note-bigint-title">
       fun_view_contact_groups_they_belong(note bigint)
      </title>
      <titleabbrev id="public.function.fun-view-contact-groups-they-belong-note-bigint-titleabbrev">
       fun_view_contact_groups_they_belong(note bigint)
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>SET OF record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>
DECLARE myrow groups%ROWTYPE;
BEGIN
   FOR myrow IN SELECT * FROM groups where groups.idgroup &gt; 0
   LOOP
idgroup :=  myrow.idgroup;
ts:= myrow.ts;


--IF EXISTS(SELECT * FROM contacts_groups WHERE idcontact = iidcontact AND contacts_groups.idgroup = myrow.idgroup) THEN
--SELECT * FROM contacts WHERE idcontact = 0 AND 0 = ANY (groups)
IF EXISTS(SELECT * FROM contacts WHERE contacts.idcontact = iidcontact AND myrow.idgroup = ANY(groups)) THEN
ismember:=true;
ELSE
ismember:=false;
END IF;
idcontact := iidcontact;
enabled:= myrow.enabled;
name:= myrow.name;
description:=myrow.description;
note:=myrow.note;
   RETURN NEXT;
   END LOOP;
   RETURN;
END;
</programlisting>
      </para>
    </section>

<!-- Function fun_view_farma_lista_precios() -->
    <section id="public.function.fun-view-farma-lista-precios"
             xreflabel="publicfun_view_farma_lista_precios()">
      <title id="public.function.fun-view-farma-lista-precios-title">
       fun_view_farma_lista_precios()
      </title>
      <titleabbrev id="public.function.fun-view-farma-lista-precios-titleabbrev">
       fun_view_farma_lista_precios()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>SET OF record</seg>
        </seglistitem>
       </segmentedlist>
 
       
        <programlisting>
DECLARE myrow accounts%ROWTYPE;
DECLARE mylista farma_lista_precios_farmacias%ROWTYPE;
BEGIN
   FOR myrow IN SELECT * FROM accounts where accounts.enabled = true
   LOOP
iddivision :=  myrow.iddivision;
SELECT * INTO mylista FROM farma_lista_precios_farmacias WHERE farma_lista_precios_farmacias.idaccount = myrow.idaccount;
SELECT contact_name INTO tecnico FROM view_accounts_oams_assigned WHERE view_accounts_oams_assigned.idaccount = myrow.idaccount;


idaccount := myrow.idaccount;
account := myrow.account;
account_name:= myrow.account_name;
address:=myrow.address;
note:=myrow.note;
--tecnico := &#39;???&#39;;


srv159_principal := mylista.srv159_principal;
srv159_activa := mylista.srv159_activa;
srv159_productos := mylista.srv159_productos;

ip := mylista.ip;
provincia := mylista.provincia;


principal := mylista.principal;
activa := mylista.activa;
productos := mylista.productos;
estado := mylista.status;
sincronizado := mylista.sincronizado;

ts_farmacia:= mylista.ts_lista_farmacia;
ts_server159:= mylista.ts_lista_srv159;

   RETURN NEXT;
   END LOOP;
   RETURN;
END;
</programlisting>
      </para>
    </section>

<!-- Function notifications_before_insert() -->
    <section id="public.function.notifications-before-insert"
             xreflabel="publicnotifications_before_insert()">
      <title id="public.function.notifications-before-insert-title">
       notifications_before_insert()
      </title>
      <titleabbrev id="public.function.notifications-before-insert-titleabbrev">
       notifications_before_insert()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Acciones y comprobaciones antes de insertar el registro de notificacion
        <programlisting>BEGIN

/*
UPDATE sys_table_ts SET ts = now() WHERE table_name = TG_TABLE_NAME;
        IF NOT found THEN
INSERT INTO sys_table_ts (table_name) VALUES (TG_TABLE_NAME);
        END IF;
*/


IF NEW.timeout &lt; 5 THEN
NEW.timeout := 5;
END IF;

IF NEW.img IS NULL OR LENGTH(NEW.img) &lt; 4 THEN
NEW.img := &#39;/notifications_media/img/dialog-error.png&#39;;
END IF;

IF NEW.snd IS NULL OR LENGTH(NEW.snd) &lt; 4 THEN
NEW.snd := &#39;/notifications_media/snd/snd00.mp3&#39;;
END IF;

IF NEW.title IS NULL OR LENGTH(NEW.title) &lt; 3 THEN
NEW.title := &#39;Notification&#39;;
END IF;

IF NEW.body IS NULL OR  LENGTH(NEW.body) &lt; 3 THEN
NEW.body := &#39;Empty notification message&#39;;
END IF;

RETURN NEW;
END;</programlisting>
      </para>
    </section>

<!-- Function on_changed_table() -->
    <section id="public.function.on-changed-table"
             xreflabel="publicon_changed_table()">
      <title id="public.function.on-changed-table-title">
       on_changed_table()
      </title>
      <titleabbrev id="public.function.on-changed-table-titleabbrev">
       on_changed_table()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Debe ser disparado despues de que la tabla ha sufrido cambios.
        <programlisting>DECLARE

parent_table TEXT DEFAULT &#39;&#39;;

BEGIN


CASE
WHEN TG_TABLE_NAME ILIKE &#39;events_%&#39; THEN
parent_table:= &#39;events&#39;;

INSERT INTO table_modification_log(
            table_name, schema_name)
    VALUES (parent_table, TG_TABLE_SCHEMA);

WHEN TG_TABLE_NAME ILIKE &#39;event_comments_%&#39; THEN
parent_table:= &#39;event_comments&#39;;

INSERT INTO table_modification_log(
            table_name, schema_name)
    VALUES (parent_table, TG_TABLE_SCHEMA);


ELSE

INSERT INTO table_modification_log(
            table_name, schema_name)
    VALUES (TG_TABLE_NAME, TG_TABLE_SCHEMA);

END CASE;
    

/*

RAISE NOTICE &#39;1) Inicia Trigger on_changed_table&#39;;

UPDATE sys_table_ts SET ts = now() WHERE table_name = TG_TABLE_NAME;
RAISE NOTICE &#39;2) Se ha actualizado&#39;;

        IF NOT found THEN
RAISE NOTICE &#39;3) Registro no encontrado, se crea uno nuevo&#39;;
INSERT INTO sys_table_ts (table_name) VALUES (TG_TABLE_NAME);
        END IF;

RAISE NOTICE &#39;4) Termina on_changed_table&#39;;


BEGIN

CASE
WHEN TG_TABLE_NAME ILIKE &#39;events_%&#39; THEN
parent_table:= &#39;events&#39;;
WHEN TG_TABLE_NAME ILIKE &#39;event_comments_%&#39; THEN
parent_table:= &#39;event_comments&#39;;
ELSE

END CASE;


IF LENGTH(parent_table) &gt; 0 THEN

UPDATE sys_table_ts SET ts = now() WHERE table_name = parent_table;
RAISE NOTICE &#39;A) Se ha actualizado tabla padre %&#39;,parent_table;

        IF NOT found THEN
RAISE NOTICE &#39;B) Registro no encontrado, se crea uno nuevo %&#39;,parent_table;
INSERT INTO sys_table_ts (table_name) VALUES (parent_table);
        END IF;

END IF;



END;
*/

RETURN NULL;
END;</programlisting>
      </para>
    </section>

<!-- Function on_update_row_update_ts() -->
    <section id="public.function.on-update-row-update-ts"
             xreflabel="publicon_update_row_update_ts()">
      <title id="public.function.on-update-row-update-ts-title">
       on_update_row_update_ts()
      </title>
      <titleabbrev id="public.function.on-update-row-update-ts-titleabbrev">
       on_update_row_update_ts()
      </titleabbrev>

      <para>
       <segmentedlist>
        <title>Function Properties</title>
        <?dbhtml list-presentation="list"?>
        <segtitle>Language</segtitle>
        <segtitle>Return Type</segtitle>
        <seglistitem>
         <seg>PLPGSQL</seg>
         <seg>trigger</seg>
        </seglistitem>
       </segmentedlist>
 
       Debe ser disparado antes de actualizar un registro de una tabla para que el campo ts sea actualizado.
        <programlisting>
BEGIN

RAISE NOTICE &#39;1) on_update_row_update_ts&#39;;


	NEW.footprint_row = (random() * 9999 + 1 )::smallint;
   NEW.ts = now(); 
   RETURN NEW;
END;
</programlisting>
      </para>
    </section>

  </chapter>

  <chapter id="scheduled-tasks.schema"
           xreflabel="scheduled_tasks">
    <title>Schema scheduled_tasks</title>
    <para></para>


      <section id="scheduled-tasks.table.task-list"
               xreflabel="scheduled_tasks.task_list">
        <title id="scheduled-tasks.table.task-list-title">
         Table:
         
         <structname>task_list</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>task_list</structname>
            </title>


            <varlistentry>
              <term><structfield>idtask</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>ts</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>





                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>enabled</structfield></term>
              <listitem><para>
                <type>boolean</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>function_name</structfield></term>
              <listitem><para>
                <type>text</type>



                <literal>NOT NULL</literal>





              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_start</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_end</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_trigger</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>last_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>next_run</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>status</structfield></term>
              <listitem><para>
                <type>smallint</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>description</structfield></term>
              <listitem><para>
                <type>text</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>task_parameters</structfield></term>
              <listitem><para>
                <type>jsonb</type>







              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>duration</structfield></term>
              <listitem><para>
                <type>integer</type>





                <literal>DEFAULT &apos;-1&apos;::integer</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>



  </chapter>

  <chapter id="secondary.schema"
           xreflabel="secondary">
    <title>Schema secondary</title>
    <para>Esquema donde se colocaran tablas de apoyo o que no son parte fundamental de Open Monitoring System</para>


      <section id="secondary.table.eta-movinventarios"
               xreflabel="secondary.eta_movinventarios">
        <title id="secondary.table.eta-movinventarios-title">
         Table:
         
         <structname>eta_movinventarios</structname>
        </title>
 


        <para>
          <variablelist>
            <title>
              Structure of <structname>eta_movinventarios</structname>
            </title>


            <varlistentry>
              <term><structfield>idetamovinv</structfield></term>
              <listitem><para>
                <type>bigserial</type>


                <literal>PRIMARY KEY</literal>













              </para>

            </listitem>
          </varlistentry>

            <varlistentry>
              <term><structfield>dateload</structfield></term>
              <listitem><para>
                <type>timestamp with time zone</type>



                <literal>NOT NULL</literal>



                <literal>DEFAULT now()</literal>



              </para>

            </listitem>
          </varlistentry>

        </variablelist>










      </para>
    </section>



  </chapter>

</book>

