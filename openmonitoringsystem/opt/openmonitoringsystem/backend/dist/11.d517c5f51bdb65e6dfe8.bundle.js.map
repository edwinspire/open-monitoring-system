{"version":3,"sources":["webpack://pen_onitoring_ystem/./src/widgets/register/Register.m.css","webpack://pen_onitoring_ystem/./src/widgets/register/Register.ts"],"names":["module","exports"," _key","root","body","wrapper","form-success","container","form","links_block","bg_bubbles","square","__webpack_require__","r","__webpack_exports__","d","Register","_dojo_framework_core_vdom__WEBPACK_IMPORTED_MODULE_0__","_dojo_framework_core_WidgetBase__WEBPACK_IMPORTED_MODULE_1__","_Register_m_css__WEBPACK_IMPORTED_MODULE_2__","_dojo_widgets_snackbar__WEBPACK_IMPORTED_MODULE_3__","[object Object]","this","_openSnack","_MsgSnackBar","type","msg","console","log","_SnackType","invalidate","setTimeout","document","cookie","Object","classes","action","method","onsubmit","e","target","inputs","getElementsByTagName","i","DataLogin","pwd","pwd2","length","defineProperty","name","value","enumerable","resp","fetch","JSON","stringify","headers","Content-Type","data","json","status","SnackBar","Message","window","location","href","preventDefault","placeholder","required","open","leading","messageRenderer"],"mappings":"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","file":"11.d517c5f51bdb65e6dfe8.bundle.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\" _key\":\"OpenMonitoringSystem/Register\",\"root\":\"Register-m__root__309e8dG_7Wm\",\"body\":\"Register-m__body__309e8dnYxNd\",\"wrapper\":\"Register-m__wrapper__309e8d3dbVy\",\"form-success\":\"Register-m__form-success__309e8d6e9DT\",\"container\":\"Register-m__container__309e8dJoasP\",\"form\":\"Register-m__form__309e8d3H5iy\",\"links_block\":\"Register-m__links_block__309e8dDgrCe\",\"bg_bubbles\":\"Register-m__bg_bubbles__309e8d1jFri\",\"square\":\"Register-m__square__309e8d1u4wt\"};","import { v, w } from '@dojo/framework/core/vdom';\nimport WidgetBase from '@dojo/framework/core/WidgetBase';\nimport * as css from './Register.m.css';\nimport SBar from '@dojo/widgets/snackbar';\n//import watch from '@dojo/framework/core/decorators/watch';\n\nexport default class Register extends WidgetBase  {\n\n\tprivate _openSnack = false;\n\tprivate _MsgSnackBar = '-';\n\tprivate _SnackType: 'success'|'error'|undefined;\n\t\n\tprivate SnackBar(type: 'success'|'error'|undefined, msg: string){\n\t\tconsole.log('SnackBar '+msg)\t\n\t\tthis._openSnack = true;\n\t\tthis._MsgSnackBar = msg;\n\t\tthis._SnackType = type;\n\t\tthis.invalidate();\n\t\tsetTimeout(()=>{\n\t\t\tthis._openSnack = false;\n\t\t\tthis.invalidate();\n\t\t}, 4000)\t\t\n\t}\n\n\tonAttach(){\n\t\tdocument.cookie = \"TOKEN_USER= ; expires = Thu, 01 Jan 1970 00:00:00 GMT\";\n\t\tconsole.log('Borrar');\n\n\t}\n\n\tprotected render(){\n\n\t\treturn v('div', {classes: [css.root]}, [\n\t\t\tv('div', {classes: [css.body]}, [\n\t\t\t\tv('div', {classes: css.wrapper}, [\n\t\t\t\t\tv('div', { classes: [css.container]}, [\n\t\t\t\t\t\tv('h1', {}, ['Registro']),\n\t\t\t\t\t\tv('form', {classes: css.form, action: \"/register\", method: \"post\",  onsubmit: (e: Event)=>{\t\n\n\t\t\t\t\t\t\tif(e.target){\n\t\t\t\t\t\t\t\tlet d = e.target as HTMLFormElement;\n\t\t\t\t\t\t\t\tlet inputs = d.getElementsByTagName(\"input\");\n\t\t\t\t\t\t\t\tlet i = 0;\n\t\t\t\t\t\t\t\tvar DataLogin = {};\n\t\t\t\t\t\t\t\tlet pwd = '';\n\t\t\t\t\t\t\t\tlet pwd2 = '';\n\n\t\t\t\t\t\t\t\tfor (i=0; i<inputs.length; i++){\n\t\t\t\t\t\t\t\t\tObject.defineProperty(DataLogin, inputs[i].name, {value : inputs[i].value, enumerable: true});\n\n\t\t\t\t\t\t\t\t\tif(inputs[i].name == 'pwd'){\n\t\t\t\t\t\t\t\t\t\tpwd = inputs[i].value;\n\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t\tif(inputs[i].name == 'pwd2'){\n\t\t\t\t\t\t\t\t\t\tpwd2 = inputs[i].value;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif(i+1 == inputs.length){\n\n\t\t\t\t\t\t\t\t\t\tif(pwd == pwd2){\n\t\t\t\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t\t\t\tasync ()=>{\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet resp = await fetch(\"/register\",{method: 'POST', body: JSON.stringify(DataLogin), headers: {'Content-Type': 'application/json'}});\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet data = await resp.json();\n\t\t\t\t\t\t\t\t\t\t\t\t\tif(resp.status == 200){\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(data);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif(data.Register){\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.SnackBar('success', data.Message);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(()=>{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twindow.location.href = \"/#login\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}, 5000);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.SnackBar('error', data.Message);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('No se pudo registrar', data);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//alert('No se pudo registrar');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.SnackBar('error', 'no se pudo guardar');\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t)();\n\n\t\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\t\tthis.SnackBar('error', 'Las contraseñas no coinciden');\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\te.preventDefault();\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}}, [\n\t\t\t\t\t\t\tv('input', {name: 'firstname',  type: 'text', placeholder: 'Nombre', required: 'required'}),\n\t\t\t\t\t\t\tv('input', {name: 'lastname',  type: 'text', placeholder: 'Apellido', required: 'required'}),\n\t\t\t\t\t\t\tv('input', {name: 'username', type: 'email', placeholder: 'Email', required: 'required'}),\n\t\t\t\t\t\t\tv('input', {name: 'pwd', type: 'password', placeholder: 'Contraseña', required: 'required'}),\n\t\t\t\t\t\t\tv('input', {name: 'pwd2', type: 'password', placeholder: 'Confirme Contraseña', required: 'required'}),\n\t\t\t\t\t\t\tv('input', {name: 'register', type: 'submit', value: 'Aceptar'}),\n\t\t\t\t\t\t\tv('div', {classes: css.links_block}, [\n\t\t\t\t\t\t\t\tv('a', {href: \"/#login\"}, ['Login'])\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t]),\n\t\t\t\t\t\t]),\n\t\t\t\t\tw(SBar, {open: this._openSnack, leading: false, type: this._SnackType, messageRenderer: () => this._MsgSnackBar})\n\t\t\t\t\t])\n\t\t\t\t]),\n\t\t\tv('ul', {classes: css.bg_bubbles}, [\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li'),\n\t\t\t\tv('li')\n\t\t\t\t])\n\t\t\t])\n\t}\n}"],"sourceRoot":""}